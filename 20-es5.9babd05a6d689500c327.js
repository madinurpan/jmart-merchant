function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var n=[],i=!0,r=!1,s=void 0;try{for(var a,c=t[Symbol.iterator]();!(i=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(o){r=!0,s=o}finally{try{i||null==c.return||c.return()}finally{if(r)throw s}}return n}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _possibleConstructorReturn(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{"9u+z":function(t,e,n){"use strict";n.r(e);var i,r,s,a,c=n("ofXK"),o=n("3Pt+"),u=n("dlKe"),l=n("PCNd"),d=n("crCf"),b=n("5cNS"),m=n("tyNb"),p=n("fXoL"),h=n("paXB"),f=n("7/bn"),v=n("oMXN"),g=n("EiG8"),S=n("aZ8m"),y=((i=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"ngOnInit",value:function(){}}]),t}()).\u0275fac=function(t){return new(t||i)},i.\u0275cmp=p.Kb({type:i,selectors:[["j-history"]],decls:8,vars:0,consts:[[1,"row"],[1,"col-lg-10","offset-lg-1","col-xl-8","offset-xl-2"]],template:function(t,e){1&t&&(p.Wb(0,"j-layout-home"),p.Wb(1,"j-aside"),p.Rb(2,"j-nav-main"),p.Vb(),p.Wb(3,"j-main"),p.Wb(4,"section",0),p.Wb(5,"section",1),p.Rb(6,"j-header"),p.Rb(7,"router-outlet"),p.Vb(),p.Vb(),p.Vb(),p.Vb())},directives:[h.a,f.a,v.a,g.a,S.a,m.h],styles:[""]}),i),T=n("mrSG"),R=n("quSY"),O=n("itXk"),I=n("VRyK"),E=n("z6cu"),k=n("lJxs"),A=n("IzEk"),C=n("vkgz"),_=n("eIep"),F=n("JIr8"),L=n("nYR2"),V=n("9N4E"),x=n("y5b2"),w=n("TwVa"),D=n("+/Tu"),N=n("1kSV"),P=n("sYmb"),H=n("e8Ap"),W=((a=function(){function t(e){_classCallCheck(this,t),this.modal=e}return _createClass(t,[{key:"dismissModal",value:function(){this.modal.dismiss()}},{key:"closeModal",value:function(){this.modal.close()}},{key:"failedText",get:function(){switch(this.failedCount%20){case 1:return"HISTORY.DELETE.FAILED.ONE";case 2:case 3:case 4:return"HISTORY.DELETE.FAILED.FEW";default:return"HISTORY.DELETE.FAILED.OTHER"}}},{key:"failedParams",get:function(){return{transactionsCount:this.failedCount}}},{key:"successText",get:function(){switch(this.successCount%10){case 1:return"HISTORY.DELETE.SUCCESS.ONE";case 2:case 3:case 4:return"HISTORY.DELETE.SUCCESS.FEW";default:return"HISTORY.DELETE.SUCCESS.OTHER"}}},{key:"successParams",get:function(){return{transactionsCount:this.successCount}}}]),t}()).\u0275fac=function(t){return new(t||a)(p.Qb(N.a))},a.\u0275cmp=p.Kb({type:a,selectors:[["j-delete-partial"]],inputs:{failedCount:"failedCount",successCount:"successCount"},decls:17,vars:15,consts:[[1,"modal-header","j-modal-header"],["type","button",1,"close",3,"click"],["src","/assets/icons/close.svg",3,"alt"],[1,"modal-body","j-modal-body","text-center","pb-3"],["src","/assets/img/history/modals/partial.svg",3,"alt"],["translate","",1,"light","mb-3","mt-2"],[1,"m-0","text-muted",3,"innerHTML"],[1,"mt-0","text-muted",3,"innerHTML"],[1,"modal-footer","py-4","px-3","justify-content-center"],["translate","","type","button",1,"btn","btn-static","btn-link","m-0",3,"click"],[3,"inlineSVG"]],template:function(t,e){1&t&&(p.Wb(0,"div",0),p.Wb(1,"button",1),p.ic("click",(function(t){return e.dismissModal()})),p.Rb(2,"img",2),p.nc(3,"translate"),p.Vb(),p.Vb(),p.Wb(4,"div",3),p.Rb(5,"img",4),p.nc(6,"translate"),p.Wb(7,"h3",5),p.Tc(8,"HISTORY.DELETE.PARTIAL"),p.Vb(),p.Rb(9,"p",6),p.nc(10,"translate"),p.Rb(11,"p",7),p.nc(12,"translate"),p.Vb(),p.Wb(13,"div",8),p.Wb(14,"button",9),p.ic("click",(function(t){return e.dismissModal()})),p.Tc(15," HISTORY.BACK_TO_HISTORY "),p.Rb(16,"span",10),p.Vb(),p.Vb()),2&t&&(p.Ab(2),p.vc("alt",p.oc(3,5,"SHARED.CLOSE")),p.Ab(3),p.vc("alt",p.oc(6,7,"HISTORY.DELETE.PARTIAL")),p.Ab(4),p.uc("innerHTML",p.pc(10,9,e.successText,e.successParams),p.Jc),p.Ab(2),p.uc("innerHTML",p.pc(12,12,e.failedText,e.failedParams),p.Jc),p.Ab(5),p.uc("inlineSVG","/assets/icons/shared/arrow-right.svg"))},directives:[P.a,H.a],pipes:[P.d],styles:[""]}),a),j=((s=function(t){function e(t){var n;return _classCallCheck(this,e),(n=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this,t))).modal=t,n}return _inherits(e,t),e}(W)).\u0275fac=function(t){return new(t||s)(p.Qb(N.a))},s.\u0275cmp=p.Kb({type:s,selectors:[["j-delete-error"]],features:[p.xb],decls:17,vars:11,consts:[[1,"modal-header","j-modal-header"],["type","button",1,"close",3,"click"],["src","/assets/icons/close.svg",3,"alt"],[1,"modal-body","px-4","pt-0","pb-4","text-center"],["src","/assets/img/history/modals/error.svg",3,"alt"],["translate","",1,"light","mb-3","mt-2"],[1,"m-0","text-muted",3,"innerHTML"],[1,"modal-footer","py-4","px-3","justify-content-center"],["translate","","type","button",1,"btn","btn-primary","btn-block","mb-3",3,"click"],["translate","","type","button",1,"btn","btn-static","btn-link","m-0",3,"click"],[3,"inlineSVG"]],template:function(t,e){1&t&&(p.Wb(0,"div",0),p.Wb(1,"button",1),p.ic("click",(function(t){return e.dismissModal()})),p.Rb(2,"img",2),p.nc(3,"translate"),p.Vb(),p.Vb(),p.Wb(4,"div",3),p.Rb(5,"img",4),p.nc(6,"translate"),p.Wb(7,"h3",5),p.Tc(8,"HISTORY.DELETE.FAILED.TITLE"),p.Vb(),p.Rb(9,"p",6),p.nc(10,"translate"),p.Vb(),p.Wb(11,"div",7),p.Wb(12,"button",8),p.ic("click",(function(t){return e.closeModal()})),p.Tc(13," SHARED.TRY_AGAIN "),p.Vb(),p.Wb(14,"button",9),p.ic("click",(function(t){return e.dismissModal()})),p.Tc(15," HISTORY.BACK_TO_HISTORY "),p.Rb(16,"span",10),p.Vb(),p.Vb()),2&t&&(p.Ab(2),p.vc("alt",p.oc(3,4,"SHARED.CLOSE")),p.Ab(3),p.vc("alt",p.oc(6,6,"HISTORY.DELETE.FAILED.TITLE")),p.Ab(4),p.uc("innerHTML",p.pc(10,8,e.failedText,e.failedParams),p.Jc),p.Ab(7),p.uc("inlineSVG","/assets/icons/shared/arrow-right.svg"))},directives:[P.a,H.a],pipes:[P.d],styles:[""]}),s),M=((r=function(t){function e(t){var n;return _classCallCheck(this,e),(n=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this,t))).modal=t,n}return _inherits(e,t),e}(W)).\u0275fac=function(t){return new(t||r)(p.Qb(N.a))},r.\u0275cmp=p.Kb({type:r,selectors:[["j-delete-success"]],features:[p.xb],decls:15,vars:11,consts:[[1,"modal-header","j-modal-header"],["type","button",1,"close",3,"click"],["src","/assets/icons/close.svg",3,"alt"],[1,"modal-body","j-modal-body","text-center","pb-4"],["src","/assets/img/history/modals/success.svg",3,"alt"],["translate","",1,"light","mb-3","mt-2"],[1,"m-0","text-muted",3,"innerHTML"],[1,"modal-footer","py-4","px-3","justify-content-center"],["translate","","type","button",1,"btn","btn-static","btn-link","m-0",3,"click"],[3,"inlineSVG"]],template:function(t,e){1&t&&(p.Wb(0,"div",0),p.Wb(1,"button",1),p.ic("click",(function(t){return e.dismissModal()})),p.Rb(2,"img",2),p.nc(3,"translate"),p.Vb(),p.Vb(),p.Wb(4,"div",3),p.Rb(5,"img",4),p.nc(6,"translate"),p.Wb(7,"h3",5),p.Tc(8,"HISTORY.DELETE.SUCCESS.TITLE"),p.Vb(),p.Rb(9,"p",6),p.nc(10,"translate"),p.Vb(),p.Wb(11,"div",7),p.Wb(12,"button",8),p.ic("click",(function(t){return e.dismissModal()})),p.Tc(13," HISTORY.BACK_TO_HISTORY "),p.Rb(14,"span",9),p.Vb(),p.Vb()),2&t&&(p.Ab(2),p.vc("alt",p.oc(3,4,"SHARED.CLOSE")),p.Ab(3),p.vc("alt",p.oc(6,6,"HISTORY.DELETE.SUCCESS.TITLE")),p.Ab(4),p.uc("innerHTML",p.pc(10,8,e.successText,e.successParams),p.Jc),p.Ab(5),p.uc("inlineSVG","/assets/icons/shared/arrow-right.svg"))},directives:[P.a,H.a],pipes:[P.d],styles:[""]}),r);function Y(t,e){1&t&&(p.Wb(0,"span"),p.Tc(1,", "),p.Vb())}function G(t,e){if(1&t&&(p.Wb(0,"span"),p.Tc(1),p.Rc(2,Y,2,0,"span",12),p.Vb()),2&t){var n,i=e.$implicit,r=e.index,s=p.mc().$implicit,a=r<(null==(n=p.mc().retrieveErrors(s))?null:n.length)-1;p.Ab(1),p.Vc(" ",i,""),p.Ab(1),p.uc("ngIf",a)}}function B(t,e){if(1&t&&(p.Wb(0,"div"),p.Wb(1,"strong"),p.Tc(2),p.Vb(),p.Rc(3,G,3,2,"span",11),p.Vb()),2&t){var n=e.$implicit,i=p.mc();p.Ab(2),p.Vc("\u2116",n.documentNumber,": "),p.Ab(1),p.uc("ngForOf",i.retrieveErrors(n))}}var K,U=((K=function(){function t(e){_classCallCheck(this,t),this.modal=e}return _createClass(t,[{key:"dismissModal",value:function(){this.modal.dismiss()}},{key:"closeModal",value:function(){this.modal.close()}},{key:"retrieveErrors",value:function(t){return t.errorData?Object.entries(t.errorData).map((function(t){return t[1]})):t.errorMsg?[t.errorMsg]:[]}},{key:"failedText",get:function(){switch(this.signResult&&this.signResult.numberOfFailed%20){case 1:return"HISTORY.PARTIAL.FAILED.ONE";case 2:case 3:case 4:return"HISTORY.PARTIAL.FAILED.FEW";default:return"HISTORY.PARTIAL.FAILED.OTHER"}}},{key:"failedParams",get:function(){return{transactionsCount:this.signResult&&this.signResult.numberOfFailed}}},{key:"failedTransactions",get:function(){var t;return null===(t=this.signResult)||void 0===t?void 0:t.results}}]),t}()).\u0275fac=function(t){return new(t||K)(p.Qb(N.a))},K.\u0275cmp=p.Kb({type:K,selectors:[["j-multiple-sign-partial-error"]],inputs:{signResult:"signResult"},decls:17,vars:12,consts:[[1,"modal-header","j-modal-header"],["type","button",1,"close",3,"click"],["src","/assets/icons/close.svg",3,"alt"],[1,"modal-body","j-modal-body","text-center","pb-3"],["src","/assets/img/history/modals/error.svg",3,"alt"],["translate","",1,"light","mb-3","mt-2"],[1,"mt-0","text-muted",3,"innerHTML"],["translate","","type","button",1,"btn","btn-static","btn-link","m-0",3,"click"],[3,"inlineSVG"],[1,"modal-footer","bg-main","p-4","d-block","justify-content-start"],["translate","HISTORY.PARTIAL.SUBTITLE"],[4,"ngFor","ngForOf"],[4,"ngIf"]],template:function(t,e){1&t&&(p.Wb(0,"div",0),p.Wb(1,"button",1),p.ic("click",(function(t){return e.dismissModal()})),p.Rb(2,"img",2),p.nc(3,"translate"),p.Vb(),p.Vb(),p.Wb(4,"div",3),p.Rb(5,"img",4),p.nc(6,"translate"),p.Wb(7,"h3",5),p.Tc(8,"HISTORY.FAILED.TITLE"),p.Vb(),p.Rb(9,"p",6),p.nc(10,"translate"),p.Wb(11,"button",7),p.ic("click",(function(t){return e.dismissModal()})),p.Tc(12," HISTORY.BACK_TO_HISTORY "),p.Rb(13,"span",8),p.Vb(),p.Vb(),p.Wb(14,"div",9),p.Rb(15,"h5",10),p.Rc(16,B,4,2,"div",11),p.Vb()),2&t&&(p.Ab(2),p.vc("alt",p.oc(3,5,"SHARED.CLOSE")),p.Ab(3),p.vc("alt",p.oc(6,7,"HISTORY.FAILED.TITLE")),p.Ab(4),p.uc("innerHTML",p.pc(10,9,e.failedText,e.failedParams),p.Jc),p.Ab(4),p.uc("inlineSVG","/assets/icons/shared/arrow-right.svg"),p.Ab(3),p.uc("ngForOf",e.failedTransactions))},directives:[P.a,H.a,c.t,c.u],pipes:[P.d],styles:[""]}),K),Q=n("Kx/q");function J(t,e){if(1&t&&(p.Wb(0,"div",16),p.Tc(1),p.nc(2,"lowercase"),p.nc(3,"translate"),p.Wb(4,"strong"),p.Rb(5,"j-money",17),p.Vb(),p.Vb()),2&t){var n=e.$implicit,i=p.mc();p.Ab(1),p.Wc(" ",n.count," ",p.oc(2,3,p.oc(3,5,i.mapCountLabel(n.count)))," \u2013 "),p.Ab(4),p.uc("money",n.money)}}function $(t,e){1&t&&(p.Wb(0,"span"),p.Tc(1,", "),p.Vb())}function z(t,e){if(1&t&&(p.Wb(0,"span"),p.Tc(1),p.Rc(2,$,2,0,"span",18),p.Vb()),2&t){var n,i=e.$implicit,r=e.index,s=p.mc().$implicit,a=r<(null==(n=p.mc().retrieveErrors(s))?null:n.length)-1;p.Ab(1),p.Vc(" ",i,""),p.Ab(1),p.uc("ngIf",a)}}function X(t,e){if(1&t&&(p.Wb(0,"div"),p.Wb(1,"strong"),p.Tc(2),p.Vb(),p.Rc(3,z,3,2,"span",15),p.Vb()),2&t){var n=e.$implicit,i=p.mc();p.Ab(2),p.Vc("\u2116",n.documentNumber,": "),p.Ab(1),p.uc("ngForOf",i.retrieveErrors(n))}}var q,Z=((q=function(){function t(e){_classCallCheck(this,t),this.modal=e}return _createClass(t,[{key:"ngOnInit",value:function(){this.generateGroups()}},{key:"dismissModal",value:function(){this.modal.dismiss()}},{key:"closeModal",value:function(){this.modal.close()}},{key:"retrieveErrors",value:function(t){return t.errorData?Object.entries(t.errorData).map((function(t){return t[1]})):t.errorMsg?[t.errorMsg]:[]}},{key:"mapCountLabel",value:function(t){switch(t%20){case 1:return"HISTORY.OPERATION.ONE";case 2:case 3:case 4:return"HISTORY.OPERATION.FEW";default:return"HISTORY.OPERATION.OTHER"}}},{key:"generateGroups",value:function(){var t={};this.result.results.forEach((function(e){var n=e.result.amount;t[n.currency]?(t[n.currency].money.amount+=n.amount,t[n.currency].count++):t[n.currency]={money:{currency:n.currency,amount:n.amount},count:1}})),this.groups=Object.values(t)}},{key:"successText",get:function(){switch(this.result&&this.result.numberOfSuccess%10){case 1:return"HISTORY.PARTIAL.SUCCESS.ONE";case 2:case 3:case 4:return"HISTORY.PARTIAL.SUCCESS.FEW";default:return"HISTORY.PARTIAL.SUCCESS.OTHER"}}},{key:"totalBalance",get:function(){return this.result&&this.result.totalBalance}},{key:"successCount",get:function(){return this.result&&this.result.numberOfSuccess}},{key:"totalCount",get:function(){return this.result&&this.result.results.length}},{key:"successParams",get:function(){return{transactionsCount:this.successCount}}},{key:"failedText",get:function(){switch(this.result&&this.result.numberOfFailed%10){case 1:return"HISTORY.PARTIAL.FAILED.ONE";case 2:case 3:case 4:return"HISTORY.PARTIAL.FAILED.FEW";default:return"HISTORY.PARTIAL.FAILED.OTHER"}}},{key:"failedParams",get:function(){return{transactionsCount:this.result&&this.result.numberOfFailed}}},{key:"failedTransactions",get:function(){return this.result&&this.result.results&&this.result.results.filter((function(t){return t.status===w.b.FAILED}))}}]),t}()).\u0275fac=function(t){return new(t||q)(p.Qb(N.a))},q.\u0275cmp=p.Kb({type:q,selectors:[["j-multiple-sign-partial-success"]],inputs:{result:"result"},decls:26,vars:19,consts:[[1,"modal-header","j-modal-header"],["type","button",1,"close",3,"click"],["src","/assets/icons/close.svg",3,"alt"],[1,"modal-body","j-modal-body","text-center","pb-3"],["src","/assets/img/history/modals/partial.svg",3,"alt"],["translate","",1,"light","mb-3","mt-2"],[1,"m-0","text-muted"],["translate",""],["class","result-group",4,"ngFor","ngForOf"],[1,"m-0","text-muted",3,"innerHTML"],[1,"mt-0","text-muted",3,"innerHTML"],["translate","","type","button",1,"btn","btn-static","btn-link","m-0",3,"click"],[3,"inlineSVG"],[1,"modal-footer","bg-main","p-4","d-block","justify-content-start"],["translate","HISTORY.PARTIAL.SUBTITLE"],[4,"ngFor","ngForOf"],[1,"result-group"],[3,"money"],[4,"ngIf"]],template:function(t,e){1&t&&(p.Wb(0,"div",0),p.Wb(1,"button",1),p.ic("click",(function(t){return e.dismissModal()})),p.Rb(2,"img",2),p.nc(3,"translate"),p.Vb(),p.Vb(),p.Wb(4,"div",3),p.Rb(5,"img",4),p.nc(6,"translate"),p.Wb(7,"h3",5),p.Tc(8,"HISTORY.PARTIAL.TITLE"),p.Vb(),p.Wb(9,"p",6),p.Wb(10,"span",7),p.Tc(11,"HISTORY.OPERATION.FEW"),p.Vb(),p.Tc(12,": "),p.Wb(13,"strong"),p.Tc(14),p.Vb(),p.Vb(),p.Rc(15,J,6,7,"div",8),p.Rb(16,"p",9),p.nc(17,"translate"),p.Rb(18,"p",10),p.nc(19,"translate"),p.Wb(20,"button",11),p.ic("click",(function(t){return e.dismissModal()})),p.Tc(21," HISTORY.BACK_TO_HISTORY "),p.Rb(22,"span",12),p.Vb(),p.Vb(),p.Wb(23,"div",13),p.Rb(24,"h4",14),p.Rc(25,X,4,2,"div",15),p.Vb()),2&t&&(p.Ab(2),p.vc("alt",p.oc(3,9,"SHARED.CLOSE")),p.Ab(3),p.vc("alt",p.oc(6,11,"HISTORY.PARTIAL.TITLE")),p.Ab(9),p.Wc("",e.successCount,"/",e.totalCount,""),p.Ab(1),p.uc("ngForOf",e.groups),p.Ab(1),p.uc("innerHTML",p.pc(17,13,e.successText,e.successParams),p.Jc),p.Ab(2),p.uc("innerHTML",p.pc(19,16,e.failedText,e.failedParams),p.Jc),p.Ab(4),p.uc("inlineSVG","/assets/icons/shared/arrow-right.svg"),p.Ab(3),p.uc("ngForOf",e.failedTransactions))},directives:[P.a,c.t,H.a,Q.a,c.u],pipes:[P.d,c.q],styles:[""]}),q);function tt(t,e){if(1&t&&(p.Wb(0,"p",13),p.Tc(1),p.Vb()),2&t){var n=p.mc();p.Ab(1),p.Vc(" ",n.errorText," ")}}var et,nt=((et=function(){function t(e){_classCallCheck(this,t),this.modal=e}return _createClass(t,[{key:"dismissModal",value:function(){this.modal.dismiss()}},{key:"closeModal",value:function(){this.modal.close()}}]),t}()).\u0275fac=function(t){return new(t||et)(p.Qb(N.a))},et.\u0275cmp=p.Kb({type:et,selectors:[["j-multiple-sign-error"]],inputs:{errorText:"errorText"},decls:19,vars:8,consts:[[1,"modal-header","j-modal-header"],["type","button",1,"close",3,"click"],["src","/assets/icons/close.svg",3,"alt"],[1,"modal-body","px-4","pt-0","pb-4","text-center"],["src","/assets/img/history/modals/error.svg",3,"alt"],["translate","",1,"light","mb-3","mt-2"],[1,"m-0","text-muted"],["translate",""],["class","mt-3 mb-0 text-danger",4,"ngIf"],[1,"modal-footer","py-4","px-3","justify-content-center"],["translate","","type","button",1,"btn","btn-primary","btn-block","mb-3",3,"click"],["translate","","type","button",1,"btn","btn-static","btn-link","m-0",3,"click"],[3,"inlineSVG"],[1,"mt-3","mb-0","text-danger"]],template:function(t,e){1&t&&(p.Wb(0,"div",0),p.Wb(1,"button",1),p.ic("click",(function(t){return e.dismissModal()})),p.Rb(2,"img",2),p.nc(3,"translate"),p.Vb(),p.Vb(),p.Wb(4,"div",3),p.Rb(5,"img",4),p.nc(6,"translate"),p.Wb(7,"h3",5),p.Tc(8,"HISTORY.FAILED.TITLE"),p.Vb(),p.Wb(9,"p",6),p.Wb(10,"span",7),p.Tc(11,"HISTORY.FAILED.DESCRIPTION"),p.Vb(),p.Vb(),p.Rc(12,tt,2,1,"p",8),p.Vb(),p.Wb(13,"div",9),p.Wb(14,"button",10),p.ic("click",(function(t){return e.closeModal()})),p.Tc(15," SHARED.TRY_AGAIN "),p.Vb(),p.Wb(16,"button",11),p.ic("click",(function(t){return e.dismissModal()})),p.Tc(17," HISTORY.BACK_TO_HISTORY "),p.Rb(18,"span",12),p.Vb(),p.Vb()),2&t&&(p.Ab(2),p.vc("alt",p.oc(3,4,"SHARED.CLOSE")),p.Ab(3),p.vc("alt",p.oc(6,6,"HISTORY.FAILED.TITLE")),p.Ab(7),p.uc("ngIf",e.errorText),p.Ab(6),p.uc("inlineSVG","/assets/icons/shared/arrow-right.svg"))},directives:[P.a,c.u,H.a],pipes:[P.d],styles:[""]}),et);function it(t,e){if(1&t&&(p.Wb(0,"div",10),p.Tc(1),p.nc(2,"lowercase"),p.nc(3,"translate"),p.Wb(4,"strong"),p.Rb(5,"j-money",11),p.Vb(),p.Vb()),2&t){var n=e.$implicit,i=p.mc();p.Ab(1),p.Wc(" ",n.count," ",p.oc(2,3,p.oc(3,5,i.mapCountLabel(n.count)))," \u2013 "),p.Ab(4),p.uc("money",n.money)}}var rt,st=((rt=function(){function t(e){_classCallCheck(this,t),this.modal=e}return _createClass(t,[{key:"ngOnInit",value:function(){this.generateGroups()}},{key:"dismissModal",value:function(){this.modal.dismiss()}},{key:"closeModal",value:function(){this.modal.close()}},{key:"mapCountLabel",value:function(t){switch(t%20){case 1:return"HISTORY.OPERATION.ONE";case 2:case 3:case 4:return"HISTORY.OPERATION.FEW";default:return"HISTORY.OPERATION.OTHER"}}},{key:"generateGroups",value:function(){var t={};this.result.results.forEach((function(e){var n=e.result.amount;t[n.currency]?(t[n.currency].money.amount+=n.amount,t[n.currency].count++):t[n.currency]={money:{currency:n.currency,amount:n.amount},count:1}})),this.groups=Object.values(t)}}]),t}()).\u0275fac=function(t){return new(t||rt)(p.Qb(N.a))},rt.\u0275cmp=p.Kb({type:rt,selectors:[["j-multiple-sign-success"]],inputs:{result:"result"},decls:14,vars:8,consts:[[1,"modal-header","j-modal-header"],["type","button",1,"close",3,"click"],["src","/assets/icons/close.svg",3,"alt"],[1,"modal-body","j-modal-body","text-center","pb-4"],["src","/assets/img/history/modals/success.svg",3,"alt"],["translate","",1,"light","mb-3","mt-2"],["class","result-group",4,"ngFor","ngForOf"],[1,"modal-footer","py-4","px-3","justify-content-center"],["translate","","type","button",1,"btn","btn-static","btn-link","m-0",3,"click"],[3,"inlineSVG"],[1,"result-group"],[3,"money"]],template:function(t,e){1&t&&(p.Wb(0,"div",0),p.Wb(1,"button",1),p.ic("click",(function(t){return e.dismissModal()})),p.Rb(2,"img",2),p.nc(3,"translate"),p.Vb(),p.Vb(),p.Wb(4,"div",3),p.Rb(5,"img",4),p.nc(6,"translate"),p.Wb(7,"h3",5),p.Tc(8,"HISTORY.SIGNED"),p.Vb(),p.Rc(9,it,6,7,"div",6),p.Vb(),p.Wb(10,"div",7),p.Wb(11,"button",8),p.ic("click",(function(t){return e.dismissModal()})),p.Tc(12," HISTORY.BACK_TO_HISTORY "),p.Rb(13,"span",9),p.Vb(),p.Vb()),2&t&&(p.Ab(2),p.vc("alt",p.oc(3,4,"SHARED.CLOSE")),p.Ab(3),p.vc("alt",p.oc(6,6,"HISTORY.SIGNED")),p.Ab(4),p.uc("ngForOf",e.groups),p.Ab(4),p.uc("inlineSVG","/assets/icons/shared/arrow-right.svg"))},directives:[P.a,c.t,H.a,Q.a],pipes:[P.d,c.q],styles:[""]}),rt);function at(t,e){1&t&&(p.Wb(0,"span"),p.Tc(1,", "),p.Vb())}function ct(t,e){if(1&t&&(p.Wb(0,"span"),p.Tc(1),p.Rc(2,at,2,0,"span",13),p.Vb()),2&t){var n,i=e.$implicit,r=e.index,s=p.mc().$implicit,a=r<(null==(n=p.mc().retrieveErrors(s))?null:n.length)-1;p.Ab(1),p.Vc(" ",i,""),p.Ab(1),p.uc("ngIf",a)}}function ot(t,e){if(1&t&&(p.Wb(0,"div"),p.Wb(1,"strong"),p.Tc(2),p.Vb(),p.Rc(3,ct,3,2,"span",12),p.Vb()),2&t){var n=e.$implicit,i=p.mc();p.Ab(2),p.Vc("\u2116",n.documentNumber,": "),p.Ab(1),p.uc("ngForOf",i.retrieveErrors(n))}}var ut,lt,dt,bt=((dt=function(){function t(e){_classCallCheck(this,t),this.modal=e}return _createClass(t,[{key:"dismissModal",value:function(){this.modal.dismiss()}},{key:"closeModal",value:function(){this.modal.close()}},{key:"retrieveErrors",value:function(t){return t.errorData?Object.entries(t.errorData).map((function(t){return t[1]})):t.errorMsg?[t.errorMsg]:[]}},{key:"failedCount",get:function(){var t;return(null===(t=this.signResult)||void 0===t?void 0:t.numberOfFailed)||0}},{key:"successCount",get:function(){var t;return(null===(t=this.signResult)||void 0===t?void 0:t.numberOfSuccess)||0}},{key:"failedText",get:function(){switch(this.failedCount%20){case 1:return"HISTORY.SEND_TO_SIGNED.FAILED.ONE";case 2:case 3:case 4:return"HISTORY.SEND_TO_SIGNED.FAILED.FEW";default:return"HISTORY.SEND_TO_SIGNED.FAILED.OTHER"}}},{key:"failedParams",get:function(){return{transactionsCount:this.failedCount}}},{key:"failedTransactions",get:function(){return this.signResult&&this.signResult.results&&this.signResult.results.filter((function(t){return t.status===w.b.FAILED}))}},{key:"successText",get:function(){switch(this.successCount%10){case 1:return"HISTORY.SEND_TO_SIGNED.SUCCESS.ONE";case 2:case 3:case 4:return"HISTORY.SEND_TO_SIGNED.SUCCESS.FEW";default:return"HISTORY.SEND_TO_SIGNED.SUCCESS.OTHER"}}},{key:"successParams",get:function(){return{transactionsCount:this.successCount}}}]),t}()).\u0275fac=function(t){return new(t||dt)(p.Qb(N.a))},dt.\u0275cmp=p.Kb({type:dt,selectors:[["j-send-to-signed-partial"]],inputs:{signResult:"signResult"},decls:19,vars:16,consts:[[1,"modal-header","j-modal-header"],["type","button",1,"close",3,"click"],["src","/assets/icons/close.svg",3,"alt"],[1,"modal-body","j-modal-body","text-center","pb-3"],["src","/assets/img/history/modals/partial.svg",3,"alt"],["translate","",1,"light","mb-3","mt-2"],[1,"m-0","text-muted",3,"innerHTML"],[1,"mt-0","text-muted",3,"innerHTML"],["translate","","type","button",1,"btn","btn-static","btn-link","m-0",3,"click"],[3,"inlineSVG"],[1,"modal-footer","bg-main","p-4","d-block","justify-content-start"],["translate","HISTORY.PARTIAL.SUBTITLE"],[4,"ngFor","ngForOf"],[4,"ngIf"]],template:function(t,e){1&t&&(p.Wb(0,"div",0),p.Wb(1,"button",1),p.ic("click",(function(t){return e.dismissModal()})),p.Rb(2,"img",2),p.nc(3,"translate"),p.Vb(),p.Vb(),p.Wb(4,"div",3),p.Rb(5,"img",4),p.nc(6,"translate"),p.Wb(7,"h3",5),p.Tc(8,"HISTORY.SEND_TO_SIGNED.PARTIAL"),p.Vb(),p.Rb(9,"p",6),p.nc(10,"translate"),p.Rb(11,"p",7),p.nc(12,"translate"),p.Wb(13,"button",8),p.ic("click",(function(t){return e.dismissModal()})),p.Tc(14," HISTORY.BACK_TO_HISTORY "),p.Rb(15,"span",9),p.Vb(),p.Vb(),p.Wb(16,"div",10),p.Rb(17,"h4",11),p.Rc(18,ot,4,2,"div",12),p.Vb()),2&t&&(p.Ab(2),p.vc("alt",p.oc(3,6,"SHARED.CLOSE")),p.Ab(3),p.vc("alt",p.oc(6,8,"HISTORY.SEND_TO_SIGNED.PARTIAL")),p.Ab(4),p.uc("innerHTML",p.pc(10,10,e.successText,e.successParams),p.Jc),p.Ab(2),p.uc("innerHTML",p.pc(12,13,e.failedText,e.failedParams),p.Jc),p.Ab(4),p.uc("inlineSVG","/assets/icons/shared/arrow-right.svg"),p.Ab(3),p.uc("ngForOf",e.failedTransactions))},directives:[P.a,H.a,c.t,c.u],pipes:[P.d],styles:[""]}),dt),mt=((lt=function(t){function e(t){var n;return _classCallCheck(this,e),(n=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this,t))).modal=t,n}return _inherits(e,t),e}(bt)).\u0275fac=function(t){return new(t||lt)(p.Qb(N.a))},lt.\u0275cmp=p.Kb({type:lt,selectors:[["j-send-to-signed-success"]],features:[p.xb],decls:15,vars:11,consts:[[1,"modal-header","j-modal-header"],["type","button",1,"close",3,"click"],["src","/assets/icons/close.svg",3,"alt"],[1,"modal-body","j-modal-body","text-center","pb-4"],["src","/assets/img/history/modals/success.svg",3,"alt"],["translate","",1,"light","mb-3","mt-2"],[1,"m-0","text-muted",3,"innerHTML"],[1,"modal-footer","py-4","px-3","justify-content-center"],["translate","","type","button",1,"btn","btn-static","btn-link","m-0",3,"click"],[3,"inlineSVG"]],template:function(t,e){1&t&&(p.Wb(0,"div",0),p.Wb(1,"button",1),p.ic("click",(function(t){return e.dismissModal()})),p.Rb(2,"img",2),p.nc(3,"translate"),p.Vb(),p.Vb(),p.Wb(4,"div",3),p.Rb(5,"img",4),p.nc(6,"translate"),p.Wb(7,"h3",5),p.Tc(8,"HISTORY.SEND_TO_SIGNED.SUCCESS.TITLE"),p.Vb(),p.Rb(9,"p",6),p.nc(10,"translate"),p.Vb(),p.Wb(11,"div",7),p.Wb(12,"button",8),p.ic("click",(function(t){return e.dismissModal()})),p.Tc(13," HISTORY.BACK_TO_HISTORY "),p.Rb(14,"span",9),p.Vb(),p.Vb()),2&t&&(p.Ab(2),p.vc("alt",p.oc(3,4,"SHARED.CLOSE")),p.Ab(3),p.vc("alt",p.oc(6,6,"HISTORY.SEND_TO_SIGNED.SUCCESS.TITLE")),p.Ab(4),p.uc("innerHTML",p.pc(10,8,e.successText,e.successParams),p.Jc),p.Ab(5),p.uc("inlineSVG","/assets/icons/shared/arrow-right.svg"))},directives:[P.a,H.a],pipes:[P.d],styles:[""]}),lt),pt=((ut=function(t){function e(t){var n;return _classCallCheck(this,e),(n=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this,t))).modal=t,n}return _inherits(e,t),e}(bt)).\u0275fac=function(t){return new(t||ut)(p.Qb(N.a))},ut.\u0275cmp=p.Kb({type:ut,selectors:[["j-send-to-signed-error"]],features:[p.xb],decls:17,vars:11,consts:[[1,"modal-header","j-modal-header"],["type","button",1,"close",3,"click"],["src","/assets/icons/close.svg",3,"alt"],[1,"modal-body","px-4","pt-0","pb-4","text-center"],["src","/assets/img/history/modals/error.svg",3,"alt"],["translate","",1,"light","mb-3","mt-2"],[1,"m-0","text-muted",3,"innerHTML"],[1,"modal-footer","py-4","px-3","justify-content-center"],["translate","","type","button",1,"btn","btn-primary","btn-block","mb-3",3,"click"],["translate","","type","button",1,"btn","btn-static","btn-link","m-0",3,"click"],[3,"inlineSVG"]],template:function(t,e){1&t&&(p.Wb(0,"div",0),p.Wb(1,"button",1),p.ic("click",(function(t){return e.dismissModal()})),p.Rb(2,"img",2),p.nc(3,"translate"),p.Vb(),p.Vb(),p.Wb(4,"div",3),p.Rb(5,"img",4),p.nc(6,"translate"),p.Wb(7,"h3",5),p.Tc(8,"HISTORY.SEND_TO_SIGNED.FAILED.TITLE"),p.Vb(),p.Rb(9,"p",6),p.nc(10,"translate"),p.Vb(),p.Wb(11,"div",7),p.Wb(12,"button",8),p.ic("click",(function(t){return e.closeModal()})),p.Tc(13," SHARED.TRY_AGAIN "),p.Vb(),p.Wb(14,"button",9),p.ic("click",(function(t){return e.dismissModal()})),p.Tc(15," HISTORY.BACK_TO_HISTORY "),p.Rb(16,"span",10),p.Vb(),p.Vb()),2&t&&(p.Ab(2),p.vc("alt",p.oc(3,4,"SHARED.CLOSE")),p.Ab(3),p.vc("alt",p.oc(6,6,"HISTORY.SEND_TO_SIGNED.FAILED.TITLE")),p.Ab(4),p.uc("innerHTML",p.pc(10,8,e.failedText,e.failedParams),p.Jc),p.Ab(7),p.uc("inlineSVG","/assets/icons/shared/arrow-right.svg"))},directives:[P.a,H.a],pipes:[P.d],styles:[""]}),ut);function ht(t,e){1&t&&(p.Wb(0,"span"),p.Tc(1,", "),p.Vb())}function ft(t,e){if(1&t&&(p.Wb(0,"span"),p.Tc(1),p.Rc(2,ht,2,0,"span",12),p.Vb()),2&t){var n,i=e.$implicit,r=e.index,s=p.mc().$implicit,a=r<(null==(n=p.mc().retrieveErrors(s))?null:n.length)-1;p.Ab(1),p.Vc(" ",i,""),p.Ab(1),p.uc("ngIf",a)}}function vt(t,e){if(1&t&&(p.Wb(0,"div"),p.Wb(1,"strong"),p.Tc(2),p.Vb(),p.Rc(3,ft,3,2,"span",11),p.Vb()),2&t){var n=e.$implicit,i=p.mc();p.Ab(2),p.Vc("\u2116",n.documentNumber,": "),p.Ab(1),p.uc("ngForOf",i.retrieveErrors(n))}}var gt,St=((gt=function(t){function e(t){var n;return _classCallCheck(this,e),(n=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this,t))).modal=t,n}return _inherits(e,t),e}(bt)).\u0275fac=function(t){return new(t||gt)(p.Qb(N.a))},gt.\u0275cmp=p.Kb({type:gt,selectors:[["j-send-to-signed-partial-error"]],features:[p.xb],decls:17,vars:12,consts:[[1,"modal-header","j-modal-header"],["type","button",1,"close",3,"click"],["src","/assets/icons/close.svg",3,"alt"],[1,"modal-body","j-modal-body","text-center","pb-3"],["src","/assets/img/history/modals/error.svg",3,"alt"],["translate","",1,"light","mb-3","mt-2"],[1,"mt-0","text-muted",3,"innerHTML"],["translate","","type","button",1,"btn","btn-static","btn-link","m-0",3,"click"],[3,"inlineSVG"],[1,"modal-footer","bg-main","p-4","d-block","justify-content-start"],["translate","HISTORY.PARTIAL.SUBTITLE"],[4,"ngFor","ngForOf"],[4,"ngIf"]],template:function(t,e){1&t&&(p.Wb(0,"div",0),p.Wb(1,"button",1),p.ic("click",(function(t){return e.dismissModal()})),p.Rb(2,"img",2),p.nc(3,"translate"),p.Vb(),p.Vb(),p.Wb(4,"div",3),p.Rb(5,"img",4),p.nc(6,"translate"),p.Wb(7,"h3",5),p.Tc(8,"HISTORY.FAILED.TITLE"),p.Vb(),p.Rb(9,"p",6),p.nc(10,"translate"),p.Wb(11,"button",7),p.ic("click",(function(t){return e.dismissModal()})),p.Tc(12," HISTORY.BACK_TO_HISTORY "),p.Rb(13,"span",8),p.Vb(),p.Vb(),p.Wb(14,"div",9),p.Rb(15,"h5",10),p.Rc(16,vt,4,2,"div",11),p.Vb()),2&t&&(p.Ab(2),p.vc("alt",p.oc(3,5,"SHARED.CLOSE")),p.Ab(3),p.vc("alt",p.oc(6,7,"HISTORY.FAILED.TITLE")),p.Ab(4),p.uc("innerHTML",p.pc(10,9,e.failedText,e.failedParams),p.Jc),p.Ab(4),p.uc("inlineSVG","/assets/icons/shared/arrow-right.svg"),p.Ab(3),p.uc("ngForOf",e.failedTransactions))},directives:[P.a,H.a,c.t,c.u],pipes:[P.d],styles:[""]}),gt);function yt(t,e){1&t&&(p.Rb(0,"img",14),p.nc(1,"translate")),2&t&&p.vc("alt",p.oc(1,1,"HISTORY.VALIDATION.ERROR"))}function Tt(t,e){1&t&&(p.Rb(0,"img",15),p.nc(1,"translate")),2&t&&p.vc("alt",p.oc(1,1,"HISTORY.VALIDATION.ERROR"))}function Rt(t,e){if(1&t&&(p.Wb(0,"p",16),p.Wb(1,"span",17),p.Tc(2,"HISTORY.OPERATION.FEW"),p.Vb(),p.Tc(3,": "),p.Wb(4,"strong"),p.Tc(5),p.Vb(),p.Vb()),2&t){var n=p.mc();p.Ab(5),p.Wc("",n.successCount,"/",n.totalCount,"")}}function Ot(t,e){if(1&t&&(p.Wb(0,"div",18),p.Tc(1),p.nc(2,"lowercase"),p.nc(3,"translate"),p.Wb(4,"strong"),p.Rb(5,"j-money",19),p.Vb(),p.Vb()),2&t){var n=e.$implicit,i=p.mc();p.Ab(1),p.Wc(" ",n.count," ",p.oc(2,3,p.oc(3,5,i.mapCountLabel(n.count)))," \u2013 "),p.Ab(4),p.uc("money",n.money)}}function It(t,e){1&t&&(p.Wb(0,"span"),p.Tc(1,", "),p.Vb())}function Et(t,e){if(1&t&&(p.Wb(0,"span"),p.Tc(1),p.Rc(2,It,2,0,"span",20),p.Vb()),2&t){var n,i=e.$implicit,r=e.index,s=p.mc().$implicit,a=r<(null==(n=p.mc().retrieveErrors(s.errorData))?null:n.length)-1;p.Ab(1),p.Vc(" ",i,""),p.Ab(1),p.uc("ngIf",a)}}function kt(t,e){if(1&t&&(p.Wb(0,"div"),p.Wb(1,"strong"),p.Tc(2),p.Vb(),p.Rc(3,Et,3,2,"span",13),p.Vb()),2&t){var n=e.$implicit,i=p.mc();p.Ab(2),p.Vc("\u2116",n.documentNumber,": "),p.Ab(1),p.uc("ngForOf",i.retrieveErrors(n.errorData))}}var At,Ct,_t=((At=function(){function t(e){_classCallCheck(this,t),this.modal=e}return _createClass(t,[{key:"ngOnInit",value:function(){this.generateGroups()}},{key:"dismissModal",value:function(){this.modal.dismiss()}},{key:"closeModal",value:function(){this.modal.close()}},{key:"retrieveErrors",value:function(t){return Object.entries(t).map((function(t){return t[1]}))}},{key:"mapCountLabel",value:function(t){switch(t%20){case 1:return"HISTORY.OPERATION.ONE";default:return"HISTORY.OPERATION.OTHER"}}},{key:"generateGroups",value:function(){var t={};this.result.results.forEach((function(e){var n,i=null===(n=e.result)||void 0===n?void 0:n.amount;i&&(t[i.currency]?(t[i.currency].money.amount+=i.amount,t[i.currency].count++):t[i.currency]={money:{currency:i.currency,amount:i.amount},count:1})})),this.groups=Object.values(t)}},{key:"totalBalance",get:function(){return this.result&&this.result.totalBalance}},{key:"successCount",get:function(){return this.result&&this.result.numberOfSuccess}},{key:"totalCount",get:function(){return this.result&&this.result.results.length}},{key:"successParams",get:function(){return{transactionsCount:this.successCount}}},{key:"failedText",get:function(){if(!this.result)return"HISTORY.VALIDATION.ERROR";switch(this.result&&this.result.numberOfFailed%10){case 1:return"HISTORY.VALIDATION.ONE";case 2:case 3:case 4:return"HISTORY.VALIDATION.FEW";default:return"HISTORY.VALIDATION.OTHER"}}},{key:"failedParams",get:function(){return{transactionsCount:this.result&&this.result.numberOfFailed}}},{key:"failedTransactions",get:function(){return this.result&&this.result.results&&this.result.results.filter((function(t){return t.status===w.b.FAILED}))}}]),t}()).\u0275fac=function(t){return new(t||At)(p.Qb(N.a))},At.\u0275cmp=p.Kb({type:At,selectors:[["j-validation-error"]],inputs:{result:"result"},decls:17,vars:13,consts:[[1,"modal-header","j-modal-header"],["type","button",1,"close",3,"click"],["src","/assets/icons/close.svg",3,"alt"],[1,"modal-body","j-modal-body","text-center","pb-3"],["src","/assets/img/history/modals/partial.svg",3,"alt",4,"ngIf"],["src","/assets/img/history/modals/error.svg",3,"alt",4,"ngIf"],["class","m-0 text-muted",4,"ngIf"],["class","result-group",4,"ngFor","ngForOf"],[1,"mt-0","text-muted",3,"innerHTML"],["translate","","type","button",1,"btn","btn-static","btn-link","m-0",3,"click"],[3,"inlineSVG"],[1,"modal-footer","bg-main","p-4","d-block","justify-content-start"],["translate","HISTORY.PARTIAL.SUBTITLE"],[4,"ngFor","ngForOf"],["src","/assets/img/history/modals/partial.svg",3,"alt"],["src","/assets/img/history/modals/error.svg",3,"alt"],[1,"m-0","text-muted"],["translate",""],[1,"result-group"],[3,"money"],[4,"ngIf"]],template:function(t,e){1&t&&(p.Wb(0,"div",0),p.Wb(1,"button",1),p.ic("click",(function(t){return e.dismissModal()})),p.Rb(2,"img",2),p.nc(3,"translate"),p.Vb(),p.Vb(),p.Wb(4,"div",3),p.Rc(5,yt,2,3,"img",4),p.Rc(6,Tt,2,3,"img",5),p.Rc(7,Rt,6,2,"p",6),p.Rc(8,Ot,6,7,"div",7),p.Rb(9,"p",8),p.nc(10,"translate"),p.Wb(11,"button",9),p.ic("click",(function(t){return e.dismissModal()})),p.Tc(12," HISTORY.BACK_TO_HISTORY "),p.Rb(13,"span",10),p.Vb(),p.Vb(),p.Wb(14,"div",11),p.Rb(15,"h4",12),p.Rc(16,kt,4,2,"div",13),p.Vb()),2&t&&(p.Ab(2),p.vc("alt",p.oc(3,8,"SHARED.CLOSE")),p.Ab(3),p.uc("ngIf",e.successCount>0),p.Ab(1),p.uc("ngIf",0===e.successCount),p.Ab(1),p.uc("ngIf",e.totalCount&&e.successCount),p.Ab(1),p.uc("ngForOf",e.groups),p.Ab(1),p.uc("innerHTML",p.pc(10,10,e.failedText,e.failedParams),p.Jc),p.Ab(4),p.uc("inlineSVG","/assets/icons/shared/arrow-right.svg"),p.Ab(3),p.uc("ngForOf",e.failedTransactions))},directives:[c.u,c.t,P.a,H.a,Q.a],pipes:[P.d,c.q],styles:[""]}),At),Ft=n("tk/3"),Lt=n("p6Hd"),Vt=n("KWy3"),xt=n("YMfE"),wt=n("4wRv"),Dt=n("LRne"),Nt=n("rEgK"),Pt=n("VnnJ"),Ht=n("jZlK"),Wt=n("mR7B"),jt=n("7rOj"),Mt=((Ct=function(){function t(e,n,i,r,s,a,c,o,u,l){_classCallCheck(this,t),this.config=e,this.statementService=n,this.companyService=i,this.api=r,this.http=s,this.translateService=a,this.filterService=c,this.maskedService=o,this.curSymbolPipe=u,this.featureFlagsService=l,this.baseUrl=e.baseUrl}return _createClass(t,[{key:"getTransactionGroup",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:w.h.DOMESTIC,n=arguments.length>1?arguments[1]:void 0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:50;if(this.cashedCategory===e&&this.cashedTransactionGroup&&this.cashedFilter===n&&this.cashedPageNumber===i&&this.cashedPageSize===r)return Object(Dt.a)(this.cashedTransactionGroup);var s=this.cashedFilter===n&&i>this.cashedPageNumber;return this.getHistoryListObservable(e,n,i,r).pipe(Object(k.a)((function(a){t.cashedCategory=e,t.cashedFilter=n,t.cashedPageNumber=i,t.cashedPageSize=r;var c=t.mapHistoryPayments(a.body),o=s?t.cashedTransactionGroup.transactions.concat(c):c;return n.paymentStatus===x.d.FOR_SIGN&&(o=(o=o.sort(t.compareBySignature)).sort(t.compareByDate)),n.paymentStatus===x.d.FAILED&&t.markFailedAsRead(),t.cashedTransactionGroup={title:t.generateGroupTitle(n.paymentStatus),creditSum:null,debitSum:t.getTotalAmount(o),hasLargeTransactions:t.statementService.checkListForLargeTransactions(o),transactionsCount:o.length,transactions:o},t.cashedTransactionGroup})))}},{key:"getHistoryList",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:50;return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function r(){var s,a,c;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return s="companies/".concat(this.companyService.currentId,"/payments"),a=new Ft.g,c=new Ft.h,r.abrupt("return",(c=(c=(c=this.appendCategoryParams(t,c)).append("page","".concat(n))).append("pageSize","".concat(i)),c=this.appendFilterParams(e,c),this.api.get(s,a,c,{observe:"response"})));case 3:case"end":return r.stop()}}),r,this)})))}},{key:"getHistoryListObservable",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:50,r="".concat(this.baseUrl,"/companies/").concat(this.companyService.currentId,"/payments"),s=new Ft.g,a=new Ft.h;return a=(a=(a=this.appendCategoryParams(t,a)).append("page","".concat(n))).append("pageSize","".concat(i)),a=this.appendFilterParams(e,a),this.http.get(r,{params:a,headers:s,observe:"response"})}},{key:"sendMultipleTransactionsForSign",value:function(t){var e="companies/".concat(this.companyService.currentId,"/payments:to-created"),n=new Ft.h;return t.forEach((function(t){n=n.append("paymentId",t)})),this.api.patch(e,null,null,n)}},{key:"validateTransactionsByPaymentId",value:function(t,e){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,r,s;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i="companies/".concat(t,"/payments/signatures/validate"),r=new Ft.h,e.forEach((function(t){r=r.append("paymentId",t)})),s=(new Ft.g).append("Content-Type","application/x-www-form-urlencoded;charset=UTF-8"),n.abrupt("return",this.api.post(i,r,s));case 5:case"end":return n.stop()}}),n,this)})))}},{key:"signMultipleTransactions",value:function(t,e,n){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function i(){var r,s;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return r="companies/".concat(t,"/payments/signatures"),s=new Ft.g,i.abrupt("return",(s=s.set(e.type===w.q.OTP?Lt.c.OTP:Lt.c.PHONE,e.signature),this.api.post(r,{itemIds:n},s)));case 3:case"end":return i.stop()}}),i,this)})))}},{key:"deleteTransaction",value:function(t,e){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,r,s;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i="companies/".concat(t,"/payments"),r=new Ft.g,s=(new Ft.h).set("id",e.id),n.abrupt("return",this.api.delete(i,r,s));case 3:case"end":return n.stop()}}),n,this)})))}},{key:"revokePayment",value:function(t,e){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.api.patch("companies/".concat(t,"/payments/").concat(e.paymentId,":to-revoked")));case 1:case"end":return n.stop()}}),n,this)})))}},{key:"deleteMultipleTransactions",value:function(t,e){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,r,s;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i="companies/".concat(t,"/payments"),r=new Ft.g,s=new Ft.h,n.abrupt("return",(e.forEach((function(t){s=s.append("id",t.id)})),this.api.delete(i,r,s)));case 3:case"end":return n.stop()}}),n,this)})))}},{key:"isRemovable",value:function(t){return t.status.code===w.i.CREATED||t.status.code===w.i.DRAFT}},{key:"isEditable",value:function(t){return!(t.type===w.j.CONVERSION&&t.status.code!==w.i.CREATED||t.status.code!==w.i.DRAFT&&t.status.code!==w.i.CREATED)}},{key:"isRevokable",value:function(t){return t.status.code===w.i.READY_TO_SEND}},{key:"getSignsCountText",value:function(t){return"".concat(t.signatures&&t.signatures.length||0,"/").concat(this.companyService.isMultipleSignScheme(t.signatureScheme)?2:1)}},{key:"appendCategoryParams",value:function(t,e){switch(t){case w.h.ALL:e=(e=(e=e.append("category",w.h.DOMESTIC)).append("category",w.h.FOREIGN)).append("category",w.h.CONVERSION);break;default:e=e.append("category",t)}return e}},{key:"appendFilterParams",value:function(t,e){switch(e=this.appendStatusToParams(t.paymentStatus,e),t.documentNumber&&(e=e.append("documentNumber",t.documentNumber)),t.periodFrom&&(e=e.append("dateFrom",Object(xt.convertDateToApiFormat)(t.periodFrom))),t.periodTo&&(e=e.append("dateTo",Object(xt.convertDateToApiFormat)(t.periodTo))),t.amountFrom&&(e=e.append("amountFrom","".concat(t.amountFrom))),t.amountTo&&(e=e.append("amountTo","".concat(t.amountTo))),t.recipientIban&&(e=e.append("correspondentAccount",t.recipientIban)),t.recipientBin&&(e=e.append("correspondentBin",t.recipientBin)),t.type&&(e=e.append("type",t.type)),t.sortBy){case x.f.AMOUNT_ASC:e=e.append("sortBy","AMOUNT");break;case x.f.AMOUNT_DESC:e=e.append("sortBy","-AMOUNT")}return e}},{key:"appendStatusToParams",value:function(t,e){switch(t){case x.d.ALL:e=(e=(e=(e=(e=(e=(e=(e=e.append("status",w.i.DRAFT)).append("status",w.i.CREATED)).append("status",w.i.REJECTED)).append("status",w.i.BANK_COMPLETED)).append("status",w.i.BANK_PROCESSING)).append("status",w.i.BANK_SENT)).append("status",w.i.READY_TO_SEND)).append("status",w.i.IN_BANK);break;case x.d.DRAFT:e=e.append("status",w.i.DRAFT);break;case x.d.FOR_SIGN:e=e.append("status",w.i.CREATED);break;case x.d.FAILED:e=e.append("status",w.i.REJECTED);break;case x.d.SUCCESS:e=e.append("status",w.i.BANK_COMPLETED);break;case x.d.IN_PROGRESS:e=(e=(e=(e=e.append("status",w.i.BANK_PROCESSING)).append("status",w.i.BANK_SENT)).append("status",w.i.READY_TO_SEND)).append("status",w.i.IN_BANK)}return e}},{key:"compareByDate",value:function(t,e){return t.paymentStatus.timestamp<e.paymentStatus.timestamp?1:t.paymentStatus.timestamp>e.paymentStatus.timestamp?-1:0}},{key:"updateForSignCount",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0;return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function i(){var r,s,a,c=this;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(this.filterService.updateForSignCount(null),e){i.next=5;break}return i.next=3,this.retrivePaymentsByStatus(x.d.FOR_SIGN,n);case 3:r=i.sent,e=r.payments;case 5:s=0,a=0,null===(t=e)||void 0===t||t.forEach((function(t){var e;c.companyService.isSignable(t.status.code,t.signatureScheme,c.companyService.currentAuthority.authority,null===(e=t.signatures)||void 0===e?void 0:e.length)?s++:a++})),0==s&&0==a?this.filterService.updateForSignCount(0):s>0?this.filterService.updateForSignCount(s,!0):this.filterService.updateForSignCount(a);case 7:case"end":return i.stop()}}),i,this)})))}},{key:"retrivePaymentsByStatus",value:function(t,e){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,r,s,a,c,o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=0,r=null,s="companies/".concat(this.companyService.currentId,"/payments"),a=new Ft.g,c=new Ft.h,c=this.appendStatusToParams(t,c),c=(c=this.appendCategoryParams(e,c)).append("pageSize","100000"),n.prev=4,n.next=7,this.api.get(s,a,c,{observe:"response"});case 7:o=n.sent,r=o.body,i=+o.headers.get("X-Total-Count"),n.next=13;break;case 11:n.prev=11,n.t0=n.catch(4);case 13:return n.prev=13,n.abrupt("return",{payments:r,count:i});case 16:case"end":return n.stop()}}),n,this,[[4,11,13,16]])})))}},{key:"updateStatusCounts",value:function(t){this.updateForSignCount(null,t),this.updateCountsByBadges(t)}},{key:"isSignable",value:function(t){var e,n=this.companyService.isSignable(t.status.code,t.signatureScheme,this.companyService.currentAuthority.authority,null===(e=t.signatures)||void 0===e?void 0:e.length);return t.status.code===w.i.DRAFT?n&&this.isCorrectlyFullfilled(t):n}},{key:"isSignableByOthers",value:function(t){var e;return this.companyService.isSignableByOthers(t.status.code,t.signatureScheme,this.companyService.currentAuthority.authority,null===(e=t.signatures)||void 0===e?void 0:e.length)}},{key:"isSendableForSign",value:function(t){var e=this.isSignableByOthers(t),n=this.companyService.isSendableForSign(t.status.code,t.signatureScheme,this.companyService.currentAuthority.authority);return!e&&n}},{key:"isCorrectlyFullfilled",value:function(t){return!0}},{key:"markFailedAsRead",value:function(){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e="companies/".concat(this.companyService.currentId,"/payments/badges:mark-read-rejected"),t.prev=1,t.next=4,this.api.put(e);case 4:t.next=8;break;case 6:t.prev=6,t.t0=t.catch(1);case 8:return t.prev=8,this.filterService.updateFailedCount(0),t.finish(8);case 11:case"end":return t.stop()}}),t,this,[[1,6,8,11]])})))}},{key:"updateCountsByBadges",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,i,r,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.filterService.updateInProgressCount(null),this.filterService.updateFailedCount(null),n=0,i=0,r="companies/".concat(this.companyService.currentId,"/payments/badges"),s=new Ft.h,s=this.appendCategoryParams(t,s),e.prev=5,e.next=8,this.api.get(r,null,s);case 8:e.t0=function(t){switch(t.statusCode){case w.i.READY_TO_SEND:case w.i.IN_BANK:case w.i.BANK_PROCESSING:case w.i.BANK_SENT:n+=t.count;break;case w.i.REJECTED:i+=t.count}},e.sent.forEach(e.t0),e.next=14;break;case 12:e.prev=12,e.t1=e.catch(5);case 14:return e.prev=14,this.filterService.updateInProgressCount(n),this.filterService.updateFailedCount(i),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[5,12,14,17]])})))}},{key:"getTotalAmount",value:function(t){var e=0,n=null;return t.forEach((function(t){t.balance&&(t.balance.currency&&!n&&(n=t.balance.currency),e+=t.balance.amount)})),{currency:n,amount:e}}},{key:"mapDescription",value:function(t){var e,n,i,r,s,a,c;switch(t.type){case w.j.CONVERSION:var o,u=this.maskedService.getMaskedAmount(null===(e=t.details.exchangeRate)||void 0===e?void 0:e.calculatedSum),l=this.curSymbolPipe.transform(null===(n=t.details.exchangeRate)||void 0===n?void 0:n.currencyTo);return(o=u&&l?this.translateService.instant("CONVERSION.DESCRIPTION",{money:"".concat(u," ").concat(l),iban:t.paymentRecipient.recipientAccount.iban}):(null===(i=t.details)||void 0===i?void 0:i.description)||null)?"".concat(o," ").concat((null===(r=t.details.conversionPurpose)||void 0===r?void 0:r.description)||""):(null===(s=t.details.conversionPurpose)||void 0===s?void 0:s.description)?"".concat(null===(a=t.details.conversionPurpose)||void 0===a?void 0:a.description):null;default:return(null===(c=t.details)||void 0===c?void 0:c.description)||null}}},{key:"mapHistoryPayments",value:function(t){var e=this;return t.map((function(t,n){var i,r,s,a,c,o,u,l,d,b,m,p,h,f,v,g,S,y,T,R,O,I,E={id:t.id||null,iban:(null===(i=t.details)||void 0===i?void 0:i.payerIban)||null,reference:t.id||null,documentNumber:(null===(r=t.details)||void 0===r?void 0:r.documentId)||null,correspondentBankBic:(null===(a=null===(s=t.paymentRecipient)||void 0===s?void 0:s.recipientAccount)||void 0===a?void 0:a.bic)||null,correspondentAccount:(null===(o=null===(c=t.paymentRecipient)||void 0===c?void 0:c.recipientAccount)||void 0===o?void 0:o.iban)||null,correspondentName:(null===(u=t.paymentRecipient)||void 0===u?void 0:u.name)||null,kbe:(null===(l=t.paymentRecipient)||void 0===l?void 0:l.kbe)||null,correspondentBin:(null===(d=t.paymentRecipient)||void 0===d?void 0:d.iinOrBin)||null,debit:(null===(b=t.details)||void 0===b?void 0:b.paymentAmount)||null,credit:null,description:e.mapDescription(t),documentDate:(null===(m=t.details)||void 0===m?void 0:m.issueDate)||null,valueDate:(null===(p=t.details)||void 0===p?void 0:p.valueDate)||null,knp:(null===(h=t.details)||void 0===h?void 0:h.knp)||null,kbk:(null===(f=t.details)||void 0===f?void 0:f.kbk)||null,signHead:null,signBuch:null,isPayment:!0,paymentId:t.id,paymentStatus:t.status||null,paymentType:t.type||null,paymentEmployees:t.paymentEmployees,createDate:(null===(v=t.details)||void 0===v?void 0:v.createDate)||null,foreignPaymentDetails:t.details.foreignPaymentDetails||null,foreignRecipient:{country:null===(g=t.paymentRecipient)||void 0===g?void 0:g.country,countryCode:null===(S=t.paymentRecipient)||void 0===S?void 0:S.countryCode,cityName:null===(y=t.paymentRecipient)||void 0===y?void 0:y.cityName,bic:null===(R=null===(T=t.paymentRecipient)||void 0===T?void 0:T.recipientAccount)||void 0===R?void 0:R.bic,bankName:null===(I=null===(O=t.paymentRecipient)||void 0===O?void 0:O.recipientAccount)||void 0===I?void 0:I.bankName},emailOnSuccess:t.emailOnSuccess||null,signatureScheme:t.signatureScheme||null,signatures:t.signatures||[]},k=new Vt.c(E,e.translateService);return e.isFeatureDisabled(t.type)?(k.isExportable=!1,k.isRepeatable=!1,k.isEditable=!1,k.isRemovable=!1,k.isSignable=!1,k.isSendableForSign=!1,k.isRevokable=!1):(k.isExportable=e.isExportable(t),k.isRepeatable=e.isRepeatable(t),k.isEditable=e.isEditable(t),k.isRemovable=e.isRemovable(t),k.isSignable=e.isSignable(t),k.isSendableForSign=e.isSendableForSign(t),k.isRevokable=e.isRevokable(t)),k.hasTour=k.isRepeatable&&0==n&&1==e.cashedPageNumber,k.isSignableByOthers=e.isSignableByOthers(t),k.signsCountText=e.getSignsCountText(k),k}))}},{key:"isFeatureDisabled",value:function(t){var e=t==w.j.CONVERSION&&this.featureFlagsService.isDisabled(wt.a.CONVERSION),n=t==w.j.FOREIGN&&this.featureFlagsService.isDisabled(wt.a.FOREIGN_PAYMENT);return e||n||!1}},{key:"isRepeatable",value:function(t){return(t.status.state!=w.d.MIGRATED||t.category!==w.h.CONVERSION)&&t.status.code!=w.i.DRAFT}},{key:"isExportable",value:function(t){return(t.status.state!==w.d.MIGRATED||t.category!==w.h.CONVERSION)&&t.status.code!==w.i.CREATED}},{key:"generateGroupTitle",value:function(t){switch(t){case x.d.ALL:return"HISTORY.LISTS.ALL";case x.d.FOR_SIGN:return"HISTORY.LISTS.FOR_SIGN";case x.d.FOR_SIGN_OTHERS:return"HISTORY.LISTS.FOR_SIGN_OTHERS";case x.d.SUCCESS:return"HISTORY.LISTS.SUCCESS";case x.d.FAILED:return"HISTORY.LISTS.FAILED";case x.d.IN_PROGRESS:return"HISTORY.LISTS.IN_PROGRESS";case x.d.DRAFT:return"HISTORY.LISTS.DRAFT"}}},{key:"compareBySignature",value:function(t,e){return t.isSignable&&e.isSignable?0:t.isSignable&&e.isSignableByOthers?-1:1}}]),t}()).\u0275fac=function(t){return new(t||Ct)(p.ec("config"),p.ec(Nt.a),p.ec(Pt.a),p.ec(Lt.a),p.ec(Ft.c),p.ec(P.e),p.ec(Ht.a),p.ec(Wt.a),p.ec(jt.c),p.ec(wt.b))},Ct.\u0275prov=p.Mb({token:Ct,factory:Ct.\u0275fac,providedIn:"root"}),Ct),Yt=n("1ua0"),Gt=n("yZrb"),Bt=n("ZF+8"),Kt=n("iCQh"),Ut=n("VO+5"),Qt=n("THGi"),Jt=n("/68H"),$t=n("QiVB");function zt(t,e){if(1&t&&(p.Wb(0,"a",10),p.Tc(1),p.Vb()),2&t){var n=e.$implicit;p.uc("routerLink",n.url),p.Ab(1),p.Uc(n.label)}}function Xt(t,e){1&t&&(p.Wb(0,"div",11),p.Rb(1,"j-statement-loading"),p.Vb())}function qt(t,e){if(1&t&&(p.Wb(0,"div",25),p.Wb(1,"div"),p.Wb(2,"span",26),p.Tc(3,"HISTORY.OPERATION.OTHER"),p.Vb(),p.Tc(4,": "),p.Wb(5,"strong"),p.Tc(6),p.Vb(),p.Vb(),p.Wb(7,"div"),p.Wb(8,"span",26),p.Tc(9,"HISTORY.FOR_AMOUNT"),p.Vb(),p.Tc(10,": "),p.Wb(11,"strong"),p.Rb(12,"j-money",27),p.Vb(),p.Vb(),p.Vb()),2&t){var n=p.mc(3);p.Ab(6),p.Vc(" ",n.totalCount," "),p.Ab(6),p.uc("money",n.totalBalance)}}function Zt(t,e){if(1&t&&(p.Wb(0,"div",25),p.Wb(1,"strong"),p.Rb(2,"j-money",27),p.Vb(),p.Tc(3),p.Vb()),2&t){var n=e.$implicit;p.Ab(2),p.uc("money",n.balance),p.Ab(1),p.Vc(" (",n.count,") ")}}function te(t,e){if(1&t&&p.Rc(0,Zt,4,2,"div",28),2&t){var n=p.mc(3);p.uc("ngForOf",n.currencies)}}function ee(t,e){if(1&t&&(p.Wb(0,"div",25),p.Wb(1,"strong"),p.Rb(2,"j-money",27),p.Vb(),p.Tc(3),p.Vb()),2&t){var n=e.$implicit;p.Ab(2),p.uc("money",n.balance),p.Ab(1),p.Vc(" (",n.count,") ")}}function ne(t,e){if(1&t&&(p.Rc(0,ee,4,2,"div",28),p.Wb(1,"div",29),p.Tc(2,"+ "),p.Vb()),2&t){p.mc();var n=p.Fc(10),i=p.mc(2);p.uc("ngForOf",i.currencies.splice(0,4)),p.Ab(1),p.uc("ngbTooltip",n)}}function ie(t,e){if(1&t&&(p.Wb(0,"div"),p.Wb(1,"strong"),p.Rb(2,"j-money",27),p.Vb(),p.Tc(3),p.Vb()),2&t){var n=e.$implicit;p.Ab(2),p.uc("money",n.balance),p.Ab(1),p.Vc(" (",n.count,") ")}}function re(t,e){if(1&t&&p.Rc(0,ie,4,2,"div",30),2&t){var n=p.mc(3);p.uc("ngForOf",n.currencies.splice(3,n.currencies.length))}}function se(t,e){if(1&t){var n=p.Xb();p.Wb(0,"a",32),p.ic("click",(function(t){return p.Ic(n),p.mc(4).exportSelectedTransactions(t)})),p.nc(1,"translate"),p.Vb()}2&t&&p.uc("ngbTooltip",p.oc(1,2,"HISTORY.DOWNLOAD_SELECTED"))("inlineSVG","/assets/icons/transaction/pdf.svg")}function ae(t,e){if(1&t&&(p.Ub(0),p.Rc(1,se,2,4,"a",31),p.Tb()),2&t){var n=p.mc(3);p.Ab(1),p.uc("ngIf",n.isSelectableForExport&&n.selectedCount>0)}}function ce(t,e){if(1&t){var n=p.Xb();p.Ub(0),p.Wb(1,"a",33),p.ic("click",(function(t){return p.Ic(n),p.mc(4).signAll(t)})),p.Wb(2,"span",34),p.Tc(3,"HISTORY.SIGN_ALL"),p.Vb(),p.Rb(4,"span",35),p.Vb(),p.Tb()}2&t&&(p.Ab(4),p.uc("inlineSVG","/assets/icons/transaction/sign.svg"))}function oe(t,e){if(1&t){var n=p.Xb();p.Ub(0),p.Wb(1,"a",33),p.ic("click",(function(t){return p.Ic(n),p.mc(4).sendAllForSign(t)})),p.Wb(2,"span",34),p.Tc(3,"HISTORY.SEND_ALL_FOR_SIGN"),p.Vb(),p.Rb(4,"span",35),p.Vb(),p.Tb()}2&t&&(p.Ab(4),p.uc("inlineSVG","/assets/icons/transaction/for-sign.svg"))}function ue(t,e){if(1&t){var n=p.Xb();p.Wb(0,"a",37),p.ic("click",(function(t){return p.Ic(n),p.mc(5).signSelected(t)})),p.nc(1,"translate"),p.Vb()}2&t&&p.uc("ngbTooltip",p.oc(1,2,"HISTORY.SIGN_SELECTED"))("inlineSVG","/assets/icons/transaction/sign.svg")}function le(t,e){if(1&t){var n=p.Xb();p.Wb(0,"a",37),p.ic("click",(function(t){return p.Ic(n),p.mc(5).sendForSignSelected(t)})),p.nc(1,"translate"),p.Vb()}2&t&&p.uc("ngbTooltip",p.oc(1,2,"HISTORY.SEND_FOR_SIGN_SELECTED"))("inlineSVG","/assets/icons/transaction/for-sign.svg")}function de(t,e){if(1&t){var n=p.Xb();p.Ub(0),p.Wb(1,"a",32),p.ic("click",(function(t){return p.Ic(n),p.mc(4).deleteSelectedTransactions(t)})),p.nc(2,"translate"),p.Vb(),p.Rc(3,ue,2,4,"a",36),p.Rc(4,le,2,4,"a",36),p.Tb()}if(2&t){var i=p.mc(4);p.Ab(1),p.uc("ngbTooltip",p.oc(2,4,"HISTORY.DELETE_SELECTED"))("inlineSVG","/assets/icons/transaction/delete.svg"),p.Ab(2),p.uc("ngIf",i.isSignable),p.Ab(1),p.uc("ngIf",i.isSendableForSign)}}function be(t,e){if(1&t&&(p.Ub(0),p.Rc(1,ce,5,1,"ng-container",24),p.Rc(2,oe,5,1,"ng-container",24),p.Rc(3,de,5,6,"ng-container",24),p.Tb()),2&t){var n=p.mc(3);p.Ab(1),p.uc("ngIf",0==n.selectedCount&&n.isAllSignable),p.Ab(1),p.uc("ngIf",0==n.selectedCount&&n.isAllSendableForSign),p.Ab(1),p.uc("ngIf",n.selectedCount>0)}}function me(t,e){if(1&t){var n=p.Xb();p.Wb(0,"div",16),p.Wb(1,"div",17),p.ic("click",(function(t){return p.Ic(n),t.stopPropagation()})),p.Wb(2,"input",18),p.ic("ngModelChange",(function(t){return p.Ic(n),p.mc(2).isAllSelected=t}))("click",(function(t){return p.Ic(n),t.stopPropagation()}))("change",(function(t){return p.Ic(n),p.mc(2).selectAll()})),p.Vb(),p.Wb(3,"label",19),p.Tc(4,"HISTORY.SELECT_ALL"),p.Vb(),p.Vb(),p.Wb(5,"div",20),p.Rc(6,qt,13,2,"ng-template",21),p.Rc(7,te,1,1,"ng-template",21),p.Rc(8,ne,3,2,"ng-template",21),p.Rc(9,re,1,1,"ng-template",null,22,p.Sc),p.Wb(11,"div",23),p.Rc(12,ae,2,1,"ng-container",24),p.Rc(13,be,4,3,"ng-container",24),p.Vb(),p.Vb(),p.Vb()}if(2&t){var i=p.mc(2);p.Ab(2),p.uc("ngModel",i.isAllSelected),p.Ab(4),p.uc("ngIf",!i.currencies||(null==i.currencies?null:i.currencies.length)<=1),p.Ab(1),p.uc("ngIf",(null==i.currencies?null:i.currencies.length)>1&&(null==i.currencies?null:i.currencies.length)<=3),p.Ab(1),p.uc("ngIf",(null==i.currencies?null:i.currencies.length)>3),p.Ab(4),p.uc("ngIf",i.isSelectableForExport),p.Ab(1),p.uc("ngIf",i.isSelectable)}}function pe(t,e){1&t&&(p.Wb(0,"div",38),p.Tc(1," ACCOUNTS.STATEMENT.ALL_LOADED "),p.Vb())}function he(t,e){if(1&t){var n=p.Xb();p.Wb(0,"div",12),p.Rc(1,me,14,6,"div",13),p.Wb(2,"j-statement",14),p.ic("signed",(function(t){return p.Ic(n),p.mc().onSign(t)}))("sentForSign",(function(t){return p.Ic(n),p.mc().onSentForSign(t)}))("deleted",(function(t){return p.Ic(n),p.mc().onDelete(t)}))("revoked",(function(t){return p.Ic(n),p.mc().onRevoke(t)}))("selected",(function(t){return p.Ic(n),p.mc().onSelect()})),p.Vb(),p.Rc(3,pe,2,0,"div",15),p.Vb()}if(2&t){var i=p.mc();p.Hb("list-statement--scrollable",i.hasMorePages),p.Ab(1),p.uc("ngIf",i.totalCount&&(i.isSelectable||i.isSelectableForExport)),p.Ab(1),p.uc("statement",i.statement)("isTotalsShown",!1)("hasExtraPadding",!0)("isSelectable",i.isSelectable||i.isSelectableForExport),p.Ab(1),p.uc("ngIf",!i.hasMorePages&&(null==i.statement?null:i.statement.totalTransactionsCount)>0)}}var fe,ve,ge=((fe=function(){function t(e,n,i,r,s,a,c,o,u,l,d,b){var m=this;_classCallCheck(this,t),this.company=e,this.filterService=n,this.historyService=i,this.route=r,this.router=s,this.datePipe=a,this.modalService=c,this.filesService=o,this.maskedService=u,this.statementService=l,this.tourService=d,this.notifierService=b,this.filterScheme={periodTo:null,periodFrom:null},this.filterCurrency=D.a.KZT,this.filterMode=V.a.HISTORY,this.modalConfigSmall={backdropClass:"backdrop_light",windowClass:"modal_light modal_sm",backdrop:"static",centered:!0},this.modalConfigMedium={backdropClass:"backdrop_light",windowClass:"modal_light modal_md",backdrop:"static",centered:!0},this.historyTypes=[{label:"HISTORY.ALL",url:"/history/all"},{label:"HISTORY.TENGE_PAYMENTS",url:"/history/tenge"},{label:"HISTORY.CURRENCY_PAYMENTS",url:"/history/foreign"},{label:"HISTORY.CONVERSION",url:"/history/conversion"}],this.subscription=new R.a,this.pageNumber=1,this.pageSize=25,this.pageSizeForSign=1e5,this.hasMorePages=!0,this.isLoading=!0,this.isLoadingExtra=!0,this.isReady=!1,this.isTourShown=!1,this.tourStep=null,this.hasSignableSelected=!1,this.isAllSelected=!1,this.selectedTransactions=[],this.selectedCount=0,this.SESSION_ROUTE_KEY="historyRouteQuery",this.cashedRouteQuery=JSON.parse(sessionStorage.getItem(this.SESSION_ROUTE_KEY)),this.canBeNavigatedToForSign=!0;var p=this.route.paramMap.pipe(Object(k.a)((function(){return window.history.state}))).subscribe((function(t){m.tourStep=t.tourStep,m.tourService.onTourStart$.next(null)}));this.subscription.add(p);var h=Object(O.a)([this.route.queryParams,this.route.data]).pipe(Object(A.a)(1)).subscribe((function(t){var e=_slicedToArray(t,2),n=e[0],i=e[1];Object.keys(n).length>0&&(m.canBeNavigatedToForSign=!1),m.paymentCategory=i.category,m.cashedRouteQuery&&!n&&(n=m.cashedRouteQuery),m.updateCashedRouteQuery(n);var r=m.mapQueryParams(n);m.filterScheme=r,m.filterService.updateExtra(m.filterScheme)}));this.subscription.add(h);var f=this.company.refresh$.pipe(Object(C.a)((function(){return m.historyService.updateStatusCounts(m.paymentCategory)}))),v=this.filterService.getScheme(),g=Object(I.a)(v,f).pipe(Object(_.a)((function(t){return m.init(Array.isArray(t)?m.filterScheme:t)}))).subscribe((function(){})),S=this.filesService.onImport().subscribe((function(){m.init(m.filterScheme).toPromise(),m.historyService.updateStatusCounts(m.paymentCategory)})),y=this.filterService.getStatuses().subscribe((function(t){var e=t.find((function(t){return t.value==x.d.FOR_SIGN}));if(e.count>0&&e.classList.includes("badge-primary")&&m.canBeNavigatedToForSign){m.canBeNavigatedToForSign=!1;var n=Object.assign(m.filterScheme,{paymentStatus:x.d.FOR_SIGN});m.filterService.updateExtra(n)}}));this.subscription.add(g),this.subscription.add(S),this.subscription.add(y)}return _createClass(t,[{key:"init",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.filterService.getDefaults(this.filterMode);return this.filterScheme=Object.assign({},e),this.pageNumber=1,this.hasMorePages=!1,this.isLoading=!0,this.updateQueryParams(),this.loadStatement().pipe(Object(C.a)((function(){return t.updateSelectable()})))}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"onScroll",value:function(){this.hasMorePages&&(this.pageNumber++,this.loadStatement().toPromise())}},{key:"validateTransactionsByPaymentId",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.historyService.validateTransactionsByPaymentId(this.company.currentId,t);case 3:return n=e.sent,e.abrupt("return",(n.status!==w.b.SUCCESS&&this.showValidationError(n),n.status));case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",(this.showValidationError(e.t0),w.b.FAILED));case 10:case"end":return e.stop()}}),e,this,[[0,7]])})))}},{key:"onSign",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n={transactionIds:[t.id],totalBalance:t.balance,transactionsCount:1},e.prev=1,e.t0=t.paymentStatus.code===w.i.DRAFT,!e.t0){e.next=9;break}return e.next=6,this.validateTransactionsByPaymentId(n.transactionIds);case 6:e.t1=e.sent,e.t2=w.b.FAILED,e.t0=e.t1===e.t2;case 9:if(!e.t0){e.next=11;break}return e.abrupt("return");case 11:return e.next=13,this.showSignModal(n);case 13:this.historyService.updateForSignCount(null,this.paymentCategory),e.next=18;break;case 16:e.prev=16,e.t3=e.catch(1);case 18:case"end":return e.stop()}}),e,this,[[1,16]])})))}},{key:"onSentForSign",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.sendToSigned([t]);case 1:case"end":return e.stop()}}),e,this)})))}},{key:"onSelect",value:function(){this.updateSelectable()}},{key:"selectAll",value:function(){var t=this;this.currentTransactions.forEach((function(e){e.isSelected=t.isAllSelected})),this.updateSelectable(),this.isAllSelected=!0}},{key:"selectSignable",value:function(){var t=this;this.currentTransactions.forEach((function(e){e.isSelected=!!e.isSignable&&t.hasSignableSelected})),this.updateSelectable(),this.hasSignableSelected=!0}},{key:"signAll",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,i,r,s=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n={paymentStatus:this.filterScheme.paymentStatus},e.next=4,this.historyService.getHistoryList(this.paymentCategory,n,1,this.pageSizeForSign);case 4:if(e.t0=function(t){return s.historyService.isSignable(t)},i=e.sent.body.filter(e.t0),r={transactionIds:this.retrieveIdsFromList(i),totalBalance:this.countTotalBalanceFromPaymentsList(i),transactionsCount:i.length},e.t1=this.filterScheme.paymentStatus===x.d.DRAFT,!e.t1){e.next=14;break}return e.next=11,this.validateTransactionsByPaymentId(r.transactionIds);case 11:e.t2=e.sent,e.t3=w.b.FAILED,e.t1=e.t2===e.t3;case 14:if(e.t4=e.t1,e.t4){e.next=17;break}this.showSignModal(r);case 17:case"end":return e.stop()}}),e,this)})))}},{key:"sendAllForSign",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,i,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n={paymentStatus:x.d.DRAFT},e.next=4,this.historyService.getHistoryList(this.paymentCategory,n,1,this.pageSizeForSign);case 4:e.t0=function(t){return r.historyService.isSendableForSign(t)},i=e.sent.body.filter(e.t0),this.sendToSigned(i);case 7:case"end":return e.stop()}}),e,this)})))}},{key:"signSelected",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),n={transactionIds:this.retrieveIdsFromList(this.selectedTransactions),totalBalance:this.countTotalBalanceFromTransactionsList(this.selectedTransactions),transactionsCount:this.selectedTransactions.length},e.t0=this.filterScheme.paymentStatus===x.d.DRAFT,!e.t0){e.next=9;break}return e.next=6,this.validateTransactionsByPaymentId(n.transactionIds);case 6:e.t1=e.sent,e.t2=w.b.SUCCESS,e.t0=e.t1!==e.t2;case 9:if(e.t3=e.t0,e.t3){e.next=12;break}this.showSignModal(n);case 12:case"end":return e.stop()}}),e,this)})))}},{key:"sendForSignSelected",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),this.sendToSigned(this.selectedTransactions);case 1:case"end":return e.stop()}}),e,this)})))}},{key:"deleteSelectedTransactions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t&&t.preventDefault(),this.deleteTransactions(this.selectedTransactions);case 1:case"end":return e.stop()}}),e,this)})))}},{key:"exportSelectedTransactions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t&&t.preventDefault(),e.next=3,this.statementService.exportTransactions(this.selectedTransactions);case 3:n=e.sent,this.filesService.downloadFile(n,"".concat(this.selectedCount,"_operations.pdf"));case 5:case"end":return e.stop()}}),e,this)})))}},{key:"onDelete",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.deleteTransactions([t]);case 2:case"end":return e.stop()}}),e,this)})))}},{key:"onRevoke",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.prev=1,e.next=4,this.historyService.revokePayment(this.company.currentId,t);case 4:return e.next=6,this.init(this.filterScheme).toPromise();case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),this.notifierService.notify("error",e.t0.description||e.t0.code);case 11:return e.prev=11,this.historyService.updateForSignCount(null,this.paymentCategory),this.historyService.updateStatusCounts(this.paymentCategory),this.resetSelectable(),this.updateSelectable(),e.finish(11);case 14:case"end":return e.stop()}}),e,this,[[1,8,11,14]])})))}},{key:"deleteTransactions",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,i,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.forEach((function(t){t.isLoading=!0})),e.prev=1,e.next=4,this.historyService.deleteMultipleTransactions(this.company.currentId,t);case 4:return n=e.sent,e.next=7,this.init(this.filterScheme).toPromise();case 7:i=n.length,r=t.length-i,0===i?this.showDeleteError(t):0===r?this.showDeleteSuccess(i):this.showDeletePartial(i,r),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),this.showDeleteError(t);case 14:return e.prev=14,this.historyService.updateForSignCount(null,this.paymentCategory),this.resetSelectable(),this.updateSelectable(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])})))}},{key:"sendToSigned",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.historyService.sendMultipleTransactionsForSign(t.map((function(t){return t.id})));case 3:n=e.sent,e.t0=n.status,e.next=e.t0===w.b.SUCCESS?7:e.t0===w.b.PARTLY_SUCCESS?11:e.t0===w.b.FAILED?15:16;break;case 7:return this.showSendToSignedSuccess(n),e.next=10,this.init(this.filterScheme).toPromise();case 10:return e.abrupt("break",16);case 11:return this.showSendToSignedPartial(n),e.next=14,this.init(this.filterScheme).toPromise();case 14:return e.abrupt("break",16);case 15:this.showSendToSignedPartialError(n);case 16:e.next=21;break;case 18:e.prev=18,e.t1=e.catch(0),console.error(e.t1),this.showSendToSignedError(t);case 21:return e.prev=21,this.resetSelectable(),this.updateSelectable(),this.historyService.updateForSignCount(null,this.paymentCategory),e.finish(21);case 24:case"end":return e.stop()}}),e,this,[[0,18,21,24]])})))}},{key:"showSignModal",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.modalService.open(Yt.b,this.modalConfigMedium),Object.assign(n.componentInstance,{additionalParams:{actionIds:t.transactionIds}}),Object.assign(n.componentInstance,{headerParams:{smsHeader:Gt.c.SIGNING_PAYMENT}}),n.componentInstance.submitted.subscribe((function(e){i.signMultipleTransactions(e,t).then((function(){localStorage.setItem("preferredSignatureType",e.type===w.q.OTP?Yt.a.OTP:Yt.a.SMS)})).catch((function(e){i.showMultipleSignError(e.description||e.code,t)})).finally((function(){i.historyService.updateForSignCount(null,i.paymentCategory),n.close()}))})),n.componentInstance.sentForRevision.subscribe((function(){i.init(i.filterScheme).toPromise(),n.close()}));case 2:case"end":return e.stop()}}),e,this)})))}},{key:"signMultipleTransactions",value:function(t,e){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,this.historyService.signMultipleTransactions(this.company.currentId,t,e.transactionIds);case 3:i=n.sent,n.t0=i.status,n.next=n.t0===w.b.SUCCESS?7:n.t0===w.b.PARTLY_SUCCESS?11:n.t0===w.b.FAILED?15:16;break;case 7:return this.showMultipleSignSuccess(i),n.next=10,this.init(this.filterScheme).toPromise();case 10:return n.abrupt("break",16);case 11:return this.showMultipleSignPartialSuccess(i),n.next=14,this.init(this.filterScheme).toPromise();case 14:return n.abrupt("break",16);case 15:this.showMultipleSignPartialError(i);case 16:n.next=21;break;case 18:n.prev=18,n.t1=n.catch(0),this.showMultipleSignError(n.t1,e);case 21:return n.prev=21,this.updateSelectable(),this.historyService.updateForSignCount(null,this.paymentCategory),n.finish(21);case 24:case"end":return n.stop()}}),n,this,[[0,18,21,24]])})))}},{key:"loadStatement",value:function(){var t=this;return this.isLoadingExtra=!0,1===this.pageNumber&&(this.statement=null),this.historyService.getTransactionGroup(this.paymentCategory,this.filterScheme,this.pageNumber,this.filterScheme.paymentStatus===x.d.FOR_SIGN?this.pageSizeForSign:this.pageSize).pipe(Object(C.a)((function(e){t.hasMorePages=t.pageSize*t.pageNumber<=e.transactionsCount,t.statement={totalTransactionsCount:e.transactionsCount,transactionGroups:t.filterScheme.paymentStatus===x.d.FOR_SIGN?t.destructureForSignGroups(e):[e]},t.startHistoryTour()})),Object(F.a)((function(e){return console.log(e),t.statement=null,Object(E.a)(e)})),Object(L.a)((function(){t.isReady=!0,t.isLoading=!1,t.isLoadingExtra=!1})))}},{key:"startHistoryTour",value:function(){var t,e,n,i=this;this.isTourShown||(this.isTourShown=!0,("HISTORY_LIST.REPEAT"==this.tourStep||"HISTORY_HOME.NAV"==this.tourStep)&&(null===(n=null===(e=null===(t=this.statement)||void 0===t?void 0:t.transactionGroups[0])||void 0===e?void 0:e.transactions[0])||void 0===n?void 0:n.hasTour)&&setTimeout((function(){i.tourService.startTour(Bt.e.HISTORY_LIST)}),500))}},{key:"destructureForSignGroups",value:function(t){var e=t.transactions.filter((function(t){return t.isSignable})),n=t.transactions.filter((function(t){return t.isSignableByOthers}));return[{title:this.historyService.generateGroupTitle(x.d.FOR_SIGN),creditSum:null,debitSum:this.historyService.getTotalAmount(e),hasLargeTransactions:this.statementService.checkListForLargeTransactions(e),transactionsCount:e.length,transactions:e},{hasTour:!0,title:this.historyService.generateGroupTitle(x.d.FOR_SIGN_OTHERS),creditSum:null,debitSum:this.historyService.getTotalAmount(n),hasLargeTransactions:this.statementService.checkListForLargeTransactions(n),transactionsCount:n.length,transactions:n}]}},{key:"showValidationError",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.modalService.open(_t,this.modalConfigMedium),t.results=t.results.map((function(t){return t.documentNumber=i.getDocumentNumberById(t.itemId),t})),n.componentInstance.result=t;case 2:case"end":return e.stop()}}),e,this)})))}},{key:"showMultipleSignPartialSuccess",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.modalService.open(Z,this.modalConfigMedium),t.results=t.results.map((function(t){return t.documentNumber=i.getDocumentNumberById(t.itemId),t})),n.componentInstance.result=t;case 2:case"end":return e.stop()}}),e,this)})))}},{key:"showMultipleSignPartialError",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.modalService.open(U,this.modalConfigMedium),t.results=t.results.map((function(t){return t.documentNumber=i.getDocumentNumberById(t.itemId),t})),n.componentInstance.signResult=t;case 2:case"end":return e.stop()}}),e,this)})))}},{key:"showMultipleSignSuccess",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.modalService.open(st,this.modalConfigSmall).componentInstance.result=t;case 1:case"end":return e.stop()}}),e,this)})))}},{key:"showMultipleSignError",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1?arguments[1]:void 0;return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return(i=this.modalService.open(nt,this.modalConfigSmall)).componentInstance.errorText=t,n.prev=2,n.next=5,i.result;case 5:this.showSignModal(e),n.next=10;break;case 8:n.prev=8,n.t0=n.catch(2);case 10:case"end":return n.stop()}}),n,this,[[2,8]])})))}},{key:"showDeleteSuccess",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.modalService.open(M,this.modalConfigSmall).componentInstance.successCount=t;case 1:case"end":return e.stop()}}),e,this)})))}},{key:"showDeletePartial",value:function(t,e){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:(i=this.modalService.open(W,this.modalConfigMedium)).componentInstance.successCount=t,i.componentInstance.failedCount=e;case 2:case"end":return n.stop()}}),n,this)})))}},{key:"showDeleteError",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=this.modalService.open(j,this.modalConfigSmall)).componentInstance.failedCount=t.length,e.prev=2,e.next=5,n.result;case 5:this.deleteTransactions(t),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(2);case 10:case"end":return e.stop()}}),e,this,[[2,8]])})))}},{key:"showSendToSignedSuccess",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.modalService.open(mt,this.modalConfigSmall).componentInstance.signResult=t;case 1:case"end":return e.stop()}}),e,this)})))}},{key:"showSendToSignedPartial",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.modalService.open(bt,this.modalConfigMedium),t.results=t.results.map((function(t){return t.documentNumber=i.getDocumentNumberById(t.itemId),t})),n.componentInstance.signResult=t;case 2:case"end":return e.stop()}}),e,this)})))}},{key:"showSendToSignedPartialError",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.modalService.open(St,this.modalConfigMedium),t.results=t.results.map((function(t){return t.documentNumber=i.getDocumentNumberById(t.itemId),t})),n.componentInstance.signResult=t;case 2:case"end":return e.stop()}}),e,this)})))}},{key:"showSendToSignedError",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=this.modalService.open(pt,this.modalConfigSmall)).componentInstance.signResult={numberOfFailed:t.length,numberOfSuccess:0,status:w.b.FAILED},e.prev=2,e.next=5,n.result;case 5:this.sendToSigned(t),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(2);case 10:case"end":return e.stop()}}),e,this,[[2,8]])})))}},{key:"resetSelectable",value:function(){this.selectedTransactions=[],this.selectedCount=0,this.selectedBalance={amount:0,currency:null},this.isAllSelected=!1,this.hasSignableSelected=!1}},{key:"updateSelectable",value:function(){this.resetSelectable(),this.updateSelectedValues()}},{key:"retrieveIdsFromList",value:function(t){return t.map((function(t){return t.id}))}},{key:"updateSelectedValues",value:function(){var t=this;this.currentTransactions.forEach((function(e){e.isSelected&&(t.selectedTransactions.push(e),t.selectedCount++)})),this.selectedBalance=this.countTotalBalanceFromTransactionsList(this.selectedTransactions)}},{key:"countTotalBalanceFromPaymentsList",value:function(t){var e={amount:0,currency:null};return t.forEach((function(t){var n,i;e.currency||(e.currency=null===(n=t.details.paymentAmount)||void 0===n?void 0:n.currency),e.amount+=null===(i=t.details.paymentAmount)||void 0===i?void 0:i.amount})),e}},{key:"countTotalBalanceFromTransactionsList",value:function(t){var e={amount:0,currency:null};return t.forEach((function(t){t.debit&&(!e.currency&&t.debit.currency&&(e.currency=t.debit.currency),e.amount+=t.debit.amount)})),e}},{key:"isAllSignableInList",value:function(t){var e=!0;return t.forEach((function(t){if(!1===e)return e;t.isSignable||(e=!1)})),e}},{key:"isAllSendableForSignInList",value:function(t){var e=!0;return t.forEach((function(t){if(!1===e)return e;t.isSendableForSign||(e=!1)})),e}},{key:"hasSignableInList",value:function(t){return!!t.find((function(t){return t.isSignable}))}},{key:"hasSendableForSignInList",value:function(t){return!!t.find((function(t){return t.isSendableForSign}))}},{key:"mapQueryParams",value:function(t){var e=Object.assign({},this.filterService.getDefaults(this.filterMode));for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var i=t[n];if(!i)continue;e[n]="periodFrom"==n||"periodTo"==n?new Date(i):i}return e}},{key:"updateQueryParams",value:function(){var t=Object.assign({},this.filterScheme),e={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var i=t[n];i&&null!=i&&"null"!=i&&(e[n]="periodFrom"==n||"periodTo"==n?this.datePipe.transform(i,"yyyy-MM-dd"):i,"amountFrom"!=n&&"amountTo"!=n||(e[n]=this.maskedService.getNumberedAmount(i)))}this.updateCashedRouteQuery(e),this.router.navigate([],{queryParams:e,relativeTo:this.route,skipLocationChange:!1})}},{key:"updateCashedRouteQuery",value:function(t){sessionStorage.setItem(this.SESSION_ROUTE_KEY,JSON.stringify(t))}},{key:"getDocumentNumberById",value:function(t){var e=this.currentTransactions.find((function(e){return e.id==t}));return e&&e.documentNumber||null}},{key:"isAllSignable",get:function(){return this.currentTransactions.length>0&&(this.filterScheme.paymentStatus===x.d.FOR_SIGN||this.filterScheme.paymentStatus===x.d.DRAFT)&&this.hasSignableInList(this.currentTransactions)}},{key:"isAllSendableForSign",get:function(){return!this.isAllSignable&&this.currentTransactions.length>0&&this.filterScheme.paymentStatus===x.d.DRAFT&&this.hasSendableForSignInList(this.currentTransactions)}},{key:"isSignable",get:function(){return this.currentTransactions&&(this.filterScheme.paymentStatus===x.d.FOR_SIGN||this.filterScheme.paymentStatus===x.d.DRAFT)&&this.isAllSignableInList(this.selectedTransactions)}},{key:"isSendableForSign",get:function(){return!this.isSignable&&this.currentTransactions&&this.filterScheme.paymentStatus===x.d.DRAFT&&this.isAllSendableForSignInList(this.selectedTransactions)}},{key:"isSelectable",get:function(){return this.currentTransactions&&(this.filterScheme.paymentStatus===x.d.FOR_SIGN||this.filterScheme.paymentStatus===x.d.DRAFT)}},{key:"isSelectableForExport",get:function(){return this.filterScheme.paymentStatus===x.d.SUCCESS||this.filterScheme.paymentStatus===x.d.FAILED||this.filterScheme.paymentStatus===x.d.IN_PROGRESS||this.filterScheme.paymentStatus===x.d.DRAFT}},{key:"isAllSelectableForExport",get:function(){return this.filterScheme.paymentStatus===x.d.IN_PROGRESS}},{key:"totalBalance",get:function(){return this.selectedCount>0?this.selectedBalance:this.countTotalBalanceFromTransactionsList(this.currentTransactions)}},{key:"totalCount",get:function(){return this.selectedCount>0?this.selectedCount:this.currentTransactionsCount}},{key:"currentTransactionsCount",get:function(){var t;return(null===(t=this.statement)||void 0===t?void 0:t.totalTransactionsCount)||0}},{key:"currentTransactions",get:function(){var t,e,n;return(null===(n=null===(e=null===(t=this.statement)||void 0===t?void 0:t.transactionGroups)||void 0===e?void 0:e.map((function(t){return t.transactions})))||void 0===n?void 0:n.flat())||[]}},{key:"hasAnySelected",get:function(){return this.selectedCount>0}},{key:"currencies",get:function(){var t={};return(this.selectedCount>0?this.selectedTransactions:this.currentTransactions).forEach((function(e){var n,i,r,s,a,c,o,u;(null===(n=e.balance)||void 0===n?void 0:n.currency)&&(t[null===(i=e.balance)||void 0===i?void 0:i.currency]?(t[null===(r=e.balance)||void 0===r?void 0:r.currency].count++,t[null===(s=e.balance)||void 0===s?void 0:s.currency].balance.amount+=null===(a=e.balance)||void 0===a?void 0:a.amount):t[null===(c=e.balance)||void 0===c?void 0:c.currency]={count:1,balance:{amount:null===(o=e.balance)||void 0===o?void 0:o.amount,currency:null===(u=e.balance)||void 0===u?void 0:u.currency}})})),Object.values(t)}}]),t}()).\u0275fac=function(t){return new(t||fe)(p.Qb(Pt.a),p.Qb(V.c),p.Qb(Mt),p.Qb(m.a),p.Qb(m.c),p.Qb(c.f),p.Qb(N.q),p.Qb(Kt.a),p.Qb(Wt.a),p.Qb(Vt.b),p.Qb(Bt.g),p.Qb(Ut.c))},fe.\u0275cmp=p.Kb({type:fe,selectors:[["j-history-list"]],decls:10,vars:9,consts:[[1,"j-list"],[1,"j-list__header"],[1,"j-tabs"],[1,"j-tabs__list"],["class","j-tabs__item","routerLinkActive","active","translate","",3,"routerLink",4,"ngFor","ngForOf"],[1,"j-list__filter"],[3,"currency","mode"],["class","j-list__statement j-list__loading",4,"ngIf"],["infiniteScroll","",3,"scrollWindow","alwaysCallback","infiniteScrollDistance","infiniteScrollThrottle","scrolled"],["class","j-list__statement",3,"list-statement--scrollable",4,"ngIf"],["routerLinkActive","active","translate","",1,"j-tabs__item",3,"routerLink"],[1,"j-list__statement","j-list__loading"],[1,"j-list__statement"],["class","total",4,"ngIf"],[3,"statement","isTotalsShown","hasExtraPadding","isSelectable","signed","sentForSign","deleted","revoked","selected"],["class","text-center text-muted mt-5 mb-3 text-small","translate","",4,"ngIf"],[1,"total"],[1,"total__select","custom-control","custom-checkbox",3,"click"],["type","checkbox","id","checkboxAll",1,"custom-control-input",3,"ngModel","ngModelChange","click","change"],["for","checkboxAll","translate","",1,"custom-control-label"],[1,"total__content"],[3,"ngIf"],["leftCurrencies",""],[1,"total__actions"],[4,"ngIf"],[1,"total__text"],["translate",""],[3,"money"],["class","total__text",4,"ngFor","ngForOf"],[1,"total__text",3,"ngbTooltip"],[4,"ngFor","ngForOf"],["href","#","class","total__action","tooltipClass","tooltip-light",3,"ngbTooltip","inlineSVG","click",4,"ngIf"],["href","#","tooltipClass","tooltip-light",1,"total__action",3,"ngbTooltip","inlineSVG","click"],["href","#",1,"total__action","total__action--sign",3,"click"],["translate","",1,"mr-2"],[3,"inlineSVG"],["href","#","class","total__action total__action--sign","tooltipClass","tooltip-light",3,"ngbTooltip","inlineSVG","click",4,"ngIf"],["href","#","tooltipClass","tooltip-light",1,"total__action","total__action--sign",3,"ngbTooltip","inlineSVG","click"],["translate","",1,"text-center","text-muted","mt-5","mb-3","text-small"]],template:function(t,e){1&t&&(p.Wb(0,"section",0),p.Wb(1,"div",1),p.Wb(2,"div",2),p.Wb(3,"nav",3),p.Rc(4,zt,2,2,"a",4),p.Vb(),p.Vb(),p.Wb(5,"div",5),p.Rb(6,"j-filter",6),p.Vb(),p.Vb(),p.Rc(7,Xt,2,0,"div",7),p.Wb(8,"div",8),p.ic("scrolled",(function(t){return e.onScroll()})),p.Rc(9,he,4,8,"div",9),p.Vb(),p.Vb()),2&t&&(p.Ab(4),p.uc("ngForOf",e.historyTypes),p.Ab(2),p.uc("currency",e.filterCurrency)("mode",e.filterMode),p.Ab(1),p.uc("ngIf",e.isLoading),p.Ab(1),p.uc("scrollWindow",!0)("alwaysCallback",!0)("infiniteScrollDistance",2)("infiniteScrollThrottle",500),p.Ab(1),p.uc("ngIf",!e.isLoading))},directives:[c.t,Qt.a,c.u,u.a,m.f,m.e,P.a,Jt.a,$t.a,o.a,o.t,o.w,Q.a,N.E,H.a],pipes:[P.d],styles:['[_nghost-%COMP%]{margin:1rem 0;display:block}.total[_ngcontent-%COMP%]{min-height:60px;position:relative;font-size:.875rem;color:#666c72;padding-bottom:1rem}@media(min-width:960px){.total[_ngcontent-%COMP%]{-webkit-box-align:center;align-items:center;display:-webkit-box;display:flex}}.total[_ngcontent-%COMP%]:after{content:"";display:block;background:#eceef1;height:1px;position:absolute;bottom:0;left:-1.5rem;right:-1.5rem}.total[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#1a1c1f}.total__select[_ngcontent-%COMP%]{margin-bottom:1rem}@media(min-width:960px){.total__select[_ngcontent-%COMP%]{margin-right:1.5rem;margin-bottom:0}}.total__select[_ngcontent-%COMP%]   .custom-control-label[_ngcontent-%COMP%]{line-height:1.5rem}.total__actions[_ngcontent-%COMP%]{margin-left:auto;display:-webkit-box;display:flex}.total__text[_ngcontent-%COMP%]{margin-right:1rem}@media(min-width:960px){.total__text[_ngcontent-%COMP%]{text-align:right}}.total__action[_ngcontent-%COMP%]{display:block;margin-left:.5rem;color:#b7bec5}.total__action[_ngcontent-%COMP%]:hover{color:#ef5630}.total__action--sign[_ngcontent-%COMP%]{color:#1586bb}.total__content[_ngcontent-%COMP%]{margin-left:auto;display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center}@media(min-width:960px){.total__content[_ngcontent-%COMP%]{-webkit-box-pack:end;justify-content:flex-end}}']}),fe),Se=[{path:"",component:y,data:{title:"HISTORY.TITLE"},children:[{path:"all",component:ge,data:{category:w.h.ALL}},{path:"tenge",component:ge,data:{category:w.h.DOMESTIC}},{path:"foreign",component:ge,data:{category:w.h.FOREIGN}},{path:"conversion",component:ge,data:{category:w.h.CONVERSION}},{path:"**",redirectTo:"all"}]},{path:"**",redirectTo:""}],ye=((ve=function t(){_classCallCheck(this,t)}).\u0275mod=p.Ob({type:ve}),ve.\u0275inj=p.Nb({factory:function(t){return new(t||ve)},imports:[[m.g.forChild(Se)],m.g]}),ve),Te=n("xJkR");n.d(e,"HistoryModule",(function(){return Oe}));var Re,Oe=((Re=function t(){_classCallCheck(this,t)}).\u0275mod=p.Ob({type:Re}),Re.\u0275inj=p.Nb({factory:function(t){return new(t||Re)},imports:[[c.c,l.a,b.a,o.n,d.a,ye,u.b,P.c,Te.b]]}),Re)}}]);