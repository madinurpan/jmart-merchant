(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"E+oP":function(t,e,n){var o=n("A90E"),i=n("QqLw"),s=n("03A+"),c=n("Z0cm"),a=n("MMmD"),r=n("DSRE"),l=n("6sVZ"),b=n("c6wG"),u=Object.prototype.hasOwnProperty;t.exports=function(t){if(null==t)return!0;if(a(t)&&(c(t)||"string"==typeof t||"function"==typeof t.splice||r(t)||b(t)||s(t)))return!t.length;var e=i(t);if("[object Map]"==e||"[object Set]"==e)return!t.size;if(l(t))return!o(t).length;for(var n in t)if(u.call(t,n))return!1;return!0}},T9EB:function(t,e,n){"use strict";n.r(e);var o=n("ofXK"),i=n("3Pt+"),s=n("tmjD"),c=n("1kSV"),a=n("sYmb"),r=n("xJkR"),l=n("4Nuw"),b=n("Rreu"),u=n("PCNd"),m=n("ObZ0"),d=n("ebvF"),p=n("tyNb"),h=n("gzBp"),f=n("YMfE"),g=n("FSxY"),A=n("gm23"),T=n("eEJz"),y=n("lJxs"),R=n("fXoL"),v=n("bsP8"),C=n("0mgW"),E=n("S1F0"),S=n("oKsb"),V=n("fvpk"),N=n("mrSG"),I=n("2Vo4"),k=n("XNiG"),O=n("itXk"),j=n("LRne"),W=n("EY2u"),M=n("Cfvw"),P=n("/uUt"),x=n("Kj3r"),_=n("JX91"),D=n("zp1y"),w=n("3E0/"),Y=n("eIep"),U=n("JIr8"),L=n("pLZG"),F=n("vkgz"),$=n("IzEk"),B=n("TwVa"),K=n("+/Tu"),H=n("S09V"),Q=n("SMdK"),G=n("Xrnt"),q=n("4wRv"),X=n("B1Ao"),z=n("4oqK"),J=n("Kcpt"),Z=n("oa9T"),tt=n("2aJj"),et=n("zN9f"),nt=n("Eajh");function ot(t,e){if(1&t){const t=R.Xb();R.Wb(0,"div",19),R.ic("click",(function(n){R.Ic(t);const o=e.$implicit,i=R.mc().$implicit;return R.mc().closeModal(i,o)})),R.Wb(1,"div",20),R.Rb(2,"j-entity-logo",21),R.nc(3,"bankFromAccount"),R.Vb(),R.Wb(4,"div",22),R.Wb(5,"p",23),R.Tc(6),R.nc(7,"translate"),R.Vb(),R.Wb(8,"p",24),R.Tc(9),R.nc(10,"bankFromAccount"),R.nc(11,"bankFromAccount"),R.Vb(),R.Vb(),R.Vb()}if(2&t){const t=e.$implicit;R.Ab(2),R.uc("name",R.oc(3,5,t.iban)),R.Ab(4),R.Wc("",R.oc(7,7,"PAYMENTS.DICTIONARY.IBAN"),": ",t.iban,""),R.Ab(3),R.Wc(" ",R.oc(10,9,t.iban),": ",R.pc(11,11,t.iban,"name")," ")}}function it(t,e){if(1&t&&(R.Wb(0,"li"),R.Wb(1,"div",15),R.Wb(2,"p",16),R.Tc(3),R.Vb(),R.Wb(4,"p",17),R.Tc(5),R.nc(6,"translate"),R.Vb(),R.Rc(7,ot,12,14,"div",18),R.Vb(),R.Vb()),2&t){const t=e.$implicit;R.Ab(3),R.Uc(t.name),R.Ab(2),R.Wc("",R.oc(6,4,"PAYMENTS.DICTIONARY.IIN"),": ",t.iinOrBin,""),R.Ab(2),R.uc("ngForOf",t.accounts)}}function st(t,e){1&t&&(R.Wb(0,"div"),R.Wb(1,"p",25),R.Tc(2),R.nc(3,"translate"),R.Vb(),R.Vb()),2&t&&(R.Ab(2),R.Uc(R.oc(3,1,"PAYMENTS.DICTIONARY.RECIPIENT_NOT_FOUND")))}let ct=(()=>{class t{constructor(t,e,n){this.paymentsS=t,this.recipients=e,this.modal=n,this.collectionSize$=new I.a(0),this.currentPage$=new I.a(0),this.pageSize=10}ngOnInit(){this.recipients.getRecipients(),this.search=new i.h(""),this.list$=Object(O.a)([this.recipients.store.items$.pipe(Object(y.a)(t=>t.filter(t=>!!t.accounts))),this.search.valueChanges.pipe(Object(x.a)(100),Object(P.a)(),Object(_.a)(this.search.value)),this.currentPage$]).pipe(Object(y.a)(([t,e,n])=>{const o=this.recipients.filterRecipients(t,e);return this.collectionSize$.next(o.length>this.pageSize?o.length-this.pageSize:o.length),o.slice(n>1?n*this.pageSize:0,(n+1)*this.pageSize)}))}get page(){return this.currentPage$.getValue()}set page(t){this.currentPage$.next(t)}onClose(){this.modal.dismiss()}closeModal(t,e){this.modal.close({recipient:t,account:e})}}return t.\u0275fac=function(e){return new(e||t)(R.Qb(C.c),R.Qb(X.a),R.Qb(c.a))},t.\u0275cmp=R.Kb({type:t,selectors:[["j-recipients-dictionary"]],decls:23,vars:23,consts:[[1,"dictionary-modal"],["type","button",1,"close",3,"click"],["src","/assets/icons/close.svg",3,"alt"],[1,"modal-body"],[1,"form-group"],["clearable","true"],["jPrefix","","viewBox","0 0 24 24","name","search",1,"text-gray","d-block","mt-n1"],["type","text","jFormInput","",1,"form-control",3,"placeholder","formControl"],[1,"dictionary-modal--list"],[1,"scrolled"],[1,"scrolled--content"],[1,"list-unstyled"],[4,"ngFor","ngForOf"],[4,"ngIf"],[3,"page","maxSize","rotate","pageSize","collectionSize","pageChange"],[1,"recipient-dict-item"],[1,"recipient-title"],[1,"small","text-gray","mb-2"],["class","account-pill account-pill_gray account-pill_fill",3,"click",4,"ngFor","ngForOf"],[1,"account-pill","account-pill_gray","account-pill_fill",3,"click"],[1,"account-pill--logo"],[3,"name"],[1,"account-pill--content","small"],[1,"wrap-text"],[1,"wrap-text","text-gray"],[1,"text-center","text-light","light"]],template:function(t,e){1&t&&(R.Wb(0,"div",0),R.Wb(1,"button",1),R.ic("click",(function(t){return e.modal.dismiss()})),R.Rb(2,"img",2),R.nc(3,"translate"),R.Vb(),R.Wb(4,"div",3),R.Wb(5,"h5"),R.Tc(6),R.nc(7,"translate"),R.Vb(),R.Wb(8,"div",4),R.Wb(9,"j-form-field",5),R.Rb(10,"j-icon",6),R.Rb(11,"input",7),R.nc(12,"translate"),R.Vb(),R.Vb(),R.Wb(13,"div",8),R.Wb(14,"div",9),R.Wb(15,"div",10),R.Wb(16,"ul",11),R.Rc(17,it,8,6,"li",12),R.nc(18,"async"),R.Vb(),R.Rc(19,st,4,3,"div",13),R.nc(20,"async"),R.Wb(21,"ngb-pagination",14),R.ic("pageChange",(function(t){return e.page=t})),R.nc(22,"async"),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Vb()),2&t&&(R.Ab(2),R.vc("alt",R.oc(3,11,"SHARED.CLOSE")),R.Ab(4),R.Uc(R.oc(7,13,"PAYMENTS.DICTIONARY.TITLE")),R.Ab(5),R.uc("placeholder",R.oc(12,15,"PAYMENTS.DICTIONARY.SEARCH"))("formControl",e.search),R.Ab(6),R.uc("ngForOf",R.oc(18,17,e.list$)),R.Ab(2),R.uc("ngIf",0===R.oc(20,19,e.list$).length),R.Ab(2),R.uc("page",e.page)("maxSize",5)("rotate",!0)("pageSize",e.pageSize)("collectionSize",R.oc(22,21,e.collectionSize$)))},directives:[z.a,J.a,Z.a,tt.a,i.c,i.t,i.i,o.t,o.u,c.u,et.a],pipes:[a.d,o.b,nt.a],styles:[".recipient-dict-item{padding:1rem 0}.recipient-dict-item .recipient-title{font-weight:500;font-size:16px}.recipient-dict-item .account-pill{margin-top:.5rem}.recipient-dict-item p{margin-bottom:.5em;line-height:1.4}"],encapsulation:2}),t})();var at=n("bHA9");function rt(t,e){if(1&t){const t=R.Xb();R.Wb(0,"li",14),R.ic("click",(function(n){R.Ic(t);const o=e.$implicit;return R.mc().closeModal(o)})),R.Wb(1,"div",15),R.Tc(2),R.Vb(),R.Vb()}if(2&t){const t=e.$implicit;R.Ab(2),R.Uc(t.label)}}function lt(t,e){1&t&&(R.Wb(0,"div"),R.Wb(1,"p",16),R.Tc(2),R.nc(3,"translate"),R.Vb(),R.Vb()),2&t&&(R.Ab(2),R.Uc(R.oc(3,1,"PAYMENTS.DICTIONARY.KNP_NOT_FOUND")))}let bt=(()=>{class t{constructor(t,e,n){this.paymentsS=t,this.dictionaries=e,this.modal=n}ngOnInit(){this.search=new i.h(""),this.list$=Object(O.a)([this.dictionaries.KNPDictionary.items$,this.search.valueChanges.pipe(Object(x.a)(100),Object(P.a)(),Object(_.a)(this.search.value))]).pipe(Object(y.a)(([t,e])=>this.paymentType?this.dictionaries.selectByPaymentType(t,{type:this.paymentType}).filter(t=>this.paymentsS.genericSearchTerm(e,t)).sort((t,e)=>t.code>e.code?1:-1):t.filter(t=>this.paymentsS.genericSearchTerm(e,t)).sort((t,e)=>t.code>e.code?1:-1)))}closeModal(t){this.modal.close(t)}}return t.\u0275fac=function(e){return new(e||t)(R.Qb(C.c),R.Qb(at.a),R.Qb(c.a))},t.\u0275cmp=R.Kb({type:t,selectors:[["j-knp-dictionary"]],inputs:{paymentType:"paymentType"},decls:20,vars:13,consts:[[1,"dictionary-modal"],["type","button",1,"close",3,"click"],["src","/assets/icons/close.svg"],[1,"modal-body"],[1,"form-group"],["clearable","true"],["jPrefix","","name","search",1,"text-gray","d-block","mt-n1"],["type","text","jFormInput","",1,"form-control",3,"placeholder","formControl"],[1,"dictionary-modal--list"],[1,"scrolled"],[1,"scrolled--content"],[1,"list-unstyled"],["class","j-option-label ",3,"click",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"j-option-label",3,"click"],[1,""],[1,"text-center","text-light","light"]],template:function(t,e){1&t&&(R.Wb(0,"div",0),R.Wb(1,"button",1),R.ic("click",(function(t){return e.modal.dismiss()})),R.Rb(2,"img",2),R.Vb(),R.Wb(3,"div",3),R.Wb(4,"h5"),R.Tc(5),R.nc(6,"translate"),R.Vb(),R.Wb(7,"div",4),R.Wb(8,"j-form-field",5),R.Rb(9,"j-icon",6),R.Rb(10,"input",7),R.nc(11,"translate"),R.Vb(),R.Vb(),R.Wb(12,"div",8),R.Wb(13,"div",9),R.Wb(14,"div",10),R.Wb(15,"ul",11),R.Rc(16,rt,3,1,"li",12),R.nc(17,"async"),R.Vb(),R.Rc(18,lt,4,3,"div",13),R.nc(19,"async"),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Vb()),2&t&&(R.Ab(5),R.Uc(R.oc(6,5,"PAYMENTS.DICTIONARY.TITLE")),R.Ab(5),R.uc("placeholder",R.oc(11,7,"PAYMENTS.DICTIONARY.SEARCH"))("formControl",e.search),R.Ab(6),R.uc("ngForOf",R.oc(17,9,e.list$)),R.Ab(2),R.uc("ngIf",0===R.oc(19,11,e.list$).length))},directives:[z.a,J.a,Z.a,tt.a,i.c,i.t,i.i,o.t,o.u],pipes:[a.d,o.b],styles:[""],encapsulation:2}),t})();function ut(t,e){if(1&t){const t=R.Xb();R.Wb(0,"li",14),R.ic("click",(function(n){R.Ic(t);const o=e.$implicit;return R.mc().closeModal(o)})),R.Wb(1,"p",15),R.Tc(2),R.Vb(),R.Wb(3,"p",16),R.Tc(4),R.nc(5,"translate"),R.Vb(),R.Vb()}if(2&t){const t=e.$implicit;R.Ab(2),R.Uc(t.label),R.Ab(2),R.Wc("",R.oc(5,3,"PAYMENTS.DICTIONARY.BIN"),": ",t.bin,"")}}function mt(t,e){1&t&&(R.Wb(0,"div"),R.Wb(1,"p",17),R.Tc(2),R.nc(3,"translate"),R.Vb(),R.Vb()),2&t&&(R.Ab(2),R.Uc(R.oc(3,1,"PAYMENTS.DICTIONARY.UGD_NOT_FOUND")))}let dt=(()=>{class t{constructor(t,e,n){this.paymentsS=t,this.dictionaries=e,this.modal=n}ngOnInit(){this.search=new i.h(""),this.list$=Object(O.a)(this.dictionaries.UGDictionary.items$,this.search.valueChanges.pipe(Object(x.a)(100),Object(P.a)(),Object(_.a)(this.search.value))).pipe(Object(y.a)(([t,e])=>t.filter(t=>this.paymentsS.ugdSearchFn(e,t))))}closeModal(t){this.modal.close(t)}}return t.\u0275fac=function(e){return new(e||t)(R.Qb(C.c),R.Qb(at.a),R.Qb(c.a))},t.\u0275cmp=R.Kb({type:t,selectors:[["j-ugd-dictionary"]],decls:21,vars:16,consts:[[1,"dictionary-modal"],["type","button",1,"close",3,"click"],["src","/assets/icons/close.svg",3,"alt"],[1,"modal-body"],[1,"form-group"],["clearable","true"],["jPrefix","","name","search",1,"text-gray","d-block","mt-n1"],["type","text","jFormInput","",1,"form-control",3,"placeholder","formControl"],[1,"dictionary-modal--list"],[1,"scrolled"],[1,"scrolled--content"],[1,"list-unstyled"],["class","j-option-label",3,"click",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"j-option-label",3,"click"],[1,"m-0","text-wrap"],[1,"p3","text-gray","m-0"],[1,"text-center","text-light","light"]],template:function(t,e){1&t&&(R.Wb(0,"div",0),R.Wb(1,"button",1),R.ic("click",(function(t){return e.modal.dismiss()})),R.Rb(2,"img",2),R.nc(3,"translate"),R.Vb(),R.Wb(4,"div",3),R.Wb(5,"h5"),R.Tc(6),R.nc(7,"translate"),R.Vb(),R.Wb(8,"div",4),R.Wb(9,"j-form-field",5),R.Rb(10,"j-icon",6),R.Rb(11,"input",7),R.nc(12,"translate"),R.Vb(),R.Vb(),R.Wb(13,"div",8),R.Wb(14,"div",9),R.Wb(15,"div",10),R.Wb(16,"ul",11),R.Rc(17,ut,6,5,"li",12),R.nc(18,"async"),R.Vb(),R.Rc(19,mt,4,3,"div",13),R.nc(20,"async"),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Vb()),2&t&&(R.Ab(2),R.vc("alt",R.oc(3,6,"SHARED.CLOSE")),R.Ab(4),R.Uc(R.oc(7,8,"PAYMENTS.DICTIONARY.UGD_TITLE")),R.Ab(5),R.uc("placeholder",R.oc(12,10,"PAYMENTS.DICTIONARY.SEARCH"))("formControl",e.search),R.Ab(6),R.uc("ngForOf",R.oc(18,12,e.list$)),R.Ab(2),R.uc("ngIf",0===R.oc(20,14,e.list$).length))},directives:[z.a,J.a,Z.a,tt.a,i.c,i.t,i.i,o.t,o.u],pipes:[a.d,o.b],styles:[""],encapsulation:2}),t})();var pt=n("HghS");function ht(t,e){if(1&t){const t=R.Xb();R.Wb(0,"li",14),R.Wb(1,"div",15),R.ic("click",(function(n){R.Ic(t);const o=e.$implicit;return R.mc().closeModal(o)})),R.Wb(2,"div",16),R.Rb(3,"j-entity-logo",17),R.Vb(),R.Wb(4,"div",18),R.Wb(5,"p",19),R.Tc(6),R.nc(7,"translate"),R.Vb(),R.Wb(8,"p",20),R.Tc(9),R.Vb(),R.Vb(),R.Vb(),R.Vb()}if(2&t){const t=e.$implicit;R.Ab(3),R.uc("name",t.bic),R.Ab(3),R.Uc(t.salaryTransitIban?R.oc(7,4,"PAYMENTS.BANKS_RECEIVERS.IBAN")+t.salaryTransitIban:t.name),R.Ab(3),R.Wc("",t.bic,": ",t.name,"")}}function ft(t,e){1&t&&(R.Wb(0,"div"),R.Wb(1,"p",21),R.Tc(2),R.nc(3,"translate"),R.Vb(),R.Vb()),2&t&&(R.Ab(2),R.Uc(R.oc(3,1,"PAYMENTS.BANKS_RECEIVERS.NOT_FOUND")))}let gt=(()=>{class t{constructor(t,e,n){this.modal=t,this.paymentsS=e,this.dict=n}ngOnInit(){this.search=new i.h(""),this.list$=Object(O.a)(this.dict.bankDictionary.items$,this.search.valueChanges.pipe(Object(x.a)(100),Object(P.a)(),Object(_.a)(this.search.value))).pipe(Object(y.a)(([t,e])=>t.filter(t=>this.paymentsS.bankReceiverSearchFn(e,t))))}closeModal(t){this.modal.close(t)}}return t.\u0275fac=function(e){return new(e||t)(R.Qb(c.a),R.Qb(C.c),R.Qb(at.a))},t.\u0275cmp=R.Kb({type:t,selectors:[["j-banks-receivers"]],decls:21,vars:16,consts:[[1,"dictionary-modal"],["type","button",1,"close",3,"click"],["src","/assets/icons/close.svg",3,"alt"],[1,"modal-body"],[1,"form-group"],["clearable","true"],["jPrefix","","name","search",1,"text-gray","d-block","mt-n1"],["type","text","jFormInput","",1,"form-control",3,"placeholder","formControl"],[1,"dictionary-modal--list"],[1,"scrolled"],[1,"scrolled--content"],[1,"list-unstyled"],["class","mb-2",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"mb-2"],[1,"account-pill","account-pill_gray","account-pill_fill",3,"click"],[1,"account-pill--logo"],[3,"name"],[1,"account-pill--content","small"],[1,"wrap-text"],[1,"wrap-text","text-gray"],[1,"text-center","text-light","light"]],template:function(t,e){1&t&&(R.Wb(0,"div",0),R.Wb(1,"button",1),R.ic("click",(function(t){return e.modal.dismiss()})),R.Rb(2,"img",2),R.nc(3,"translate"),R.Vb(),R.Wb(4,"div",3),R.Wb(5,"h5"),R.Tc(6),R.nc(7,"translate"),R.Vb(),R.Wb(8,"div",4),R.Wb(9,"j-form-field",5),R.Rb(10,"j-icon",6),R.Rb(11,"input",7),R.nc(12,"translate"),R.Vb(),R.Vb(),R.Wb(13,"div",8),R.Wb(14,"div",9),R.Wb(15,"div",10),R.Wb(16,"ul",11),R.Rc(17,ht,10,6,"li",12),R.nc(18,"async"),R.Vb(),R.Rc(19,ft,4,3,"div",13),R.nc(20,"async"),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Vb()),2&t&&(R.Ab(2),R.vc("alt",R.oc(3,6,"SHARED.CLOSE")),R.Ab(4),R.Uc(R.oc(7,8,"PAYMENTS.BANKS_RECEIVERS.SEARCH")),R.Ab(5),R.uc("placeholder",R.oc(12,10,"PAYMENTS.BANKS_RECEIVERS.SEARCH"))("formControl",e.search),R.Ab(6),R.uc("ngForOf",R.oc(18,12,e.list$)),R.Ab(2),R.uc("ngIf",!R.oc(20,14,e.list$)))},directives:[z.a,J.a,Z.a,tt.a,i.c,i.t,i.i,o.t,o.u,et.a],pipes:[a.d,o.b],styles:[""]}),t})();function At(t,e){if(1&t){const t=R.Xb();R.Wb(0,"li",14),R.ic("click",(function(n){R.Ic(t);const o=e.$implicit;return R.mc().closeModal(o)})),R.Wb(1,"div",15),R.Tc(2),R.Vb(),R.Vb()}if(2&t){const t=e.$implicit;R.Ab(2),R.Uc(t.label||t.description)}}function Tt(t,e){1&t&&(R.Wb(0,"div"),R.Wb(1,"p",16),R.Tc(2),R.nc(3,"translate"),R.Vb(),R.Vb()),2&t&&(R.Ab(2),R.Uc(R.oc(3,1,"PAYMENTS.DICTIONARY.NOT_FOUND")))}let yt=(()=>{class t{constructor(t,e){this.paymentsS=t,this.modal=e,this.searchPlaceholder="PAYMENTS.DICTIONARY.SEARCH",this.title="PAYMENTS.DICTIONARY.TITLE"}ngOnInit(){this.search=new i.h(""),this.list$=Object(O.a)(this.store.items$,this.search.valueChanges.pipe(Object(x.a)(100),Object(P.a)(),Object(_.a)(this.search.value))).pipe(Object(y.a)(([t,e])=>t.filter(t=>this.searchFn?this.searchFn(e,t):this.paymentsS.genericSearchTerm(e,t))))}closeModal(t){this.modal.close(t)}}return t.\u0275fac=function(e){return new(e||t)(R.Qb(C.c),R.Qb(c.a))},t.\u0275cmp=R.Kb({type:t,selectors:[["j-generic-dictionary"]],inputs:{store:"store",searchFn:"searchFn",searchPlaceholder:"searchPlaceholder",title:"title"},decls:21,vars:16,consts:[[1,"dictionary-modal"],["type","button",1,"close",3,"click"],["src","/assets/icons/close.svg",3,"alt"],[1,"modal-body"],[1,"form-group"],["clearable","true"],["jPrefix","","name","search",1,"text-gray","d-block","mt-n1"],["type","text","jFormInput","",1,"form-control",3,"placeholder","formControl"],[1,"dictionary-modal--list"],[1,"scrolled"],[1,"scrolled--content"],[1,"list-unstyled"],["class","j-option-label ",3,"click",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"j-option-label",3,"click"],[1,""],[1,"text-center","text-light","light"]],template:function(t,e){1&t&&(R.Wb(0,"div",0),R.Wb(1,"button",1),R.ic("click",(function(t){return e.modal.dismiss()})),R.Rb(2,"img",2),R.nc(3,"translate"),R.Vb(),R.Wb(4,"div",3),R.Wb(5,"h5"),R.Tc(6),R.nc(7,"translate"),R.Vb(),R.Wb(8,"div",4),R.Wb(9,"j-form-field",5),R.Rb(10,"j-icon",6),R.Rb(11,"input",7),R.nc(12,"translate"),R.Vb(),R.Vb(),R.Wb(13,"div",8),R.Wb(14,"div",9),R.Wb(15,"div",10),R.Wb(16,"ul",11),R.Rc(17,At,3,1,"li",12),R.nc(18,"async"),R.Vb(),R.Rc(19,Tt,4,3,"div",13),R.nc(20,"async"),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Vb()),2&t&&(R.Ab(2),R.vc("alt",R.oc(3,6,"SHARED.CLOSE")),R.Ab(4),R.Uc(R.oc(7,8,e.title)),R.Ab(5),R.uc("placeholder",R.oc(12,10,e.searchPlaceholder))("formControl",e.search),R.Ab(6),R.uc("ngForOf",R.oc(18,12,e.list$)),R.Ab(2),R.uc("ngIf",0===R.oc(20,14,e.list$).length))},directives:[z.a,J.a,Z.a,tt.a,i.c,i.t,i.i,o.t,o.u],pipes:[a.d,o.b],styles:[""],encapsulation:2}),t})();var Rt=n("Stn5");let vt=(()=>{class t{constructor(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=R.Kb({type:t,selectors:[["j-bic-info"]],decls:13,vars:12,consts:[[1,"p4"],[3,"innerHTML"]],template:function(t,e){1&t&&(R.Wb(0,"article",0),R.Wb(1,"p"),R.Wb(2,"strong"),R.Tc(3),R.nc(4,"translate"),R.Vb(),R.Vb(),R.Rb(5,"p",1),R.nc(6,"translate"),R.Wb(7,"p"),R.Wb(8,"strong"),R.Tc(9),R.nc(10,"translate"),R.Vb(),R.Vb(),R.Rb(11,"p",1),R.nc(12,"translate"),R.Vb()),2&t&&(R.Ab(3),R.Vc(" ",R.oc(4,4,"PAYMENTS.BIC_INFO.SWIFT.TITLE")," "),R.Ab(2),R.uc("innerHTML",R.oc(6,6,"PAYMENTS.BIC_INFO.SWIFT.DESCRIPTION"),R.Jc),R.Ab(4),R.Vc(" ",R.oc(10,8,"PAYMENTS.BIC_INFO.BIC.TITLE")," "),R.Ab(2),R.uc("innerHTML",R.oc(12,10,"PAYMENTS.BIC_INFO.BIC.DESCRIPTION"),R.Jc))},pipes:[a.d],styles:[""]}),t})(),Ct=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=R.Kb({type:t,selectors:[["j-iban-info"]],decls:4,vars:0,consts:[["translate","",1,"p2","font-weight-medium"],["translate","",1,"p4"]],template:function(t,e){1&t&&(R.Wb(0,"p",0),R.Tc(1,"CURRENCY_PAYMENT.RECIPIENT.IBAN_INFO.TITLE"),R.Vb(),R.Wb(2,"p",1),R.Tc(3,"CURRENCY_PAYMENT.RECIPIENT.IBAN_INFO.DESCRIPTION"),R.Vb())},directives:[a.a],styles:[""]}),t})();var Et=n("quSY"),St=n("O/Ur"),Vt=n("QfCG"),Nt=n("BV3K"),It=n("SfXN"),kt=n("e8Ap"),Ot=n("jRXw"),jt=n("4cI0");const Wt=["input"],Mt=function(){return{width:"100%",height:"56px","background-color":"#ECEEF1"}};function Pt(t,e){1&t&&(R.Wb(0,"div",7),R.Rb(1,"ngx-skeleton-loader",8),R.Vb()),2&t&&(R.Ab(1),R.uc("theme",R.yc(1,Mt)))}function xt(t,e){if(1&t){const t=R.Xb();R.Wb(0,"div",10),R.ic("click",(function(n){R.Ic(t);const o=e.$implicit;return R.mc(2).onBankSelect(o)})),R.Tc(1),R.Vb()}if(2&t){const t=e.$implicit,n=R.mc(2);R.Ab(1),R.Vc(" ",n.mapBankLabel(t)," ")}}function _t(t,e){if(1&t&&(R.Wb(0,"div",7),R.Rc(1,xt,2,1,"div",9),R.Vb()),2&t){const t=R.mc();R.Ab(1),R.uc("ngForOf",t.banks)}}function Dt(t,e){1&t&&(R.Ub(0),R.Rb(1,"j-empty-placeholder",13),R.Tb())}function wt(t,e){if(1&t&&(R.Tc(0),R.nc(1,"translate")),2&t){const t=R.mc(2);R.Vc(" ",R.oc(1,1,t.placeholderText)," ")}}function Yt(t,e){if(1&t&&(R.Wb(0,"div",7),R.Rc(1,Dt,2,0,"ng-container",11),R.Rc(2,wt,2,3,"ng-template",null,12,R.Sc),R.Vb()),2&t){const t=R.Fc(3),e=R.mc();R.Ab(1),R.uc("ngIf",(null==e.labelControl?null:null==e.labelControl.value?null:e.labelControl.value.length)>0)("ngIfElse",t)}}function Ut(t,e){1&t&&R.Rb(0,"j-bic-info")}let Lt=(()=>{class t{constructor(t){this.currencyPaymentService=t,this.labelText="CURRENCY_PAYMENT.RECIPIENT.BIC",this.placeholderText="CURRENCY_PAYMENT.RECIPIENT.NO_BIC_ENTERED",this.isLoading=!1,this.isBicFocused=!1,this.subscription=new Et.a}selectByBic(t){return Object(N.a)(this,void 0,void 0,(function*(){yield this.retrieveBanks(t);const e=this.banks.find(e=>e.bic==t);if(e)return this.onBankSelect(e)}))}ngOnInit(){this.listenBankSearch()}ngOnDestroy(){this.subscription.unsubscribe()}focus(){setTimeout(()=>{this.input.nativeElement.focus()},100)}onBicFocus(t){this.isBicFocused=!0,this.labelControl.setValue(""),this.banks=[]}onBicBlur(t){setTimeout(()=>{this.isBicFocused=!1},300)}mapBankLabel(t){return`${t.bic} - ${t.name}`}onBankSelect(t){this.labelControl.setValue(this.mapBankLabel(t),{emitEvent:!1}),this.bankControl.setValue(t)}listenBankSearch(){var t;this.subscription.add(null===(t=this.labelControl)||void 0===t?void 0:t.valueChanges.pipe(Object(x.a)(300)).pipe(Object(P.a)()).subscribe(t=>{var e;(null===(e=t)||void 0===e?void 0:e.length)>=1&&this.retrieveBanks(t,this.countryCode)}))}retrieveBanks(t,e=null){var n;return Object(N.a)(this,void 0,void 0,(function*(){this.isLoading=!0;const o=(null===(n=e)||void 0===n?void 0:n.substring(0,2))||null;try{this.banks=yield this.currencyPaymentService.getBanks(t,o)}catch(i){}finally{this.isLoading=!1}}))}}return t.\u0275fac=function(e){return new(e||t)(R.Qb(St.b))},t.\u0275cmp=R.Kb({type:t,selectors:[["j-foreign-bank-select"]],viewQuery:function(t,e){var n;1&t&&R.Yc(Wt,!0),2&t&&R.Ec(n=R.jc())&&(e.input=n.first)},inputs:{labelControl:"labelControl",bankControl:"bankControl",countryCode:"countryCode",errorMessages:"errorMessages",labelText:"labelText",placeholderText:"placeholderText"},decls:14,vars:14,consts:[["type","text","jFormInput","","jFocusOnReturn","",1,"form-control","bic-input",3,"formControl","focus","blur"],["input",""],["href","javascript:void(0)","jSuffix","","tooltipClass","tooltip-light tooltip-medium","triggers","mouseenter:mouseleave",1,"mr-1","link-gray",3,"ngbTooltip","inlineSVG"],[3,"control","errorMessages"],[1,"bic-dropdown",3,"hidden"],["class","bic-dropdown-body",4,"ngIf"],["bicInfo",""],[1,"bic-dropdown-body"],["count","4",3,"theme"],["class","j-option-label text-wrap",3,"click",4,"ngFor","ngForOf"],[1,"j-option-label","text-wrap",3,"click"],[4,"ngIf","ngIfElse"],["placeholder",""],["label","SHARED.SEARCH_NOT_FOUND"]],template:function(t,e){if(1&t&&(R.Wb(0,"j-form-field"),R.Wb(1,"j-label"),R.Tc(2),R.nc(3,"translate"),R.Vb(),R.Wb(4,"input",0,1),R.ic("focus",(function(t){return e.onBicFocus(t)}))("blur",(function(t){return e.onBicBlur(t)})),R.Vb(),R.Rb(6,"a",2),R.Rb(7,"j-error",3),R.Vb(),R.Wb(8,"div",4),R.Rc(9,Pt,2,2,"div",5),R.Rc(10,_t,2,1,"div",5),R.Rc(11,Yt,4,2,"div",5),R.Vb(),R.Rc(12,Ut,1,0,"ng-template",null,6,R.Sc)),2&t){const t=R.Fc(13);R.Ab(2),R.Uc(R.oc(3,12,e.labelText)),R.Ab(2),R.Hb("has-dropdown",null==e.banks?null:e.banks.length),R.uc("formControl",e.labelControl),R.Ab(2),R.uc("ngbTooltip",t)("inlineSVG","/assets/icons/payments/question.svg"),R.Ab(1),R.uc("control",e.labelControl)("errorMessages",e.errorMessages),R.Ab(1),R.uc("hidden",!e.isBicFocused),R.Ab(1),R.uc("ngIf",e.isLoading),R.Ab(1),R.uc("ngIf",!e.isLoading&&(null==e.banks?null:e.banks.length)),R.Ab(1),R.uc("ngIf",!(e.isLoading||null!=e.banks&&e.banks.length))}},directives:[z.a,Vt.a,tt.a,i.c,Nt.a,i.t,i.i,It.a,c.E,kt.a,Ot.a,o.u,r.a,o.t,jt.a,vt],pipes:[a.d],styles:["[_nghost-%COMP%]{display:block;position:relative}.bic-dropdown[_ngcontent-%COMP%]{border-radius:0 8px 8px 0;left:0;right:0;padding:1.5rem;background:#fff;position:absolute;max-height:300px;height:30vh;z-index:1000;box-shadow:0 14px 16px rgba(0,0,0,.05)}.bic-dropdown[_ngcontent-%COMP%]   .j-option-label[_ngcontent-%COMP%]{cursor:pointer}.bic-input.has-dropdown[_ngcontent-%COMP%]{border-radius:8px 0 0 8px}.bic-dropdown-body[_ngcontent-%COMP%]{top:0;right:0;left:0;bottom:0;height:100%;overflow-y:auto;padding-right:.5rem}.bic-dropdown-body[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.bic-dropdown-body[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#fff}.bic-dropdown-body[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#b7bec5;border-radius:10px}"]}),t})();var Ft=n("Kx/q"),$t=n("fK/r"),Bt=n("PGAL"),Kt=n("Hjq/");function Ht(t,e){if(1&t&&(R.Wb(0,"div",32),R.Tc(1),R.Vb()),2&t){const t=R.mc(2);R.Ab(1),R.Uc(null==t.primaryRecipient?null:t.primaryRecipient.name)}}function Qt(t,e){if(1&t&&(R.Wb(0,"div",26),R.Wb(1,"div",27),R.Wb(2,"span",28),R.Tc(3,"CURRENCY_PAYMENT.CONTRACTS.DETAILS.CONTRACT_TYPE"),R.Vb(),R.Tc(4,": "),R.Vb(),R.Wb(5,"div",29),R.Tc(6),R.Vb(),R.Vb()),2&t){const t=R.mc(2);R.Ab(6),R.Vc(" ",t.contract.type.description," ")}}function Gt(t,e){if(1&t&&(R.Wb(0,"div",26),R.Wb(1,"div",27),R.Wb(2,"span",28),R.Tc(3,"CONTRACTS.DETAILS.UNK"),R.Vb(),R.Tc(4,": "),R.Vb(),R.Wb(5,"div",29),R.Tc(6),R.Vb(),R.Vb()),2&t){const t=R.mc(2);R.Ab(6),R.Vc(" ",t.contract.registrationNumberContract," ")}}function qt(t,e){if(1&t&&(R.Wb(0,"div",26),R.Wb(1,"div",27),R.Wb(2,"span",28),R.Tc(3,"CONTRACTS.DETAILS.UNK_DATE"),R.Vb(),R.Tc(4,": "),R.Vb(),R.Wb(5,"div",29),R.Tc(6),R.nc(7,"date"),R.Vb(),R.Vb()),2&t){const t=R.mc(2);R.Ab(6),R.Vc(" ",R.pc(7,1,t.contract.documentDate,"d MMMM yyyy")," ")}}function Xt(t,e){1&t&&(R.Wb(0,"span"),R.Tc(1," 1"),R.Vb())}function zt(t,e){if(1&t&&(R.Wb(0,"section",20),R.Wb(1,"j-collapsible"),R.Wb(2,"j-collapsible-trigger"),R.Wb(3,"div",21),R.Wb(4,"h5",11),R.Wb(5,"span",28),R.Tc(6,"CURRENCY_PAYMENT.CONTRACTS.RECIPIENT.TITLE"),R.Vb(),R.Rc(7,Xt,2,0,"span",33),R.Vb(),R.Rb(8,"span",23),R.Vb(),R.Vb(),R.Wb(9,"j-collapsible-body"),R.Wb(10,"div",24),R.Wb(11,"div",26),R.Wb(12,"div",27),R.Wb(13,"span",28),R.Tc(14,"CURRENCY_PAYMENT.CONTRACTS.RECIPIENT.NAME"),R.Vb(),R.Tc(15,": "),R.Vb(),R.Wb(16,"div",29),R.Tc(17),R.Vb(),R.Vb(),R.Wb(18,"div",26),R.Wb(19,"div",27),R.Wb(20,"span",28),R.Tc(21,"CURRENCY_PAYMENT.CONTRACTS.RECIPIENT.COUNTRY"),R.Vb(),R.Tc(22,": "),R.Vb(),R.Wb(23,"div",29),R.Tc(24),R.Vb(),R.Vb(),R.Wb(25,"div",26),R.Wb(26,"div",27),R.Wb(27,"span",28),R.Tc(28,"CURRENCY_PAYMENT.CONTRACTS.RECIPIENT.CITY"),R.Vb(),R.Tc(29,": "),R.Vb(),R.Wb(30,"div",29),R.Tc(31),R.Vb(),R.Vb(),R.Wb(32,"div",26),R.Wb(33,"div",27),R.Wb(34,"span",28),R.Tc(35,"CURRENCY_PAYMENT.CONTRACTS.RECIPIENT.BANK"),R.Vb(),R.Tc(36,": "),R.Vb(),R.Wb(37,"div",29),R.Tc(38),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Vb()),2&t){const t=R.mc(2);R.Ab(7),R.uc("ngIf",(null==t.extraRecipients?null:t.extraRecipients.length)>0),R.Ab(10),R.Vc(" ",t.primaryRecipient.name," "),R.Ab(7),R.Vc(" ",t.mapCountry(t.primaryRecipient)," "),R.Ab(7),R.Vc(" ",t.primaryRecipient.cityName||t.primaryRecipient.defaultCityName||"-"," "),R.Ab(7),R.Vc(" ",t.mapBank(t.primaryRecipient)," ")}}function Jt(t,e){if(1&t&&(R.Wb(0,"section",20),R.Wb(1,"j-collapsible"),R.Wb(2,"j-collapsible-trigger"),R.Wb(3,"div",21),R.Wb(4,"h5",11),R.Wb(5,"span",28),R.Tc(6,"CURRENCY_PAYMENT.CONTRACTS.RECIPIENT.TITLE"),R.Vb(),R.Wb(7,"span"),R.Tc(8),R.Vb(),R.Vb(),R.Rb(9,"span",23),R.Vb(),R.Vb(),R.Wb(10,"j-collapsible-body"),R.Wb(11,"div",24),R.Wb(12,"div",26),R.Wb(13,"div",27),R.Wb(14,"span",28),R.Tc(15,"CURRENCY_PAYMENT.CONTRACTS.RECIPIENT.NAME"),R.Vb(),R.Tc(16,": "),R.Vb(),R.Wb(17,"div",29),R.Tc(18),R.Vb(),R.Vb(),R.Wb(19,"div",26),R.Wb(20,"div",27),R.Wb(21,"span",28),R.Tc(22,"CURRENCY_PAYMENT.CONTRACTS.RECIPIENT.COUNTRY"),R.Vb(),R.Tc(23,": "),R.Vb(),R.Wb(24,"div",29),R.Tc(25),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Vb()),2&t){const t=e.$implicit,n=e.index,o=R.mc(2);R.Ab(8),R.Vc(" ",n+2,""),R.Ab(10),R.Vc(" ",t.name," "),R.Ab(7),R.Vc(" ",o.mapCountry(t)," ")}}function Zt(t,e){if(1&t){const t=R.Xb();R.Wb(0,"section",1),R.Wb(1,"div",2),R.ic("click",(function(e){return R.Ic(t),R.mc().close()})),R.Vb(),R.Wb(2,"section",3),R.Wb(3,"section",4),R.Wb(4,"article",5),R.Rb(5,"span",6),R.Wb(6,"span",7),R.Tc(7,"CURRENCY_PAYMENT.CONTRACTS.STATUS.REGED"),R.Vb(),R.Vb(),R.Wb(8,"a",8),R.ic("click",(function(e){return R.Ic(t),R.mc().close(e)})),R.Vb(),R.Vb(),R.Wb(9,"section",9),R.Wb(10,"section",10),R.Wb(11,"h3",11),R.Wb(12,"span",12),R.Tc(13,"\u2116"),R.Vb(),R.Tc(14),R.Vb(),R.Rc(15,Ht,2,1,"div",13),R.Wb(16,"div",14),R.Wb(17,"div",15),R.Rb(18,"small",16),R.Wb(19,"div",17),R.Rb(20,"j-money",18),R.Vb(),R.Vb(),R.Wb(21,"div",15),R.Rb(22,"small",19),R.Wb(23,"div",17),R.Rb(24,"j-money",18),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Wb(25,"section",20),R.Wb(26,"j-collapsible"),R.Wb(27,"j-collapsible-trigger"),R.Wb(28,"div",21),R.Wb(29,"h5",22),R.Tc(30,"CURRENCY_PAYMENT.CONTRACTS.DETAILS.TITLE"),R.Vb(),R.Rb(31,"span",23),R.Vb(),R.Vb(),R.Wb(32,"j-collapsible-body"),R.Wb(33,"div",24),R.Rc(34,Qt,7,1,"div",25),R.Wb(35,"div",26),R.Wb(36,"div",27),R.Wb(37,"span",28),R.Tc(38,"CURRENCY_PAYMENT.CONTRACTS.DETAILS.DATE_FROM"),R.Vb(),R.Tc(39,": "),R.Vb(),R.Wb(40,"div",29),R.Tc(41),R.nc(42,"date"),R.Vb(),R.Vb(),R.Wb(43,"div",26),R.Wb(44,"div",27),R.Wb(45,"span",28),R.Tc(46,"CURRENCY_PAYMENT.CONTRACTS.DETAILS.DATE_TO"),R.Vb(),R.Tc(47,": "),R.Vb(),R.Wb(48,"div",29),R.Tc(49),R.nc(50,"date"),R.Vb(),R.Vb(),R.Rc(51,Gt,7,1,"div",25),R.Rc(52,qt,8,4,"div",25),R.Wb(53,"div",26),R.Wb(54,"div",27),R.Wb(55,"span",28),R.Tc(56,"CURRENCY_PAYMENT.CONTRACTS.DETAILS.CURRENCIES"),R.Vb(),R.Tc(57,": "),R.Vb(),R.Wb(58,"div",29),R.Tc(59),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Rc(60,zt,39,5,"section",30),R.Rc(61,Jt,26,3,"section",31),R.Vb(),R.Vb(),R.Vb()}if(2&t){const t=R.mc();R.Hb("is-shown",t.isShown),R.Ab(2),R.Hb("is-shown",t.isShown),R.Ab(3),R.uc("inlineSVG","/assets/icons/counterparty/status.svg"),R.Ab(9),R.Vc(" ",t.contract.contractNumber," "),R.Ab(1),R.uc("ngIf",0==(null==t.extraRecipients?null:t.extraRecipients.length)),R.Ab(5),R.uc("money",t.contract.amount),R.Ab(4),R.uc("money",t.contract.remainder),R.Ab(10),R.uc("ngIf",t.contract.type),R.Ab(7),R.Vc("",R.pc(42,17,t.contract.dateFrom,"d MMMM yyyy")," "),R.Ab(8),R.Vc("",R.pc(50,20,t.contract.dateTo,"d MMMM yyyy")," "),R.Ab(2),R.uc("ngIf",t.contract.registrationNumberContract),R.Ab(1),R.uc("ngIf",t.contract.documentDate),R.Ab(7),R.Vc("",t.contract.permittedCurrencies.join(", ")," "),R.Ab(1),R.uc("ngIf",t.primaryRecipient),R.Ab(1),R.uc("ngForOf",t.extraRecipients)}}let te=(()=>{class t{constructor(t,e){this.document=t,this.translateService=e,this.isShown=!1}get primaryRecipient(){var t;return null===(t=this.contract.recipients)||void 0===t?void 0:t.find(t=>t.primary)}get extraRecipients(){var t;return null===(t=this.contract.recipients)||void 0===t?void 0:t.filter(t=>!t.primary)}mapBank(t){const{bankBic:e,bankName:n}=t;return`${e}${e?n?`- ${n}`:"":n||""}`}mapCountry(t){var e,n,o,i;if(t.country){const i=t.country.code;let s="";switch(this.translateService.currentLang){case"ru":default:s=null===(e=t.country)||void 0===e?void 0:e.nameRu;case"kk":s=null===(n=t.country)||void 0===n?void 0:n.nameKk;case"en":s=null===(o=t.country)||void 0===o?void 0:o.nameEn}return`${i} - ${s}`}return t.primary&&(null===(i=this.contract.contractor)||void 0===i?void 0:i.country)?`${this.contract.contractor.country.code} - ${this.contract.contractor.country.name}`:t.countryCode?t.countryCode:"-"}ngOnDestroy(){this.close()}show(){this.document.body.classList.add("overflow-hidden"),this.isShown=!0}close(t=null){var e;null===(e=t)||void 0===e||e.preventDefault(),this.document.body.classList.remove("overflow-hidden"),this.isShown=!1}}return t.\u0275fac=function(e){return new(e||t)(R.Qb(o.e),R.Qb(a.e))},t.\u0275cmp=R.Kb({type:t,selectors:[["j-fx-contract-details"]],inputs:{contract:"contract"},decls:1,vars:1,consts:[["class","f-page-wrapper",3,"is-shown",4,"ngIf"],[1,"f-page-wrapper"],[1,"f-page-backdrop",3,"click"],[1,"f-page-content","f-page-content--gray","f-page-content--quarter","fx"],[1,"fx__header"],[1,"fx__status"],[1,"text-success",3,"inlineSVG"],["translate","",1,"text-muted","ml-3","p3"],["href","#","inlineSVG","assets/icons/payments/close.svg",1,"fx__close","ml-auto",3,"click"],[1,"fx__scrollable"],[1,"fx__block","py-3","mt-0"],[1,"mb-0"],[1,"text-light"],["class","p2",4,"ngIf"],[1,"fx__amounts"],[1,"fx__amounts-item"],["translate","CURRENCY_PAYMENT.CONTRACTS.INFO.AMOUNT",1,"text-muted"],[1,"text-dark"],[3,"money"],["translate","CURRENCY_PAYMENT.CONTRACTS.INFO.REMAINDER",1,"text-muted","p4"],[1,"fx__block","fx__block--collapsible"],[1,"fx__collapse","d-flex","align-items-center"],["translate","",1,"mb-0"],["inlineSVG","assets/icons/payments/collapse.svg",1,"ml-auto","text-primary","fx__arrow"],[1,"fx__body","p2"],["class","j-desc-row",4,"ngIf"],[1,"j-desc-row"],[1,"text-muted","j-desc-child"],["translate",""],[1,"text-dark","j-desc-child"],["class","fx__block fx__block--collapsible",4,"ngIf"],["class","fx__block fx__block--collapsible",4,"ngFor","ngForOf"],[1,"p2"],[4,"ngIf"]],template:function(t,e){1&t&&R.Rc(0,Zt,62,23,"section",0),2&t&&R.uc("ngIf",e.contract)},directives:[o.u,kt.a,a.a,Ft.a,$t.a,Bt.a,Kt.a,o.t],pipes:[o.f],styles:[".fx{padding:1rem;width:100%;max-width:425px}.fx__header{-webkit-box-pack:justify;justify-content:space-between;margin-top:.5rem;margin-bottom:1.5rem}.fx__header,.fx__status{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center}.fx__status{padding-left:1rem}.fx__scrollable{-webkit-box-flex:1;flex-grow:1;overflow-y:auto}.fx__scrollable::-webkit-scrollbar{width:8px}.fx__scrollable::-webkit-scrollbar-track{background:#fff}.fx__scrollable::-webkit-scrollbar-thumb{background:#d6dadf;border-radius:10px}.fx__collapse{padding:1rem 0}.j-collapsed .fx__body{padding-bottom:1rem}.j-collapsed .fx__collapse .fx__arrow{-webkit-transform:rotate(0deg);transform:rotate(0deg)}.fx__block{background:#fff;border-radius:.5rem;padding:1.5rem 1rem;margin:.75rem 0}.fx__block--collapsible{padding-top:0;padding-bottom:0}.fx__arrow,.fx__block--collapsible{-webkit-transition:all .2s ease-in-out;transition:all .2s ease-in-out}.fx__arrow{-webkit-transform:rotate(540deg);transform:rotate(540deg)}.fx__collapse{cursor:pointer;-webkit-box-align:center;align-items:center}.fx__link{color:#1586bb;display:-webkit-box;display:flex;padding-left:1rem;padding-right:1rem;width:100%}.fx__link:hover{color:#ef5630}.fx__icon{margin-right:.5rem;display:block}.fx__amounts{display:-webkit-box;display:flex;border-top:1px solid #eceef1;margin-top:1.5rem;padding-top:1rem}.fx__amounts-item{-webkit-box-flex:1;flex-grow:1}.fx__amounts-item small{display:block;margin-bottom:.25rem}"],encapsulation:2}),t})();var ee=n("UoEe"),ne=n("SCaJ"),oe=n("tepA");function ie(t,e){if(1&t){const t=R.Xb();R.Wb(0,"div",4),R.ic("click",(function(n){R.Ic(t);const o=e.$implicit;return R.mc().onSelect(o)})),R.Wb(1,"div",5),R.Rb(2,"span",6),R.Tc(3,": "),R.Rb(4,"span",7),R.nc(5,"highlight"),R.nc(6,"formatIban"),R.Vb(),R.Wb(7,"div",8),R.Rb(8,"span",7),R.nc(9,"highlight"),R.Tc(10,": "),R.Rb(11,"span",7),R.nc(12,"highlight"),R.Vb(),R.Vb()}if(2&t){const t=e.$implicit,n=R.mc();R.Ab(4),R.uc("innerHTML",R.pc(5,3,R.oc(6,6,t.iban),n.searchTerm),R.Jc),R.Ab(4),R.uc("innerHTML",R.pc(9,8,t.bic,n.searchTerm),R.Jc),R.Ab(3),R.uc("innerHTML",R.pc(12,11,t.bankName,n.searchTerm),R.Jc)}}let se=(()=>{class t{constructor(t){this.translateService=t,this.selected=new R.n}get countryName(){var t,e,n,o,i,s;switch(this.translateService.currentLang){case"ru":default:return null===(e=null===(t=this.recipient)||void 0===t?void 0:t.country)||void 0===e?void 0:e.nameRu;case"kk":return null===(o=null===(n=this.recipient)||void 0===n?void 0:n.country)||void 0===o?void 0:o.nameKk;case"en":return null===(s=null===(i=this.recipient)||void 0===i?void 0:i.country)||void 0===s?void 0:s.nameEn}}onSelect(t){this.selected.emit({recipient:this.recipient,account:t})}}return t.\u0275fac=function(e){return new(e||t)(R.Qb(a.e))},t.\u0275cmp=R.Kb({type:t,selectors:[["j-foreign-recipient"]],inputs:{searchTerm:"searchTerm",recipient:"recipient"},outputs:{selected:"selected"},decls:6,vars:9,consts:[[1,"recipient"],[1,"text-dark","p2","recipient__name",3,"innerHTML"],[1,"text-muted","p3","recipient__country",3,"innerHTML"],["class","recipient__account p3",3,"click",4,"ngFor","ngForOf"],[1,"recipient__account","p3",3,"click"],[1,"text-dark"],["translate","CURRENCY_PAYMENT.DICTIONARY.IBAN"],[3,"innerHTML"],[1,"text-muted"]],template:function(t,e){1&t&&(R.Wb(0,"div",0),R.Rb(1,"h5",1),R.nc(2,"highlight"),R.Rb(3,"div",2),R.nc(4,"highlight"),R.Rc(5,ie,13,14,"div",3),R.Vb()),2&t&&(R.Ab(1),R.uc("innerHTML",R.pc(2,3,e.recipient.name,e.searchTerm),R.Jc),R.Ab(2),R.uc("innerHTML",R.pc(4,6,e.countryName,e.searchTerm),R.Jc),R.Ab(2),R.uc("ngForOf",e.recipient.accounts))},directives:[o.t,a.a],pipes:[ne.a,oe.a],styles:[".dictionary[_ngcontent-%COMP%]{padding:40px 24px;max-height:80vh;display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column}.dictionary__header[_ngcontent-%COMP%]{flex-shrink:0;background:#fff}.dictionary__list[_ngcontent-%COMP%]{overflow-y:auto;-webkit-box-flex:1;flex-grow:1}.dictionary__heading[_ngcontent-%COMP%]{margin-bottom:18px}.dictionary__search[_ngcontent-%COMP%], .recipient[_ngcontent-%COMP%]{padding:16px 0}.recipient__name[_ngcontent-%COMP%]{margin-bottom:4px;line-height:24px}.recipient__country[_ngcontent-%COMP%]{margin-bottom:16px;line-height:18px}.recipient__account[_ngcontent-%COMP%]{padding:8px 16px;background:#f6f7f8;border-radius:8px;line-height:21px;cursor:pointer;-webkit-transition:all .2s ease-in-out;transition:all .2s ease-in-out}.recipient__account[_ngcontent-%COMP%]:hover{background:#e9ecf1}.recipient__account[_ngcontent-%COMP%] + .recipient__account[_ngcontent-%COMP%]{margin-top:8px}"]}),t})();function ce(t,e){1&t&&R.Rb(0,"j-empty-placeholder",9)}function ae(t,e){1&t&&R.Rb(0,"j-empty-placeholder",10)}function re(t,e){if(1&t){const t=R.Xb();R.Wb(0,"j-foreign-recipient",11),R.ic("selected",(function(e){return R.Ic(t),R.mc().onRecipientSelect(e)})),R.Vb()}if(2&t){const t=e.$implicit,n=R.mc();R.uc("recipient",t)("searchTerm",n.searchTerm)}}let le=(()=>{class t{constructor(t,e){this.modal=t,this.recipientsService=e,this.searchTerm="",this.loadRecipients()}ngOnInit(){}loadRecipients(){return Object(N.a)(this,void 0,void 0,(function*(){this.recipients=yield this.recipientsService.getForeignRecipients(),this.filteredRecipients=[...this.recipients]}))}onQueryChange(t){return Object(N.a)(this,void 0,void 0,(function*(){this.searchTerm=t,this.filteredRecipients=yield this.recipientsService.getForeignRecipients(t)}))}onRecipientSelect(t){this.modal.close(t)}onClose(){this.modal.dismiss()}}return t.\u0275fac=function(e){return new(e||t)(R.Qb(c.a),R.Qb(X.a))},t.\u0275cmp=R.Kb({type:t,selectors:[["j-foreign-recipients-dictionary"]],decls:9,vars:4,consts:[[1,"dictionary"],[1,"dictionary__header"],["translate","CURRENCY_PAYMENT.DICTIONARY.TITLE",1,"dictionary__heading"],[1,"dictionary__search"],[3,"placeholder","valueChanged"],["label","CURRENCY_PAYMENT.DICTIONARY.EMPTY",4,"ngIf"],["label","CURRENCY_PAYMENT.DICTIONARY.NOT_FOUND",4,"ngIf"],[1,"dictionary__list"],[3,"recipient","searchTerm","selected",4,"ngFor","ngForOf"],["label","CURRENCY_PAYMENT.DICTIONARY.EMPTY"],["label","CURRENCY_PAYMENT.DICTIONARY.NOT_FOUND"],[3,"recipient","searchTerm","selected"]],template:function(t,e){1&t&&(R.Wb(0,"div",0),R.Wb(1,"div",1),R.Rb(2,"h5",2),R.Wb(3,"div",3),R.Wb(4,"j-search-input",4),R.ic("valueChanged",(function(t){return e.onQueryChange(t)})),R.Vb(),R.Vb(),R.Vb(),R.Rc(5,ce,1,0,"j-empty-placeholder",5),R.Rc(6,ae,1,0,"j-empty-placeholder",6),R.Wb(7,"div",7),R.Rc(8,re,1,2,"j-foreign-recipient",8),R.Vb(),R.Vb()),2&t&&(R.Ab(4),R.uc("placeholder","CURRENCY_PAYMENT.DICTIONARY.SEARCH"),R.Ab(1),R.uc("ngIf",0==(null==e.recipients?null:e.recipients.length)),R.Ab(1),R.uc("ngIf",(null==e.recipients?null:e.recipients.length)>0&&0==(null==e.filteredRecipients?null:e.filteredRecipients.length)),R.Ab(2),R.uc("ngForOf",e.filteredRecipients))},directives:[a.a,ee.a,o.u,o.t,jt.a,se],styles:[".dictionary[_ngcontent-%COMP%]{padding:40px 24px;max-height:80vh;display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column}.dictionary__header[_ngcontent-%COMP%]{flex-shrink:0;background:#fff}.dictionary__list[_ngcontent-%COMP%]{overflow-y:auto;-webkit-box-flex:1;flex-grow:1}.dictionary__heading[_ngcontent-%COMP%]{margin-bottom:18px}.dictionary__search[_ngcontent-%COMP%], .recipient[_ngcontent-%COMP%]{padding:16px 0}.recipient__name[_ngcontent-%COMP%]{margin-bottom:4px;line-height:24px}.recipient__country[_ngcontent-%COMP%]{margin-bottom:16px;line-height:18px}.recipient__account[_ngcontent-%COMP%]{padding:8px 16px;background:#f6f7f8;border-radius:8px;line-height:21px;cursor:pointer;-webkit-transition:all .2s ease-in-out;transition:all .2s ease-in-out}.recipient__account[_ngcontent-%COMP%]:hover{background:#e9ecf1}.recipient__account[_ngcontent-%COMP%] + .recipient__account[_ngcontent-%COMP%]{margin-top:8px}"]}),t})();var be=n("q46q");function ue(t,e){if(1&t&&(R.Rb(0,"div",3),R.nc(1,"highlight")),2&t){const t=R.mc();R.uc("innerHTML",R.pc(1,1,t.bic,t.searchTerm),R.Jc)}}let me=(()=>{class t{constructor(){this.selected=new R.n}get bic(){if(this.recipient.bankBic&&this.recipient.bankName)return`${this.recipient.bankBic} - ${this.recipient.bankName}`}onSelect(){this.selected.emit(this.recipient)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=R.Kb({type:t,selectors:[["j-foreign-contracts-recipient"]],inputs:{searchTerm:"searchTerm",recipient:"recipient"},outputs:{selected:"selected"},decls:4,vars:5,consts:[[1,"recipient__account","p3","mt-3","pt-3",3,"click"],[1,"text-dark","p2","recipient__name",3,"innerHTML"],["class","text-muted p3 recipient__country mb-0",3,"innerHTML",4,"ngIf"],[1,"text-muted","p3","recipient__country","mb-0",3,"innerHTML"]],template:function(t,e){1&t&&(R.Wb(0,"div",0),R.ic("click",(function(t){return e.onSelect()})),R.Rb(1,"h5",1),R.nc(2,"highlight"),R.Rc(3,ue,2,4,"div",2),R.Vb()),2&t&&(R.Ab(1),R.uc("innerHTML",R.pc(2,2,e.recipient.name,e.searchTerm),R.Jc),R.Ab(2),R.uc("ngIf",e.bic))},directives:[o.u],pipes:[ne.a],styles:[".dictionary[_ngcontent-%COMP%]{padding:40px 24px;max-height:80vh;display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column}.dictionary__header[_ngcontent-%COMP%]{flex-shrink:0;background:#fff}.dictionary__list[_ngcontent-%COMP%]{overflow-y:auto;-webkit-box-flex:1;flex-grow:1}.dictionary__heading[_ngcontent-%COMP%]{margin-bottom:18px}.dictionary__search[_ngcontent-%COMP%], .recipient[_ngcontent-%COMP%]{padding:16px 0}.recipient__name[_ngcontent-%COMP%]{margin-bottom:4px;line-height:24px}.recipient__country[_ngcontent-%COMP%]{margin-bottom:16px;line-height:18px}.recipient__account[_ngcontent-%COMP%]{padding:8px 16px;background:#f6f7f8;border-radius:8px;line-height:21px;cursor:pointer;-webkit-transition:all .2s ease-in-out;transition:all .2s ease-in-out}.recipient__account[_ngcontent-%COMP%]:hover{background:#e9ecf1}.recipient__account[_ngcontent-%COMP%] + .recipient__account[_ngcontent-%COMP%]{margin-top:8px}"]}),t})();function de(t,e){1&t&&R.Rb(0,"j-empty-placeholder",9)}function pe(t,e){1&t&&R.Rb(0,"j-empty-placeholder",10)}function he(t,e){if(1&t){const t=R.Xb();R.Wb(0,"j-foreign-contracts-recipient",11),R.ic("selected",(function(e){return R.Ic(t),R.mc().onRecipientSelect(e)})),R.Vb()}if(2&t){const t=e.$implicit,n=R.mc();R.uc("recipient",t)("searchTerm",n.searchTerm)}}let fe=(()=>{class t{constructor(t){this.modal=t,this.searchTerm=""}ngOnInit(){this.filteredRecipients=[...this.recipients]}onQueryChange(t){return Object(N.a)(this,void 0,void 0,(function*(){this.searchTerm=t,t||(this.filteredRecipients=[...this.recipients]),this.filteredRecipients=this.recipients.filter(e=>this.includesQuery(e.name,t)||this.includesQuery(e.bankBic,t))}))}onRecipientSelect(t){this.modal.close(t)}onClose(){this.modal.dismiss()}includesQuery(t,e){var n,o;return null===(n=t)||void 0===n?void 0:n.toLowerCase().includes(null===(o=e)||void 0===o?void 0:o.toLowerCase())}}return t.\u0275fac=function(e){return new(e||t)(R.Qb(c.a))},t.\u0275cmp=R.Kb({type:t,selectors:[["j-foreign-contracts-recipients-dictionary"]],decls:9,vars:4,consts:[[1,"dictionary"],[1,"dictionary__header"],["translate","CURRENCY_PAYMENT.CONTRACTS_DICTIONARY.TITLE",1,"dictionary__heading"],[1,"dictionary__search"],[3,"placeholder","valueChanged"],["label","CURRENCY_PAYMENT.CONTRACTS_DICTIONARY.EMPTY",4,"ngIf"],["label","CURRENCY_PAYMENT.DICTIONARY.NOT_FOUND",4,"ngIf"],[1,"dictionary__list"],[3,"recipient","searchTerm","selected",4,"ngFor","ngForOf"],["label","CURRENCY_PAYMENT.CONTRACTS_DICTIONARY.EMPTY"],["label","CURRENCY_PAYMENT.DICTIONARY.NOT_FOUND"],[3,"recipient","searchTerm","selected"]],template:function(t,e){1&t&&(R.Wb(0,"div",0),R.Wb(1,"div",1),R.Rb(2,"h5",2),R.Wb(3,"div",3),R.Wb(4,"j-search-input",4),R.ic("valueChanged",(function(t){return e.onQueryChange(t)})),R.Vb(),R.Vb(),R.Vb(),R.Rc(5,de,1,0,"j-empty-placeholder",5),R.Rc(6,pe,1,0,"j-empty-placeholder",6),R.Wb(7,"div",7),R.Rc(8,he,1,2,"j-foreign-contracts-recipient",8),R.Vb(),R.Vb()),2&t&&(R.Ab(4),R.uc("placeholder","CURRENCY_PAYMENT.CONTRACTS_DICTIONARY.SEARCH"),R.Ab(1),R.uc("ngIf",0==(null==e.recipients?null:e.recipients.length)),R.Ab(1),R.uc("ngIf",(null==e.recipients?null:e.recipients.length)>0&&0==(null==e.filteredRecipients?null:e.filteredRecipients.length)),R.Ab(2),R.uc("ngForOf",e.filteredRecipients))},directives:[a.a,ee.a,o.u,o.t,jt.a,me],styles:[".dictionary[_ngcontent-%COMP%]{padding:40px 24px;max-height:80vh;display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column}.dictionary__header[_ngcontent-%COMP%]{flex-shrink:0;background:#fff}.dictionary__list[_ngcontent-%COMP%]{overflow-y:auto;-webkit-box-flex:1;flex-grow:1}.dictionary__heading[_ngcontent-%COMP%]{margin-bottom:18px}.dictionary__search[_ngcontent-%COMP%], .recipient[_ngcontent-%COMP%]{padding:16px 0}.recipient__name[_ngcontent-%COMP%]{margin-bottom:4px;line-height:24px}.recipient__country[_ngcontent-%COMP%]{margin-bottom:16px;line-height:18px}.recipient__account[_ngcontent-%COMP%]{padding:8px 16px;background:#f6f7f8;border-radius:8px;line-height:21px;cursor:pointer;-webkit-transition:all .2s ease-in-out;transition:all .2s ease-in-out}.recipient__account[_ngcontent-%COMP%]:hover{background:#e9ecf1}.recipient__account[_ngcontent-%COMP%] + .recipient__account[_ngcontent-%COMP%]{margin-top:8px}"]}),t})(),ge=(()=>{class t{constructor(t){this.modal=t}ngOnInit(){}close(){this.modal.close()}}return t.\u0275fac=function(e){return new(e||t)(R.Qb(c.a))},t.\u0275cmp=R.Kb({type:t,selectors:[["j-iin-check-error"]],decls:15,vars:9,consts:[[1,"result-modal"],[1,"modal-header"],["type","button",1,"close",3,"click"],["src","/assets/icons/close.svg",3,"alt"],[1,"modal-body","p-3"],[1,"text-center"],[1,"modal-body","text-center"],[1,"form-group"],[1,"btn","btn-primary",3,"click"]],template:function(t,e){1&t&&(R.Wb(0,"div",0),R.Wb(1,"div",1),R.Wb(2,"button",2),R.ic("click",(function(t){return e.modal.dismiss()})),R.Rb(3,"img",3),R.nc(4,"translate"),R.Vb(),R.Vb(),R.Wb(5,"div",4),R.Wb(6,"div",5),R.Wb(7,"h5"),R.Tc(8),R.nc(9,"translate"),R.Vb(),R.Vb(),R.Vb(),R.Wb(10,"div",6),R.Wb(11,"div",7),R.Wb(12,"button",8),R.ic("click",(function(t){return e.close()})),R.Tc(13),R.nc(14,"translate"),R.Vb(),R.Vb(),R.Vb(),R.Vb()),2&t&&(R.Ab(3),R.vc("alt",R.oc(4,3,"SHARED.CLOSE")),R.Ab(5),R.Uc(R.oc(9,5,"PAYMENTS.IIN_CHECK_ERROR")),R.Ab(5),R.Vc("",R.oc(14,7,"SHARED.CLOSE")," "))},pipes:[a.d],styles:[""]}),t})();var Ae=n("JPBo"),Te=n("CVrE"),ye=n("PqYM"),Re=n("CqXF"),ve=n("w1tV"),Ce=n("wd/R"),Ee=n("E+oP"),Se=n.n(Ee),Ve=n("AytR");const Ne=["formDirective"],Ie=["senderAccountDropdown"];let ke=(()=>{class t{constructor(t,e,n,o,i,s,c,a,r,l,b,u,m){this.form=t,this.api=e,this.route=n,this.router=o,this.companyService=i,this.paymentsService=s,this.maskService=c,this.modals=a,this.dictionaries=r,this.pipeline=l,this.translateService=b,this.authorityPermissionsService=u,this.featureFlagsService=m,this.isRestricted=!1,this.PAYMENT_STATUS=B.i,this.SPINNER="BasePaymentContainer",this.restoredData={},this.amountMessage$=new I.a(""),this.periodMessage$=new I.a(""),this.commission$=new I.a(null),this.vat$=new I.a(0),this.total$=new I.a(0),this.purposeMessage$=new I.a(""),this.dateMessage$=new I.a(""),this.purposeLength$=new I.a(0),this.workingHours$=new I.a(null),this.workingDays$=new I.a([]),this.processingPayment$=new I.a(null),this.isImported=!1,this.subs=new Et.a,this.isPermissionsUpdating=!1,this.isPermissionsUpdateAllowed=!Ve.a.production,this.errors=this.paymentsService.errors,this.rules=this.paymentsService.rules,this.ugdStore=this.dictionaries.UGDictionary,this.knpStore=this.dictionaries.KNPDictionary,this.kbkStore=this.dictionaries.KBKDictionary,this.getWorkingHours()}getPermission(){return Object(N.a)(this,void 0,void 0,(function*(){this.isRestricted=yield this.authorityPermissionsService.isRestricted(this.paymentType)}))}getWorkingHours(){return Object(N.a)(this,void 0,void 0,(function*(){const t=yield this.api.getWorkingHours();this.workingHours$.next(t)}))}ngOnInit(){this.getPermission(),this.listenRouterParams(),this.createControlsStream(this.form),this.combineUrgentStream(),this.subs.add(this.processingPayment$.pipe(Object(P.a)(),Object(w.a)(0)).subscribe(t=>{t?this.paymentsService.spinner.show(this.SPINNER):this.paymentsService.spinner.hide(this.SPINNER)}))}ngOnDestroy(){this.subs.unsubscribe(),this.paymentsService.spinner.hide(this.SPINNER)}get paymentId(){return this.route.snapshot.params.paymentId}get dateHelper(){return this.form.controls.date.value?"":"PAYMENTS.FORM.DATE_HELPER"}get senderAccountLabel(){return this.form.controls.senderAccount?"PAYMENTS.FORM.SENDER_ACCOUNT.SELECTED":"PAYMENTS.FORM.SENDER_ACCOUNT.EMPTY"}get submitLabel(){return"SHARED."+(this.paymentsService.isSignatureRequired?"TO_SIGN":"FOR_SIGN")}get paymentType(){return this.form.controls.type.value}set paymentType(t){this.form.controls.type.patchValue(t)}onSenderAccountSelect(t){this.form.controls.senderAccount.setValue(t)}hasError(t,e){var n,o;return e.invalid&&(e.dirty&&!(null===(n=t)||void 0===n?void 0:n.isFocused)||(null===(o=this.formDirective)||void 0===o?void 0:o.submitted)&&e.touched)}sendPayment(t){var e;this.formDirective.form.markAsPristine();const n=this.paymentsService.paymentNumber,o=t||Object.assign(Object.assign({},this.form.value),{purpose:[this.form.value.purpose,this.purposeMessage$.getValue()].filter(t=>!!t).join(". ")});return this.processingPayment$.next(o),this.paymentsService.paymentNumber.entity=null,this.pipeline.processPayment({paymentId:this.paymentId,total:this.total$.getValue()-this.commission$.getValue(),commission:this.commission$.getValue(),status:null===(e=this.restoredData)||void 0===e?void 0:e.status,userPurpose:this.form.value.purpose,rawBody:o}).then(t=>{t?this.restoredData={status:t.status.code,signatures:t.signatures,companyId:t.companyId}:(this.restoredData=null,n.entity||n.fetching||(n.entity=o.number))}).catch(t=>{console.log(t)}).finally(()=>{this.processingPayment$.next(null)})}onSubmit(t){t&&t.preventDefault(),this.form.valid?this.processPayment():this.form.markAllAsTouched()}updatePermissions(){return Object(N.a)(this,void 0,void 0,(function*(){this.isPermissionsUpdating=!0;try{yield this.authorityPermissionsService.updatePermissions(),this.getPermission()}catch(t){}finally{this.isPermissionsUpdating=!1}}))}processPayment(){return Object(N.a)(this,void 0,void 0,(function*(){const t=this.form.getRawValue();this.processingPayment$.next(t);try{const e=yield this.api.checkWorkingTime(t.date);let n;n=!!this.featureFlagsService.isDisabled(q.a.PAYMENT_PERMISSIONS)||(yield this.api.checkAmountLimit(t.amount,this.paymentType)).isPassed,e&&n?this.sendPayment():this.processingPayment$.next(null)}catch(e){this.processingPayment$.next(null)}}))}openKnpDictionary(t,e){t.close(),t.blur(),setTimeout(()=>{const t=this.modals.open(bt,{backdropClass:"backdrop_light",windowClass:"modal_light modal_max-height",centered:!0});t.componentInstance.paymentType=this.paymentType,t.result.then(t=>{this.form.controls.knp.patchValue(t.code)}).catch(()=>{})},0)}knpComparator(t,e){return t.code===e}combineUrgentStream(){var t;const{date:e,bankAccount:n,bankReceiver:o}=this.controlsStream,{urgent:i}=this.form.controls;if(!i)return;const s=new Date,c=Object(f.getTimeZoneOffset)(new Date,"Asia/Almaty");s.setHours(s.getHours()+-c/60);const a=new Date(s);a.setHours(9,0,0);const r=new Date(s);let l;r.setHours(16,0,0);let b,u=!0;l=s>=a&&s<=r?Object(ye.a)(+r-+s).pipe(Object(Re.a)(!1)):s<a?Object(ye.a)(+a-+s).pipe(Object(Re.a)(u=!u)):Object(ye.a)(a.setDate(a.getDate()+1)-+s).pipe(Object(Re.a)(u=!u)),l=l.pipe(Object($.a)(1),Object(_.a)(u)),o?b=Object(O.a)([n,o,this.dictionaries.bankDictionary.entities$]).pipe(Object(y.a)(([t,e,n])=>{let o;return e&&(o=n[e])&&o.salaryTransitIban?o.salaryTransitIban:o&&!o.salaryTransitIban&&t?Object(f.ibanPrefix)(t,K.a.KZT):""})):n&&(b=n.pipe(Object(y.a)(t=>Object(f.ibanPrefix)(t,K.a.KZT)))),b=(null===(t=b)||void 0===t?void 0:t.pipe(Object(y.a)(t=>this.paymentsService.bankFromAccount.transform(t))))||Object(j.a)(""),this.subs.add(Object(O.a)([e.pipe(Object(y.a)(t=>!t)),b.pipe(Object(x.a)(300),Object(y.a)(t=>"TSESKZKA"!==t)),l]).pipe(Object(y.a)(t=>t.every(t=>t))).subscribe(t=>{t&&i.disabled?i.enable():!t&&i.enabled&&(i.disable(),i.setValue(!1))}))}listenRouterParams(){this.subs.add(this.route.params.pipe(Object(y.a)(t=>({state:window.history.state,params:t,route:this.route})),Object(x.a)(0),Object(Y.a)(({params:t,state:e})=>{var n,o,i;if(null===(n=e)||void 0===n?void 0:n.silent)return this.restoredData.status===B.i.DRAFT?this.paymentsService.rootTitle=C.b.EDIT_DRAFT:this.restoredData.status===B.i.CREATED&&(this.paymentsService.rootTitle=C.b.EDIT_PAYMENT),W.a;if(null===(o=e)||void 0===o?void 0:o.resolvedPayment)return Object(j.a)(e.resolvedPayment);if(t.paymentId||(null===(i=e)||void 0===i?void 0:i.repeatPaymentId)){const n=t.paymentId||e.repeatPaymentId;return Object(M.a)(this.api.getPaymentById(n)).pipe(Object(U.a)(t=>(this.router.navigate([this.router.url.replace("/"+n,"")]),W.a)))}return this.setAutoNumeration(),this.paymentsService.rootTitle=C.b.NEW,W.a})).subscribe(t=>{this.restorePayment(t)}))}getMaskConfig(){Object.entries(this.masks).forEach(([t,e])=>this.masks[t]=this.maskService.getConfig(e))}checkPersonalAccounts(t){0!==t.length?t.every(t=>t.isClosed||t.isLocked)?this.paymentsService.infoMessage.entity={type:C.a.info,message:C.d.allLocked}:(1===t.length&&(this.form.patchValue({senderAccount:t[0]}),this.senderAccountDropdown.selectAccount(t[0]),this.form.markAsPristine()),this.paymentsService.infoMessage.entity=null):this.paymentsService.infoMessage.entity={type:C.a.info,message:C.d.noAccounts}}createControlsStream(t){this.controlsStream=Object.entries(t.controls).reduce((t,[e,n],o,i)=>(t[e]=n.valueChanges.pipe(Object(_.a)(n.value)),t),{})}listenCommission(){const{amount:t,date:e,urgent:n,kbk:o,knp:i,senderAccount:s}=this.controlsStream;this.subs.add(Object(O.a)([Object(O.a)(Object.entries({amount:t,date:e,urgent:n,kbk:o,knp:i,senderAccount:s}).filter(([t,e])=>!!e).map(([t,e])=>e.pipe(Object(P.a)(),Object(y.a)(e=>[t,e])))),this.controlsStream.type.pipe(Object(P.a)()),this.companyService.currentCompany$.pipe(Object(L.a)(t=>!!t),Object(P.a)())]).pipe(Object(x.a)(300),Object(L.a)(([t])=>t.every(([t,e])=>!e||!this.form.controls[t]||this.form.controls[t].valid)),Object(Y.a)(([t,e,n])=>{const{amount:o,date:i,kbk:s,knp:c,urgent:a,senderAccount:r}=t.reduce((t,[e,n])=>(t[e]=n,t),{}),l={amount:this.maskService.getNumberedAmount(o),date:i,urgent:a,currency:K.a.KZT,category:B.h.DOMESTIC,type:e,companyId:n.id,kbk:s,knp:c,senderAccount:r};return this.paymentsService.calculateCommission$(l).pipe(Object(U.a)(t=>Object(j.a)(null)))})).subscribe(this.commission$))}listenVAT(){this.controlsStream.vat&&this.controlsStream.amount&&this.subs.add(Object(O.a)([this.controlsStream.vat,this.controlsStream.amount]).pipe(Object(y.a)(([t,e])=>t?Math.round(100*(12*this.maskService.getNumberedAmount(e)/112+Number.EPSILON))/100:0)).subscribe(this.vat$))}listenTotal(){this.form.controls.amount&&this.subs.add(Object(O.a)(this.commission$,this.controlsStream.amount).pipe(Object(y.a)(([t,e])=>t+this.maskService.getNumberedAmount(e))).subscribe(this.total$))}combineEmployeesAmount(){this.subs.add(this.controlsStream.employees.pipe(Object(x.a)(100),Object(y.a)(t=>(t||[]).reduce((t,e)=>t+e.amount,0))).subscribe(t=>{this.form.controls.amount.patchValue(t)}))}combineKNP(t=[t=>this.dictionaries.selectByPaymentType(t,{type:this.paymentType,sortFavourite:!0})],e){const n=[this.knpStore.items$];return e&&n.push(...e),Object(O.a)(n).pipe(Object(y.a)(e=>t.reduce((t,n)=>n(t,e.slice(1)),e[0])),Object(ve.a)())}combineKBK(t){this.kbk$=this.kbkStore.items$,Object(O.a)([this.kbkStore.items$.pipe(Object(y.a)(e=>this.dictionaries.selectByPaymentType(e,{type:t,sortFavourite:!0})))]).pipe(Object(y.a)(([t])=>t))}saveToDraft(t){this.formDirective.submitted=!0,this.formDirective.form.markAsPristine();const e=this.paymentsService.paymentNumber,n=t||Object.assign(Object.assign({},this.form.value),{purpose:[this.form.value.purpose,this.purposeMessage$.getValue()].filter(t=>!!t).join("; ")});e.entity=null,this.processingPayment$.next(Object.assign({id:this.paymentId},n)),this.pipeline.saveToDrafts(n,{paymentId:this.paymentId,type:this.paymentType,commission:this.commission$.value,userPurpose:this.form.value.purpose,category:B.h.DOMESTIC}).then(t=>{t.id!==this.paymentId&&(t&&(this.restoredData={status:t.status,signatures:t.signatures,companyId:t.companyId}),this.router.navigate([this.route.snapshot.params.paymentId?"../":".",t.id],{relativeTo:this.route,state:{silent:!0}}))}).catch(t=>{console.log(t),e.entity||e.fetching||(e.entity=n.number)}).finally(()=>this.processingPayment$.next(null))}setAutoNumeration(){this.subs.add(this.paymentsService.paymentNumber$.pipe(Object(D.a)(this.controlsStream.number)).subscribe(([t,e])=>{e||this.form.controls.number.setValue(t)}))}provideAmountMessage(){if(this.form.controls.amount){const{senderAccount:t,date:e}=this.controlsStream;this.subs.add(Object(O.a)([this.companyService.authorityLevel$,this.total$,t.pipe(Object(L.a)(t=>!!t)),e,this.workingHours$.asObservable()]).pipe(Object(Y.a)(([t,e,n,o,i])=>{var s;if(t!==B.a.PRIMARY_SIGNATURE)return Object(j.a)("");const c=(null===(s=i)||void 0===s?void 0:s.endTime)||f.edgeTimeLabel,a=n.balance.amount-e;if(a<0){const t=this.maskService.formatAmount(Math.abs(a));return o?this.translateService.get("PAYMENTS.AMOUNT_MESSAGES.DEFAULT",{amount:t,edge:`${Object(f.formatNgbDate)(o,this.translateService.currentLang)} ${c}`}):this.translateService.get("PAYMENTS.AMOUNT_MESSAGES.AUTO",{amount:t})}return Object(j.a)("")})).subscribe(this.amountMessage$))}}listenWorkingDays(){this.subs.add(this.dictionaries.workingDays.entity$.pipe(Object(y.a)(t=>this.dictionaries.selectDaysTimeline(Ce(Object(f.ngbDateToDate)(this.dateLimit.minDate)).format(f.ISO_8061),Ce(Object(f.ngbDateToDate)(this.dateLimit.maxDate)).format(f.ISO_8061),t))).subscribe(this.workingDays$))}listenDateMessageStream(){this.subs.add(Object(O.a)([this.companyService.authorityLevel$,this.controlsStream.date,this.controlsStream.senderAccount.pipe(Object(L.a)(t=>!!t))]).pipe(Object(y.a)(([t,e,n])=>t===B.a.PRIMARY_SIGNATURE?"PAYMENTS.DATE_MESSAGES.PRIMARY_ANY":e?"PAYMENTS.DATE_MESSAGES.SECONDARY_DATE":"PAYMENTS.DATE_MESSAGES.SECONDARY_DATE_AUTO")).subscribe(this.dateMessage$))}listenPurposeMessageStream(t=[],e=["vat","kbk","knp"]){const n={vat:t=>t?this.translateService.instant("PAYMENTS.FORM.INCLUDING_VAT",{amount:this.maskService.formatAmount(t)}):"",kbk:t=>{let e;return t&&(e=this.kbkStore.items.find(e=>e.code===t))?`${e.name}.`:""},knp:t=>{let e;return t&&(e=this.knpStore.items.find(e=>e.code===t))?`${e.name}.`:""}},o=[];o.push((this.controlsStream.vat&&this.vat$||Object(j.a)(0)).pipe(Object(y.a)(t=>["vat",t])),this.controlsStream.knp.pipe(Object(y.a)(t=>["knp",t]))),o.push(...t),this.subs.add(Object(O.a)(o).pipe(Object(x.a)(100),Object(y.a)(t=>t.reduce((t,e)=>(t[e[0]]=e[1],t),{})),Object(y.a)(t=>e.reduce((e,o)=>(Array.isArray(o)?e.push(o[1](t[o[0]],t)):e.push(n[o]?n[o](t[o],t):t[o]),e),[]).filter(t=>!!t).join(" ")),Object(F.a)(t=>{this.form.controls.purpose.patchValue(this.form.controls.purpose.value),t&&this.form.controls.purpose.markAllAsTouched()})).subscribe(this.purposeMessage$)),this.subs.add(Object(O.a)(this.purposeMessage$,this.controlsStream.purpose).pipe(Object(y.a)(([t,e])=>(t||"").length+(e||"").length)).subscribe(this.purposeLength$)),this.validatePurpose()}validatePurpose(){this.subs.add(Object(O.a)(this.purposeMessage$,this.controlsStream.purpose).subscribe(([t,e])=>{const n=(e||"").length+(t||"").length,o=this.form.touched?this.form.controls.purpose.errors:{};o&&n>this.rules.purposeLength&&(o.maxlength=n),this.form.controls.purpose.setErrors(Se()(o)?null:o,{emitEvent:!0})}))}restorePayment(t){this.subs.add(Object(O.a)([this.knpStore.fetched$,this.kbkStore.fetched$,this.ugdStore.fetched$,this.dictionaries.bankDictionary.fetched$,this.accountStore.fetched$]).pipe(Object(L.a)(t=>t.every(t=>t)),Object(F.a)(()=>{var e,n,o,i,s,c;let a;try{a=this.pipeline.flattenPaymentToModel(t)}catch(r){a={}}this.restoredData={companyId:t.companyId,status:null===(e=t.status)||void 0===e?void 0:e.code,signatures:t.signatures},t.id&&!this.paymentId?(a.number="",a.date=null,this.restoredData.status=null,this.paymentsService.rootTitle=C.b.NEW):this.paymentsService.rootTitle=this.restoredData.status===B.i.DRAFT?C.b.EDIT_DRAFT:C.b.EDIT_PAYMENT,a.emailOnSuccess&&(a.notify=!0),this.form.patchValue(Object.assign(Object.assign({},a),{purpose:null===(o=null===(n=t.details.associatedField)||void 0===n?void 0:n.parameters)||void 0===o?void 0:o.paymentPurpose})),null===(i=this.senderAccountDropdown)||void 0===i||i.selectByIban(null===(c=null===(s=t)||void 0===s?void 0:s.details)||void 0===c?void 0:c.payerIban),this.isImported=t.imported,a.number||this.setAutoNumeration()}),Object(x.a)(10),Object($.a)(1)).subscribe())}}return t.\u0275fac=function(t){R.hc()},t.\u0275dir=R.Lb({type:t,viewQuery:function(t,e){var n;1&t&&(R.Yc(Ne,!0),R.Yc(Ie,!0)),2&t&&(R.Ec(n=R.jc())&&(e.formDirective=n.first),R.Ec(n=R.jc())&&(e.senderAccountDropdown=n.first))}}),t})();var Oe=n("mR7B"),je=n("2A1n"),We=n("7rOj"),Me=n("FSKB"),Pe=n("YjsB"),xe=n("kDIH"),_e=n("cZYL"),De=n("hsBV"),we=n("Bl/x"),Ye=n("O1Qh"),Ue=n("vOW5"),Le=n("Ya7Z"),Fe=n("Q98t"),$e=n("B+58"),Be=n("Cg+c"),Ke=n("JqCM"),He=n("M6pS"),Qe=n("13E/"),Ge=n("H6TZ"),qe=n("Kx0l"),Xe=n("wV3k");const ze=["emailOnSuccess"],Je=["senderAccountDropdown"],Ze=["contractsSelect"],tn=["contractDetails"],en=["bankDropdown"],nn=["intermediaryBankDropdown"],on=["commissionAccountDropdown"],sn=["rubNonRussiaBankDropdown"],cn=["rubNonRussiaCorrespondentBankDropdown"],an=["rubNonRussiaCorrespondentIbanInput"];function rn(t,e){if(1&t){const t=R.Xb();R.Wb(0,"j-restricted-placeholder",2),R.ic("retried",(function(e){return R.Ic(t),R.mc().updatePermissions()})),R.Vb()}if(2&t){const t=R.mc();R.uc("isRetryable",t.isPermissionsUpdateAllowed)("isLoading",t.isPermissionsUpdating)}}function ln(t,e){if(1&t&&(R.Wb(0,"div",72),R.Rb(1,"small",73),R.nc(2,"translate"),R.Vb()),2&t){const t=R.mc(2);R.Hb("is-loading",t.isContractsDescriptionLoading),R.uc("jLoading",t.isContractsDescriptionLoading)("jLoadingInverted",!0),R.Ab(1),R.uc("innerHTML",R.pc(2,5,"CURRENCY_PAYMENT.CONTRACTS.SWITCH.DESCRIPTION",t.contractsSwitchDescriptionParams),R.Jc)}}function bn(t,e){if(1&t){const t=R.Xb();R.Wb(0,"button",83),R.ic("click",(function(e){return R.Ic(t),R.mc(5).openContractsAddingModal()})),R.Wb(1,"span",13),R.Tc(2," CURRENCY_PAYMENT.CONTRACTS.ADD_NEW "),R.Vb(),R.Vb()}}function un(t,e){if(1&t&&(R.Wb(0,"div",81),R.Rc(1,bn,3,0,"button",82),R.Wb(2,"h6",13),R.Tc(3,"CURRENCY_PAYMENT.CONTRACTS.TITLE"),R.Vb(),R.Vb()),2&t){const t=R.mc(4);R.Ab(1),R.uc("ngIf",t.filteredContracts.length>0)}}function mn(t,e){if(1&t&&R.Rc(0,un,4,1,"div",80),2&t){const t=e.searchTerm,n=R.mc(3);R.uc("ngIf",!t&&!n.isContractsLoading)}}function dn(t,e){if(1&t&&(R.Wb(0,"div",84),R.Wb(1,"div",85),R.Wb(2,"span"),R.Tc(3),R.Vb(),R.Rb(4,"j-money",86),R.Vb(),R.Wb(5,"div",87),R.Wb(6,"span"),R.Tc(7),R.Vb(),R.Wb(8,"div"),R.Rb(9,"span",88),R.Tc(10,"\xa0 "),R.Rb(11,"j-money",86),R.Vb(),R.Vb(),R.Vb()),2&t){const t=e.item;R.Ab(3),R.Uc(t.contractor.name),R.Ab(1),R.uc("money",t.amount),R.Ab(3),R.Uc(t.contractNumber),R.Ab(4),R.uc("money",t.remainder)}}function pn(t,e){if(1&t){const t=R.Xb();R.Ub(0),R.Wb(1,"div",89),R.Rb(2,"img",90),R.Rb(3,"div",91),R.nc(4,"translate"),R.Wb(5,"a",92),R.ic("click",(function(e){return R.Ic(t),R.mc(4).openContractsAddingModal(e)})),R.Tc(6),R.nc(7,"translate"),R.Vb(),R.Vb(),R.Tb()}2&t&&(R.Ab(3),R.uc("innerHTML",R.oc(4,2,"CURRENCY_PAYMENT.CONTRACTS.EMPTY_STATE"),R.Jc),R.Ab(3),R.Vc(" ",R.oc(7,4,"CURRENCY_PAYMENT.CONTRACTS.ADD_NEW")," "))}function hn(t,e){if(1&t){const t=R.Xb();R.Ub(0),R.Rb(1,"j-empty-placeholder",93),R.Wb(2,"div",94),R.Wb(3,"a",95),R.ic("click",(function(e){return R.Ic(t),R.mc(4).openContractsAddingModal(e)})),R.Tc(4),R.nc(5,"translate"),R.Vb(),R.Vb(),R.Tb()}2&t&&(R.Ab(4),R.Vc(" ",R.oc(5,1,"CURRENCY_PAYMENT.CONTRACTS.ADD_NEW")," "))}function fn(t,e){if(1&t&&(R.Rc(0,pn,8,6,"ng-container",1),R.Rc(1,hn,6,3,"ng-container",1)),2&t){const t=R.mc(3);R.uc("ngIf",0==t.contracts.length),R.Ab(1),R.uc("ngIf",t.contracts.length>0)}}function gn(t,e){if(1&t&&R.Tc(0),2&t){const t=e.item,n=R.mc(3);R.Vc(" ",n.mapContractLabel(t||n.form.controls.contract.value)," ")}}function An(t,e){if(1&t){const t=R.Xb();R.Wb(0,"a",96),R.ic("click",(function(e){return R.Ic(t),R.mc(3).showContractDetails(e)})),R.Tc(1,"CURRENCY_PAYMENT.CONTRACTS.SHOW_DETAILS"),R.Vb()}}function Tn(t,e){if(1&t){const t=R.Xb();R.Ub(0),R.Wb(1,"div",74),R.Wb(2,"j-form-field",null,75),R.Wb(4,"j-label",13),R.Tc(5,"CURRENCY_PAYMENT.RECIPIENT.CONTRACT"),R.Vb(),R.Wb(6,"j-select",76,77),R.ic("change",(function(e){return R.Ic(t),R.mc(2).onContractSelect(e)})),R.Rc(8,mn,1,1,"ng-template",39),R.Rc(9,dn,12,4,"ng-template",26),R.Rc(10,fn,2,2,"ng-template",78),R.Rc(11,gn,1,1,"ng-template",27),R.Vb(),R.Rc(12,An,2,0,"a",79),R.Rb(13,"j-error",28),R.Vb(),R.Vb(),R.Tb()}if(2&t){const t=R.Fc(3),e=R.Fc(7),n=R.mc(2);R.Ab(6),R.uc("loading",n.isContractsLoading)("appendTo",t.elementRef.nativeElement)("jFocusOnReturn",e)("formControl",n.form.controls.contractId)("clearable",!1)("searchFn",n.contractComparator)("items",n.filteredContracts),R.Ab(6),R.uc("ngIf",n.isContractSelected),R.Ab(1),R.uc("control",n.form.controls.contractId)("errorMessages",n.errors.contractId)}}function yn(t,e){if(1&t){const t=R.Xb();R.Wb(0,"button",97),R.ic("click",(function(e){return R.Ic(t),R.mc(2).openForeignContractsRecipientsDictionary()})),R.Vb()}}function Rn(t,e){if(1&t){const t=R.Xb();R.Wb(0,"button",98),R.ic("click",(function(e){return R.Ic(t),R.mc(2).openForeignRecipientsDictionary()})),R.Vb()}}function vn(t,e){if(1&t&&(R.Wb(0,"div",99),R.Tc(1),R.Vb()),2&t){const t=e.item,n=R.mc(2);R.Ab(1),R.Vc(" ",n.mapCountryLabel(t)," ")}}function Cn(t,e){if(1&t&&R.Tc(0),2&t){const t=e.item;R.mc();const n=R.Fc(33),o=R.mc();R.Vc(" ",n.focused?"":o.mapCountryLabel(t)," ")}}function En(t,e){if(1&t&&(R.Wb(0,"div",20),R.Wb(1,"j-form-field"),R.Wb(2,"j-label"),R.Tc(3),R.nc(4,"translate"),R.nc(5,"async"),R.Vb(),R.Rb(6,"input",100),R.Rb(7,"j-error",28),R.Vb(),R.Vb()),2&t){const t=R.mc(2);R.Ab(3),R.Uc(R.oc(4,7,R.oc(5,9,t.cityPlaceholder$))),R.Ab(3),R.uc("mask",t.masks.cityName.mask)("dropSpecialCharacters",!1)("maxlength",t.cityMaxLength)("formControl",t.form.controls.cityName),R.Ab(1),R.uc("control",t.form.controls.cityName)("errorMessages",t.errors.purpose)}}function Sn(t,e){if(1&t&&(R.Ub(0),R.Wb(1,"div",101),R.Wb(2,"div",20),R.Wb(3,"j-form-field"),R.Wb(4,"j-label",13),R.Tc(5,"CURRENCY_PAYMENT.AUD.INDEX"),R.Vb(),R.Rb(6,"input",102),R.Vb(),R.Vb(),R.Wb(7,"div",20),R.Wb(8,"j-form-field"),R.Wb(9,"j-label",13),R.Tc(10,"CURRENCY_PAYMENT.AUD.STATE"),R.Vb(),R.Rb(11,"input",103),R.Vb(),R.Vb(),R.Vb(),R.Wb(12,"div",101),R.Wb(13,"div",20),R.Wb(14,"j-form-field"),R.Wb(15,"j-label",13),R.Tc(16,"CURRENCY_PAYMENT.AUD.BUILDING_NUMBER"),R.Vb(),R.Rb(17,"input",104),R.Vb(),R.Vb(),R.Wb(18,"div",20),R.Wb(19,"j-form-field"),R.Wb(20,"j-label",13),R.Tc(21,"CURRENCY_PAYMENT.AUD.STREET"),R.Vb(),R.Rb(22,"input",105),R.Vb(),R.Vb(),R.Vb(),R.Rb(23,"hr",106),R.Tb()),2&t){const t=R.mc(2);R.Ab(6),R.uc("formControl",t.form.controls.audIndex),R.Ab(5),R.uc("formControl",t.form.controls.audState),R.Ab(6),R.uc("formControl",t.form.controls.audBuildingNumber),R.Ab(5),R.uc("formControl",t.form.controls.audStreet)}}function Vn(t,e){if(1&t&&(R.Ub(0),R.Wb(1,"div",20),R.Wb(2,"j-form-field"),R.Wb(3,"j-label",13),R.Tc(4,"CURRENCY_PAYMENT.AUD.ADDRESS"),R.Vb(),R.Rb(5,"input",107),R.Vb(),R.Vb(),R.Tb()),2&t){const t=R.mc(2);R.Ab(5),R.uc("formControl",t.form.controls.audAddress)}}function Nn(t,e){if(1&t&&(R.Ub(0),R.Wb(1,"div",20),R.Wb(2,"j-form-field"),R.Wb(3,"j-label",13),R.Tc(4,"CURRENCY_PAYMENT.AUD.ADDRESS"),R.Vb(),R.Rb(5,"input",107),R.Vb(),R.Vb(),R.Tb()),2&t){const t=R.mc(2);R.Ab(5),R.uc("formControl",t.form.controls.canAddress)}}function In(t,e){if(1&t&&(R.Ub(0),R.Wb(1,"div",20),R.Rb(2,"j-foreign-bank-select",108,109),R.Vb(),R.Wb(4,"div",20),R.Wb(5,"j-form-field",21),R.Wb(6,"j-label",13),R.Tc(7,"CURRENCY_PAYMENT.RECIPIENT.CORRESPONDENT_IBAN"),R.Vb(),R.Rb(8,"input",110,111),R.Rb(10,"j-error",28),R.Vb(),R.Vb(),R.Tb()),2&t){const t=R.mc(2);R.Ab(2),R.uc("labelText","CURRENCY_PAYMENT.RECIPIENT.CORRESPONDENT_BIC")("placeholderText","CURRENCY_PAYMENT.RECIPIENT.NO_CORRESPONDENT_BIC_ENTERED")("labelControl",t.form.controls.rubNonRussiaCorrespondentBankLabel)("errorMessages",t.errors.bankSelect)("bankControl",t.form.controls.rubNonRussiaCorrespondentBank),R.Ab(6),R.uc("validation",!1)("mask",t.masks.rubNonRussiaCorrespondentIban.mask)("formControl",t.form.controls.rubNonRussiaCorrespondentIban),R.Ab(2),R.uc("control",t.form.controls.rubNonRussiaCorrespondentIban)("errorMessages",t.errors.bankAccount)}}function kn(t,e){if(1&t&&(R.Wb(0,"div",20),R.Wb(1,"j-form-field",21),R.Wb(2,"j-label",13),R.Tc(3,"CURRENCY_PAYMENT.RECIPIENT.KBE"),R.Vb(),R.Rb(4,"input",112),R.Rb(5,"a",113),R.Rb(6,"j-error",28),R.Vb(),R.Vb()),2&t){R.mc();const t=R.Fc(148),e=R.mc();R.Ab(4),R.uc("mask",e.masks.kbeCode.mask)("jShadow",e.masks.kbeCode.shadow)("dropSpecialCharacters",!0)("formControl",e.form.controls.kbeCode),R.Ab(1),R.uc("ngbTooltip",t)("inlineSVG","/assets/icons/payments/question.svg"),R.Ab(1),R.uc("control",e.form.controls.kbeCode)("errorMessages",e.errors.kbeCode)}}function On(t,e){if(1&t&&(R.Ub(0),R.Wb(1,"div",20),R.Rb(2,"j-foreign-bank-select",108,114),R.Vb(),R.Wb(4,"div",20),R.Wb(5,"j-form-field"),R.Wb(6,"j-label"),R.Tc(7),R.nc(8,"translate"),R.nc(9,"async"),R.Vb(),R.Rb(10,"input",100),R.Vb(),R.Vb(),R.Tb()),2&t){const t=R.mc(2);R.Ab(2),R.uc("labelText","CURRENCY_PAYMENT.RECIPIENT.BANK")("placeholderText","CURRENCY_PAYMENT.RECIPIENT.NO_BIC_ENTERED")("labelControl",t.form.controls.rubNonRussiaBankLabel)("errorMessages",t.errors.bankSelect)("bankControl",t.form.controls.rubNonRussiaBank),R.Ab(5),R.Uc(R.oc(8,10,R.oc(9,12,t.cityPlaceholder$))),R.Ab(3),R.uc("mask",t.masks.cityName.mask)("dropSpecialCharacters",!1)("maxlength",t.cityMaxLength)("formControl",t.form.controls.cityName)}}function jn(t,e){1&t&&(R.Wb(0,"div",45),R.Tc(1," CURRENCY_PAYMENT.RECIPIENT.BIC_DESCRIPTION "),R.Vb())}function Wn(t,e){if(1&t&&(R.Ub(0),R.Wb(1,"div",20),R.Rb(2,"j-foreign-bank-select",115,116),R.Rc(4,jn,2,0,"div",117),R.Vb(),R.Tb()),2&t){const t=R.mc(2);R.Ab(2),R.uc("placeholderText","CURRENCY_PAYMENT.RECIPIENT.NO_BIC_ENTERED")("labelControl",t.form.controls.bankLabel)("errorMessages",t.errors.bankSelect)("bankControl",t.form.controls.bank),R.Ab(2),R.uc("ngIf",!t.isBicRequired)}}function Mn(t,e){if(1&t&&R.Rb(0,"j-foreign-bank-select",121,122),2&t){const t=R.mc(3);R.uc("placeholderText","CURRENCY_PAYMENT.RECIPIENT.NO_INTERMEDIARY_BIC_ENTERED")("labelControl",t.form.controls.intermediaryBankLabel)("bankControl",t.form.controls.intermediaryBank)("errorMessages",t.errors.bankSelect)}}function Pn(t,e){if(1&t&&(R.Wb(0,"div",10),R.Rb(1,"j-switch",11),R.Wb(2,"div",118),R.Wb(3,"strong",13),R.Tc(4,"CURRENCY_PAYMENT.RECIPIENT.SWITCH.TITLE"),R.Vb(),R.Rc(5,Mn,2,4,"j-foreign-bank-select",119),R.Wb(6,"small",120),R.Tc(7,"CURRENCY_PAYMENT.RECIPIENT.SWITCH.DESCRIPTION"),R.Vb(),R.Vb(),R.Vb()),2&t){const t=R.mc(2);R.Ab(1),R.uc("formControl",t.form.controls.hasIntermediaryBank),R.Ab(4),R.uc("ngIf",t.hasIntermediaryBank)}}function xn(t,e){if(1&t&&(R.Wb(0,"div",20),R.Wb(1,"j-form-field",21),R.Wb(2,"j-label",13),R.Tc(3,"CURRENCY_PAYMENT.RECIPIENT.KIO"),R.Vb(),R.Rb(4,"input",123),R.Rb(5,"j-error",28),R.Vb(),R.Vb()),2&t){const t=R.mc(2);R.Ab(4),R.uc("mask",t.masks.kio.mask)("dropSpecialCharacters",!1)("formControl",t.form.controls.kio),R.Ab(1),R.uc("control",t.form.controls.kio)("errorMessages",t.errors.kio)}}function _n(t,e){if(1&t&&(R.Wb(0,"div",20),R.Wb(1,"j-form-field",21),R.Wb(2,"j-label",13),R.Tc(3,"CURRENCY_PAYMENT.RECIPIENT.KPP"),R.Vb(),R.Rb(4,"input",124),R.Rb(5,"a",113),R.Vb(),R.Wb(6,"div",45),R.Tc(7," CURRENCY_PAYMENT.RECIPIENT.KPP_DESCRIPTION "),R.Vb(),R.Vb()),2&t){R.mc();const t=R.Fc(150),e=R.mc();R.Ab(4),R.uc("mask",e.masks.kpp.mask)("jShadow",e.masks.kpp.shadow)("validation",!1)("formControl",e.form.controls.kpp),R.Ab(1),R.uc("ngbTooltip",t)("inlineSVG","/assets/icons/payments/question.svg")}}function Dn(t,e){if(1&t&&(R.Wb(0,"div",130),R.Wb(1,"j-form-field",21),R.Wb(2,"j-label",13),R.Tc(3,"CURRENCY_PAYMENT.RUSSIAN_BUDGET.KIO"),R.Vb(),R.Rb(4,"input",142),R.Rb(5,"j-error",28),R.Vb(),R.Wb(6,"j-form-field",21),R.Wb(7,"j-label",13),R.Tc(8,"CURRENCY_PAYMENT.RUSSIAN_BUDGET.KPP"),R.Vb(),R.Rb(9,"input",135),R.Rb(10,"a",113),R.Vb(),R.Vb()),2&t){R.mc(2);const t=R.Fc(150),e=R.mc();R.Ab(4),R.uc("formControl",e.form.controls.payerInn),R.Ab(1),R.uc("control",e.form.controls.payerInn)("errorMessages",e.errors.payerInn),R.Ab(4),R.uc("mask",e.masks.kpp.mask)("jShadow",e.masks.kpp.shadow)("formControl",e.form.controls.payerKpp),R.Ab(1),R.uc("ngbTooltip",t)("inlineSVG","/assets/icons/payments/question.svg")}}function wn(t,e){if(1&t&&(R.Wb(0,"div",84),R.Wb(1,"strong"),R.Tc(2),R.Vb(),R.Wb(3,"span"),R.Tc(4," - "),R.Vb(),R.Wb(5,"span"),R.Tc(6),R.Vb(),R.Vb()),2&t){const t=e.item;R.Ab(2),R.Uc(t.code),R.Ab(4),R.Uc(t.description)}}function Yn(t,e){1&t&&R.Rb(0,"j-empty-placeholder",143)}function Un(t,e){if(1&t&&R.Tc(0),2&t){const t=e.item;R.mc();const n=R.Fc(17);R.Vc(" ",n.focused?"":t.code+" - "+t.description," ")}}function Ln(t,e){if(1&t&&(R.Wb(0,"div",84),R.Wb(1,"strong"),R.Tc(2),R.Vb(),R.Wb(3,"span"),R.Tc(4," - "),R.Vb(),R.Wb(5,"span"),R.Tc(6),R.Vb(),R.Vb()),2&t){const t=e.item;R.Ab(2),R.Uc(t.code),R.Ab(4),R.Uc(t.description)}}function Fn(t,e){1&t&&R.Rb(0,"j-empty-placeholder",144)}function $n(t,e){if(1&t&&R.Tc(0),2&t){const t=e.item;R.mc();const n=R.Fc(32);R.Vc(" ",n.focused?"":t.code+" - "+t.description," ")}}function Bn(t,e){if(1&t&&(R.Ub(0),R.Wb(1,"div",20),R.Wb(2,"j-form-field",21),R.Wb(3,"j-label",13),R.Tc(4,"CURRENCY_PAYMENT.RUSSIAN_BUDGET.PURPOSE"),R.Vb(),R.Rb(5,"input",135),R.Rb(6,"a",113),R.Vb(),R.Vb(),R.Wb(7,"div",20),R.Wb(8,"j-form-field",21),R.Wb(9,"j-label",13),R.Tc(10,"CURRENCY_PAYMENT.RUSSIAN_BUDGET.TAX_NUMBER"),R.Vb(),R.Rb(11,"input",135),R.Vb(),R.Vb(),R.Wb(12,"div",130),R.Wb(13,"div"),R.Wb(14,"j-form-field",21),R.Wb(15,"j-label",13),R.Tc(16,"CURRENCY_PAYMENT.RUSSIAN_BUDGET.PERIOD"),R.Vb(),R.Rb(17,"input",145),R.Rb(18,"a",113),R.Vb(),R.Wb(19,"div",45),R.Tc(20,"CURRENCY_PAYMENT.RUSSIAN_BUDGET.PERIOD_DESCRIPTION "),R.Vb(),R.Vb(),R.Wb(21,"j-form-field",21),R.Wb(22,"j-label",13),R.Tc(23,"CURRENCY_PAYMENT.RUSSIAN_BUDGET.UIP"),R.Vb(),R.Rb(24,"input",146),R.Vb(),R.Vb(),R.Tb()),2&t){R.mc(2);const t=R.Fc(154),e=R.Fc(156),n=R.mc();R.Ab(5),R.uc("mask",n.masks.paymentBasis.mask)("jShadow",n.masks.paymentBasis.shadow)("formControl",n.form.controls.paymentBasis),R.Ab(1),R.uc("ngbTooltip",t)("inlineSVG","/assets/icons/payments/question.svg"),R.Ab(5),R.uc("mask",n.masks.budgetDocNumber.mask)("jShadow",n.masks.budgetDocNumber.shadow)("formControl",n.form.controls.budgetDocNumber),R.Ab(6),R.uc("mask",n.masks.budgetPeriod.mask)("jShadow",n.masks.budgetPeriod.shadow)("dropSpecialCharacters",!1)("formControl",n.form.controls.budgetPeriod),R.Ab(1),R.uc("ngbTooltip",e)("inlineSVG","/assets/icons/payments/question.svg"),R.Ab(6),R.uc("formControl",n.form.controls.uip)}}function Kn(t,e){if(1&t&&(R.Ub(0),R.Wb(1,"fieldset",15),R.Wb(2,"h5",7),R.Tc(3,"CURRENCY_PAYMENT.RUSSIAN_BUDGET.TITLE"),R.Vb(),R.Wb(4,"div",20),R.Wb(5,"div",125),R.Rb(6,"input",126),R.Wb(7,"label",127),R.Rb(8,"span",128),R.Vb(),R.Vb(),R.Vb(),R.Rc(9,Dn,11,8,"div",129),R.Wb(10,"div",130,131),R.Wb(12,"j-form-field",null,132),R.Wb(14,"j-label",13),R.Tc(15,"CURRENCY_PAYMENT.RUSSIAN_BUDGET.KBK"),R.Vb(),R.Wb(16,"j-select",133,134),R.Rc(18,wn,7,2,"ng-template",26),R.Rc(19,Yn,1,0,"ng-template",78),R.Rc(20,Un,1,1,"ng-template",27),R.Vb(),R.Vb(),R.Wb(21,"j-form-field",21),R.Wb(22,"j-label",13),R.Tc(23,"CURRENCY_PAYMENT.RUSSIAN_BUDGET.OKTMO"),R.Vb(),R.Rb(24,"input",135),R.Rb(25,"a",113),R.Vb(),R.Vb(),R.Wb(26,"div",20),R.Wb(27,"j-form-field",null,136),R.Wb(29,"j-label",13),R.Tc(30,"CURRENCY_PAYMENT.RUSSIAN_BUDGET.PAYER_STATUS"),R.Vb(),R.Wb(31,"j-select",137,138),R.Rc(33,Ln,7,2,"ng-template",26),R.Rc(34,Fn,1,0,"ng-template",78),R.Rc(35,$n,1,1,"ng-template",27),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Wb(36,"fieldset",15),R.Wb(37,"div",20),R.Wb(38,"div",125),R.Rb(39,"input",139),R.Wb(40,"label",140),R.Rb(41,"span",141),R.Vb(),R.Vb(),R.Vb(),R.Rc(42,Bn,25,15,"ng-container",1),R.Vb(),R.Tb()),2&t){const t=R.Fc(11),e=R.Fc(17),n=R.Fc(28),o=R.Fc(32);R.mc();const i=R.Fc(152),s=R.mc();R.Ab(6),R.uc("formControl",s.form.controls.isRussianTaxPayer),R.Ab(3),R.uc("ngIf",s.isRussianTaxpayer),R.Ab(7),R.uc("loading",s.isKbkLoading)("appendTo",t)("jFocusOnReturn",e)("formControl",s.form.controls.kbk)("clearable",!1)("searchFn",s.kbkComparator)("items",s.kbkList),R.Ab(8),R.uc("mask",s.masks.oktmo.mask)("jShadow",s.masks.oktmo.shadow)("formControl",s.form.controls.oktmo),R.Ab(1),R.uc("ngbTooltip",i)("inlineSVG","/assets/icons/payments/question.svg"),R.Ab(6),R.uc("loading",s.isStatusesLoading)("appendTo",n.elementRef.nativeElement)("jFocusOnReturn",o)("formControl",s.form.controls.payerStatus)("clearable",!1)("searchFn",s.statusComparator)("items",s.statuses),R.Ab(8),R.uc("formControl",s.form.controls.hasRussianBudgetExtras),R.Ab(3),R.uc("ngIf",s.hasRussianBudgetExtras)}}function Hn(t,e){if(1&t){const t=R.Xb();R.Wb(0,"div"),R.Wb(1,"button",83),R.ic("click",(function(e){R.Ic(t),R.mc(2);const n=R.Fc(89);return R.mc().openKnpDictionary(n,e)})),R.Rb(2,"span",147),R.Wb(3,"span",13),R.Tc(4," CURRENCY_PAYMENT.DETAILS.KNP.DICTIONARY "),R.Vb(),R.Vb(),R.Wb(5,"p",148),R.Tc(6,"CURRENCY_PAYMENT.DETAILS.KNP.FREQUENT"),R.Vb(),R.Wb(7,"p",149),R.Tc(8,"CURRENCY_PAYMENT.DETAILS.KNP.DESCRIPTION"),R.Vb(),R.Vb()}2&t&&(R.Ab(2),R.uc("inlineSVG","/assets/icons/payments/list.svg"))}function Qn(t,e){1&t&&R.Rc(0,Hn,9,1,"div",1),2&t&&R.uc("ngIf",!e.searchTerm)}function Gn(t,e){if(1&t&&(R.Wb(0,"div",20),R.Wb(1,"j-form-field"),R.Wb(2,"j-label",13),R.Tc(3,"CURRENCY_PAYMENT.DETAILS.KVO"),R.Vb(),R.Rb(4,"input",33),R.Vb(),R.Vb()),2&t){const t=R.mc(2);R.Ab(4),R.uc("mask",t.masks.kvo.mask)("formControl",t.form.controls.kvo)}}function qn(t,e){if(1&t&&(R.Wb(0,"div",84),R.Tc(1),R.Vb()),2&t){const t=e.item,n=R.mc(3);R.Ab(1),R.Vc(" ",n.mapCodeWordLabel(t)," ")}}function Xn(t,e){if(1&t&&R.Tc(0),2&t){const t=e.item;R.mc();const n=R.Fc(8),o=R.mc(2);R.Vc(" ",n.focused?"":o.mapCodeWordLabel(t||(null==o.form.controls.codeWord?null:o.form.controls.codeWord.value))," ")}}function zn(t,e){if(1&t&&(R.Wb(0,"div",20),R.Wb(1,"j-form-field",null,150),R.Wb(3,"j-label"),R.Tc(4),R.nc(5,"translate"),R.nc(6,"async"),R.Vb(),R.Wb(7,"j-select",133,151),R.Rc(9,qn,2,1,"ng-template",26),R.Rc(10,Xn,1,1,"ng-template",27),R.Vb(),R.Vb(),R.Vb()),2&t){const t=R.Fc(2),e=R.Fc(8),n=R.mc(2);R.Ab(4),R.Uc(R.oc(5,8,R.oc(6,10,n.codeWordLabel$))),R.Ab(3),R.uc("loading",n.isCodeWordsLoading)("appendTo",t.elementRef.nativeElement)("jFocusOnReturn",e)("formControl",n.form.controls.codeWord)("clearable",!1)("searchFn",n.codeWordComparator)("items",n.codeWords)}}function Jn(t,e){if(1&t&&(R.Wb(0,"div",152),R.Wb(1,"div",153),R.Tc(2),R.Vb(),R.Vb()),2&t){const t=e.ngIf;R.Ab(2),R.Vc(" ",t," ")}}function Zn(t,e){if(1&t&&(R.Wb(0,"div",154),R.Rb(1,"span",155),R.nc(2,"async"),R.Vb()),2&t){const t=R.mc(2);R.Ab(1),R.uc("innerHTML",R.oc(2,1,t.comissionMessage),R.Jc)}}function to(t,e){if(1&t&&(R.Wb(0,"div",156),R.Rb(1,"span",155),R.nc(2,"async"),R.Vb()),2&t){const t=R.mc(2);R.Ab(1),R.uc("innerHTML",R.oc(2,1,t.amountMessage),R.Jc)}}const eo=function(t){return{amount:t}};function no(t,e){if(1&t){const t=R.Xb();R.Wb(0,"div",156),R.Rb(1,"span",157),R.nc(2,"money"),R.Wb(3,"a",158),R.ic("click",(function(e){return R.Ic(t),R.mc(2).scrollToContracts(e)})),R.Tc(4),R.nc(5,"translate"),R.Vb(),R.Vb()}if(2&t){const t=R.mc(2);R.Ab(1),R.uc("translate","ERRORS.CURRENCY_PAYMENT.MUST_INCLUDE_CONTRACT")("translateParams",R.zc(7,eo,R.oc(2,3,t.contractMaxAmount))),R.Ab(3),R.Uc(R.oc(5,5,"ERRORS.CURRENCY_PAYMENT.MUST_INCLUDE_CONTRACT_LINK"))}}function oo(t,e){if(1&t&&(R.Wb(0,"div",156),R.Rb(1,"span",155),R.Vb()),2&t){const t=R.mc(2);R.Ab(1),R.uc("innerHTML",t.comissionMessage,R.Jc)}}function io(t,e){1&t&&(R.Ub(0),R.Tc(1),R.nc(2,"translate"),R.Tb()),2&t&&(R.Ab(1),R.Vc(" ",R.oc(2,1,"PAYMENTS.COMMISSION_CALC_AUTO")," "))}function so(t,e){if(1&t&&(R.Tc(0),R.nc(1,"translate"),R.Rb(2,"j-money",86)),2&t){const t=R.mc(2);R.Vc(" ",R.oc(1,2,"PAYMENTS.COMMISSION"),": "),R.Ab(2),R.uc("money",t.commissionBalance)}}function co(t,e){1&t&&R.Rb(0,"div",159)}function ao(t,e){if(1&t&&(R.Wb(0,"li",59),R.Rb(1,"j-switch",11),R.Wb(2,"span",12),R.Wb(3,"strong",13),R.Tc(4,"CURRENCY_PAYMENT.AGENT.TITLE"),R.Vb(),R.Rb(5,"br"),R.Wb(6,"small",160),R.Tc(7,"CURRENCY_PAYMENT.AGENT.DESCRIPTION"),R.Vb(),R.Vb(),R.Vb()),2&t){const t=R.mc(2);R.Ab(1),R.uc("formControl",t.form.controls.payComission)}}function ro(t,e){1&t&&(R.Wb(0,"div"),R.Wb(1,"small",161),R.Tc(2),R.nc(3,"translate"),R.Vb(),R.Vb()),2&t&&(R.Ab(2),R.Uc(R.oc(3,1,"PAYMENTS.NOTIFY.DESCRIPTION")))}function lo(t,e){if(1&t){const t=R.Xb();R.Wb(0,"div",162),R.Wb(1,"j-form-field"),R.Wb(2,"j-label"),R.Tc(3),R.nc(4,"translate"),R.Vb(),R.Wb(5,"input",163,164),R.ic("focus",(function(e){return R.Ic(t),R.mc(2).onEmailOnSuccessFocus(e)})),R.Vb(),R.Rb(7,"j-error",28),R.Vb(),R.Wb(8,"small",161),R.Tc(9),R.nc(10,"translate"),R.Vb(),R.Vb()}if(2&t){const t=R.mc(2);R.Ab(3),R.Uc(R.oc(4,6,"PAYMENTS.NOTIFY.EMAIL")),R.Ab(2),R.uc("ngbTypeahead",t.search)("formControl",t.form.controls.emailOnSuccess),R.Ab(2),R.uc("control",t.form.controls.emailOnSuccess)("errorMessages",t.errors.email),R.Ab(2),R.Uc(R.oc(10,8,"PAYMENTS.NOTIFY.EMAIL"))}}function bo(t,e){if(1&t&&(R.Rb(0,"p",165),R.nc(1,"translate")),2&t){const t=R.mc(2);R.uc("innerHTML",R.oc(1,1,t.agreementText),R.Jc)}}function uo(t,e){if(1&t){const t=R.Xb();R.Ub(0),R.Wb(1,"button",166),R.ic("click",(function(e){return R.Ic(t),R.mc(2).saveToDraft()})),R.Wb(2,"strong",13),R.Tc(3,"SHARED.SAVE"),R.Vb(),R.Vb(),R.Wb(4,"button",167),R.Tc(5),R.nc(6,"translate"),R.Vb(),R.Tb()}if(2&t){const t=R.mc(2);R.Ab(5),R.Vc("",R.oc(6,1,t.submitLabel)," ")}}function mo(t,e){1&t&&(R.Ub(0),R.Wb(1,"button",168),R.Tc(2,"SHARED.SAVE_EDITING"),R.Vb(),R.Tb())}function po(t,e){if(1&t&&R.Rb(0,"j-fx-contract-details",169,170),2&t){const t=R.mc(2);R.uc("contract",t.form.controls.contract.value)}}function ho(t,e){}function fo(t,e){1&t&&R.Rb(0,"j-kbe-info")}function go(t,e){1&t&&(R.Rb(0,"div",171),R.nc(1,"translate")),2&t&&R.uc("innerHTML",R.oc(1,1,"PAYMENTS.KPP"),R.Jc)}function Ao(t,e){1&t&&(R.Rb(0,"div",171),R.nc(1,"translate")),2&t&&R.uc("innerHTML",R.oc(1,1,"PAYMENTS.OKTMO"),R.Jc)}function To(t,e){1&t&&(R.Rb(0,"div",171),R.nc(1,"translate")),2&t&&R.uc("innerHTML",R.oc(1,1,"PAYMENTS.BASIS"),R.Jc)}function yo(t,e){1&t&&(R.Rb(0,"div",171),R.nc(1,"translate")),2&t&&R.uc("innerHTML",R.oc(1,1,"PAYMENTS.BUDGET"),R.Jc)}function Ro(t,e){if(1&t){const t=R.Xb();R.Ub(0),R.Wb(1,"div",3),R.Wb(2,"form",4,5),R.ic("submit",(function(e){return R.Ic(t),R.mc().onSubmit(e)})),R.Wb(4,"fieldset",6),R.Wb(5,"h5",7),R.Tc(6,"CURRENCY_PAYMENT.DEBIT_ACCOUNT"),R.Vb(),R.Wb(7,"j-account-dropdown",8,9),R.ic("selected",(function(e){return R.Ic(t),R.mc().onSenderAccountSelect(e)})),R.Vb(),R.Wb(9,"div",10),R.Rb(10,"j-switch",11),R.Wb(11,"div",12),R.Wb(12,"strong",13),R.Tc(13,"CURRENCY_PAYMENT.CONTRACTS.SWITCH.TITLE"),R.Vb(),R.Rc(14,ln,3,8,"div",14),R.Vb(),R.Vb(),R.Rc(15,Tn,14,10,"ng-container",1),R.Vb(),R.Wb(16,"fieldset",15),R.Wb(17,"div",16),R.Wb(18,"h5",17),R.Tc(19,"CURRENCY_PAYMENT.RECIPIENT.TITLE"),R.Vb(),R.Rc(20,yn,1,0,"button",18),R.Rc(21,Rn,1,0,"button",19),R.Vb(),R.Wb(22,"div",20),R.Wb(23,"j-form-field",21),R.Wb(24,"j-label",13),R.Tc(25,"CURRENCY_PAYMENT.RECIPIENT.NAME"),R.Vb(),R.Wb(26,"input",22),R.ic("paste",(function(e){return R.Ic(t),R.mc().onNamePaste(e)})),R.Vb(),R.Vb(),R.Vb(),R.Wb(27,"div",20),R.Wb(28,"j-form-field",null,23),R.Wb(30,"j-label",13),R.Tc(31,"CURRENCY_PAYMENT.RECIPIENT.COUNTRY"),R.Vb(),R.Wb(32,"j-select",24,25),R.ic("change",(function(e){return R.Ic(t),R.mc().onCountrySelect(e)}))("focus",(function(e){return R.Ic(t),R.mc().onCountryFocus()}))("search",(function(e){return R.Ic(t),R.mc().onCountrySearch(e)})),R.nc(34,"async"),R.Rc(35,vn,2,1,"ng-template",26),R.Rc(36,Cn,1,1,"ng-template",27),R.Vb(),R.Rb(37,"j-error",28),R.Vb(),R.Vb(),R.Rc(38,En,8,11,"div",29),R.Rc(39,Sn,24,4,"ng-container",1),R.nc(40,"async"),R.Rc(41,Vn,6,1,"ng-container",1),R.nc(42,"async"),R.Rc(43,Nn,6,1,"ng-container",1),R.nc(44,"async"),R.Rc(45,In,11,10,"ng-container",1),R.nc(46,"async"),R.Wb(47,"div"),R.nc(48,"async"),R.Rc(49,kn,7,8,"div",29),R.Rc(50,On,11,14,"ng-container",1),R.nc(51,"async"),R.Wb(52,"div",20),R.Wb(53,"j-form-field",21),R.Wb(54,"j-label",13),R.Tc(55,"CURRENCY_PAYMENT.RECIPIENT.IBAN"),R.Vb(),R.Rb(56,"input",30,31),R.Rb(58,"j-error",28),R.Vb(),R.Vb(),R.Vb(),R.Rc(59,Wn,5,5,"ng-container",1),R.nc(60,"async"),R.Rc(61,Pn,8,2,"div",32),R.Rc(62,xn,6,5,"div",29),R.nc(63,"async"),R.Rc(64,_n,8,6,"div",29),R.nc(65,"async"),R.Vb(),R.Rc(66,Kn,43,23,"ng-container",1),R.nc(67,"async"),R.Wb(68,"fieldset",15),R.Wb(69,"h5",7),R.Tc(70,"CURRENCY_PAYMENT.DETAILS.TITLE"),R.Vb(),R.Wb(71,"div",20),R.Wb(72,"j-form-field"),R.Wb(73,"j-label",13),R.Tc(74,"CURRENCY_PAYMENT.DETAILS.DOCUMENT_NUMBER"),R.Vb(),R.Rb(75,"input",33),R.Vb(),R.Vb(),R.Wb(76,"div",20),R.Rb(77,"j-date-picker",34,35),R.nc(79,"async"),R.nc(80,"translate"),R.nc(81,"translate"),R.nc(82,"async"),R.Vb(),R.Wb(83,"div",20),R.Wb(84,"j-form-field",null,36),R.Wb(86,"j-label",13),R.Tc(87,"CURRENCY_PAYMENT.DETAILS.KNP.TITLE"),R.Vb(),R.Wb(88,"j-select",37,38),R.ic("change",(function(e){return R.Ic(t),R.mc().knpIsChanged()})),R.nc(90,"async"),R.Rc(91,Qn,1,1,"ng-template",39),R.Vb(),R.Vb(),R.Vb(),R.Rc(92,Gn,5,2,"div",29),R.nc(93,"async"),R.Rc(94,zn,11,12,"div",29),R.nc(95,"async"),R.Wb(96,"div",40),R.Wb(97,"span",41),R.Tc(98),R.nc(99,"async"),R.Vb(),R.Wb(100,"j-form-field"),R.Wb(101,"j-label",13),R.Tc(102,"CURRENCY_PAYMENT.DETAILS.PURPOSE"),R.Vb(),R.Rb(103,"textarea",42,43),R.Rb(105,"j-error",28),R.Rc(106,Jn,3,1,"div",44),R.nc(107,"async"),R.Vb(),R.Wb(108,"div",45),R.Tc(109," CURRENCY_PAYMENT.DETAILS.PURPOSE_DESCRIPTION "),R.Vb(),R.Vb(),R.Vb(),R.Wb(110,"fieldset",15),R.Wb(111,"div",46),R.Wb(112,"j-account-dropdown",47,48),R.ic("selected",(function(e){return R.Ic(t),R.mc().onCommissionAccountSelect(e)})),R.Vb(),R.Rc(114,Zn,3,3,"div",49),R.Vb(),R.Wb(115,"div",20),R.Wb(116,"j-form-field",50),R.Wb(117,"j-label",13),R.Tc(118,"CURRENCY_PAYMENT.AMOUNT.TITLE"),R.Vb(),R.Wb(119,"input",51),R.ic("paste",(function(e){return R.Ic(t),R.mc().onAmountPaste(e)})),R.Vb(),R.Vb(),R.Rc(120,to,3,3,"div",52),R.Rc(121,no,6,9,"div",52),R.Rc(122,oo,2,1,"div",52),R.Wb(123,"div",53),R.Rc(124,io,3,3,"ng-container",54),R.Rc(125,so,3,4,"ng-template",null,55,R.Sc),R.Rc(127,co,1,0,"div",56),R.Vb(),R.Vb(),R.Wb(128,"ul",57),R.Rc(129,ao,8,1,"li",58),R.Wb(130,"li",59),R.Rb(131,"j-switch",11),R.Wb(132,"div",60),R.Wb(133,"strong"),R.Tc(134),R.nc(135,"translate"),R.Vb(),R.Rb(136,"br"),R.Rc(137,ro,4,3,"div",1),R.Rc(138,lo,11,10,"div",61),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Rc(139,bo,2,3,"p",62),R.Wb(140,"div",63),R.Rc(141,uo,7,3,"ng-container",1),R.Rc(142,mo,3,0,"ng-container",1),R.Vb(),R.Rb(143,"ngx-spinner",64),R.Vb(),R.Vb(),R.Rc(144,po,2,1,"j-fx-contract-details",65),R.Rc(145,ho,0,0,"ng-template",null,66,R.Sc),R.Rc(147,fo,1,0,"ng-template",null,67,R.Sc),R.Rc(149,go,2,3,"ng-template",null,68,R.Sc),R.Rc(151,Ao,2,3,"ng-template",null,69,R.Sc),R.Rc(153,To,2,3,"ng-template",null,70,R.Sc),R.Rc(155,yo,2,3,"ng-template",null,71,R.Sc),R.Tb()}if(2&t){const t=R.Fc(29),e=R.Fc(33),n=R.Fc(78),o=R.Fc(85),i=R.Fc(89),s=R.Fc(126),c=R.mc();R.Ab(2),R.uc("formGroup",c.form),R.Ab(5),R.uc("isLoading",c.isAccountsLoading)("isDisabledSelectable",!0)("label","CURRENCY_PAYMENT.DEBIT_ACCOUNT")("hasError",c.form.controls.senderAccount.touched&&c.form.controls.senderAccount.errors)("accounts",c.senderAccountsList),R.Ab(3),R.uc("formControl",c.form.controls.withinContract),R.Ab(4),R.uc("ngIf",c.isContractsDescriptionShown),R.Ab(1),R.uc("ngIf",c.withinContract),R.Ab(5),R.uc("ngIf",c.withinContract&&(null==c.form.controls.contract?null:null==c.form.controls.contract.value?null:null==c.form.controls.contract.value.recipients?null:c.form.controls.contract.value.recipients.length)>1),R.Ab(1),R.uc("ngIf",!c.withinContract),R.Ab(5),R.uc("mask",c.masks.name.mask)("dropSpecialCharacters",!1)("maxlength",c.withinContract?null:c.nameMaxLength)("formControl",c.form.controls.name),R.Ab(6),R.uc("appendTo",t.elementRef.nativeElement)("jFocusOnReturn",e)("formControl",c.form.controls.countryCode)("readonly",c.form.controls.countryCode.disabled)("clearable",!1)("searchFn",c.countryComparator)("items",R.oc(34,102,c.countries$)),R.Ab(5),R.uc("control",c.form.controls.countryCode)("errorMessages",c.errors.country),R.Ab(1),R.uc("ngIf",c.isCityShown),R.Ab(1),R.uc("ngIf",R.oc(40,104,c.isAustraliaAud$)),R.Ab(2),R.uc("ngIf",R.oc(42,106,c.isAustraliaNonAud$)),R.Ab(2),R.uc("ngIf",R.oc(44,108,c.isCountryCanada$)),R.Ab(2),R.uc("ngIf",R.oc(46,110,c.isRubNonRussia$)),R.Ab(2),R.Hb("kbe-account-row",!(R.oc(48,112,c.isRubNonRussia$)||c.withinContract)),R.Ab(2),R.uc("ngIf",!c.withinContract),R.Ab(1),R.uc("ngIf",R.oc(51,114,c.isRubNonRussia$)),R.Ab(2),R.Hb("mb-3",c.withinContract),R.Ab(4),R.uc("mask",c.masks.bankAccount.mask)("formControl",c.form.controls.bankAccount),R.Ab(2),R.uc("control",c.form.controls.bankAccount)("errorMessages",c.errors.bankAccount),R.Ab(1),R.uc("ngIf",!R.oc(60,116,c.isRubNonRussia$)),R.Ab(2),R.uc("ngIf",c.isIntermediaryBankSwitchable),R.Ab(1),R.uc("ngIf",R.oc(63,118,c.isKioEnabled$)),R.Ab(2),R.uc("ngIf",R.oc(65,120,c.isKppEnabled$)),R.Ab(2),R.uc("ngIf",R.oc(67,122,c.isRussianBudget$)),R.Ab(9),R.uc("mask",c.masks.number.mask)("formControl",c.form.controls.number),R.Ab(2),R.uc("datesEnabled",R.oc(79,124,c.workingDays$))("formControl",c.form.controls.date)("formatValue",!0)("jFocusOnReturn",n)("label",R.oc(80,126,"CURRENCY_PAYMENT.DETAILS.VALUE_DATE"))("minDate",c.dateLimit.minDate)("maxDate",c.dateLimit.maxDate)("helperText",R.oc(81,128,R.oc(82,130,c.dateMessage$))),R.Ab(11),R.uc("jFocusOnReturn",i)("appendTo",o.elementRef.nativeElement)("formControl",c.form.controls.knp)("clearable",!1)("searchMask",c.masks.knp.mask)("shadow",c.masks.knp.shadow)("compareWith",c.knpComparator)("items",R.oc(90,132,c.knp$)),R.Ab(4),R.uc("ngIf",R.oc(93,134,c.isKvoEnabled$)),R.Ab(2),R.uc("ngIf",R.oc(95,136,c.isCodeWordEnabled$)),R.Ab(4),R.Wc(" ",R.oc(99,138,c.purposeLength$),"/",c.rules.purposeLength,""),R.Ab(5),R.uc("formControl",c.form.controls.purpose)("mask",c.masks.purpose.mask)("dropSpecialCharacters",!1),R.Ab(2),R.uc("control",c.form.controls.purpose)("errorMessages",c.errors.purpose),R.Ab(1),R.uc("ngIf",R.oc(107,140,c.purposeMessage$)),R.Ab(5),R.uc("hidden",!c.isCommissionAccountSelectable),R.Ab(1),R.uc("isLoading",c.isAccountsLoading)("accounts",c.commissionAccountsList)("isDisabledSelectable",!0)("hasError",c.form.controls.commissionAccount.touched&&c.form.controls.commissionAccount.errors)("label","CURRENCY_PAYMENT.COMISSION.ACCOUNT"),R.Ab(2),R.uc("ngIf",c.comissionMessage),R.Ab(2),R.uc("floatLabel","always"),R.Ab(3),R.uc("suffix",c.amountSuffix)("placeholder",c.amountPlaceholder)("mask",c.amountMask)("dropSpecialCharacters",!0)("formControl",c.form.controls.amount),R.Ab(1),R.uc("ngIf",c.amountMessage),R.Ab(1),R.uc("ngIf",c.shouldBindContract),R.Ab(1),R.uc("ngIf",c.comissionMessage&&!c.isCommissionAccountSelectable),R.Ab(2),R.uc("ngIf",null===c.commissionBalance)("ngIfElse",s),R.Ab(3),R.uc("ngIf",0==c.isOurComission),R.Ab(2),R.uc("ngIf",c.canPayCommission),R.Ab(2),R.uc("formControl",c.form.controls.notify),R.Ab(3),R.Uc(R.oc(135,142,"PAYMENTS.NOTIFY.TITLE")),R.Ab(3),R.uc("ngIf",!c.form.controls.notify.value),R.Ab(1),R.uc("ngIf",c.form.controls.notify.value),R.Ab(1),R.uc("ngIf",c.isContractsAgreementShown),R.Ab(2),R.uc("ngIf",c.restoredData.status!==c.PAYMENT_STATUS.CREATED),R.Ab(1),R.uc("ngIf",c.restoredData.status===c.PAYMENT_STATUS.CREATED),R.Ab(1),R.uc("name",c.SPINNER)("fullScreen",!1),R.Ab(1),R.uc("ngIf",c.form.controls.contract.value)}}var vo=function(t){return t.JYSAN="TSESKZKA",t}({});const Co=K.a.JPY,Eo=["342","343","314","312"],So=new RegExp(/(([a-zA-Z]{1}[a-zA-Z0-9\/\-?:().,\'+\ ]+)|([a-zA-Z]{1}))+/g),Vo=t=>!!t&&"810"!==t.substring(5,8),No=t=>!!t&&["000","001","002"].includes(t.substring(6,9)),Io=t=>!!t&&"0"===t[0],ko=t=>{var e,n,o;return t.value&&5!==(null===(e=t.value)||void 0===e?void 0:e.length)&&10!==(null===(n=t.value)||void 0===n?void 0:n.length)&&12!==(null===(o=t.value)||void 0===o?void 0:o.length)?{lengthMismatch:!0}:null},Oo=t=>{const e=new RegExp("^[0-9]+$");return t.value&&!t.value.match(e)?{rubInvalidNumbers:!0}:t.value&&t.value.length>8&&!Io(t.value)&&Vo(t.value)?{rubInvalid:!0}:t.value&&20!==t.value.length?{rubLength:!0}:null};let jo=(()=>{class t extends ke{constructor(t,e,n,o,i,s,c,a,r,l,b,u,m,d,p,h,f,g,A,T){super(u.createCurrencyForm(),s,o,i,t,e,n,l,c,b,a,r,p),this.companyService=t,this.paymentsService=e,this.maskService=n,this.route=o,this.router=i,this.api=s,this.dictionaries=c,this.translateService=a,this.authorityPermissionsService=r,this.modalService=l,this.pipelines=b,this.paymentsFormsFactory=u,this.maskPipe=m,this.recipientsService=d,this.featureFlagsService=p,this.accountsService=h,this.currencyPaymentService=f,this.curSymbolPipe=g,this.conversionService=A,this.contractsModalsService=T,this.nameMaxLength=103,this.cityMaxLength=32,this.paymentCategory=B.h.FOREIGN,this.isCounterPartyLoading$=new I.a(null),this.masks={iinOrBin:"iin",bankAccount:"foreignAccount",kbeCode:"kbe",knp:"knp",number:"paymentNum",amount:"amount",name:"foreignLatin",cityName:"foreignLatin",purpose:"foreignLatin",kvo:"kvo",kio:"kio",kpp:"kpp",oktmo:"oktmo",paymentBasis:"basis",budgetDocNumber:"budgetDocNumber",budgetPeriod:"budgetPeriod",rubNonRussiaCorrespondentIban:"russianAccount"},this.focusEmail$=new k.a,this.prevEmails$=new I.a([]),this.fetchingEmailsFor$=new I.a(null),this.accounts=[],this.isAccountsLoading=!0,this.contracts=[],this.filteredContracts=[],this.isContractsLoading=!1,this.isContractSelected=!1,this.withinContract=!1,this.isContractsDescriptionShown=!1,this.isContractsAgreementShown=!0,this.isContractsDescriptionLoading=!1,this.contractMaxAmount={amount:1e4,currency:K.a.USD},this.countries=[],this.countries$=new I.a([]),this.hasDefaultCity=!1,this.isCityShown=!1,this.cityPlaceholder$=new I.a("CURRENCY_PAYMENT.RECIPIENT.CITY"),this.isBicRequired=!0,this.isIntermediaryBankSwitchable=!1,this.hasIntermediaryBank=!1,this.ibanMaxLength=34,this.amountMask="separator.2",this.amountPlaceholder="0,00",this.amountSuffix=" ",this.isCommissionAccountSelectable=!0,this.isOurComission=!1,this.canPayCommission=!0,this.commissionBalance=null,this.isKppEnabled$=new I.a(!1),this.isKioEnabled$=new I.a(!1),this.isKvoEnabled$=new I.a(!1),this.codeWordLabel$=new I.a("CURRENCY_PAYMENT.RECIPIENT.CODEWORD"),this.isCodeWordEnabled$=new I.a(!1),this.isRubNonRussia$=new I.a(!1),this.isRubToRussia$=new I.a(!1),this.isRussianBudgetDisabled=!1,this.isRussianBudget$=new I.a(!1),this.isRussianTaxpayer=!1,this.kbkList=[],this.isKbkLoading=!1,this.statuses=[],this.isStatusesLoading=!1,this.hasRussianBudgetExtras=!1,this.isForeignContractDisabled=!1,this.isAustraliaAud$=new I.a(!1),this.isAustraliaNonAud$=new I.a(!1),this.isCountryCanada$=new I.a(!1),this.rules.purposeLength=335,this.isForeignContractDisabled=this.featureFlagsService.isDisabled(q.a.FOREIGN_CONTRACT),this.featureFlagsService.featureFlags$.subscribe(t=>{this.isForeignContractDisabled=this.featureFlagsService.isDisabled(q.a.FOREIGN_CONTRACT)}),this.featureFlagsService.checkFeatureRoute(q.a.FOREIGN_PAYMENT).then(()=>{this.isRussianBudgetDisabled=this.featureFlagsService.isDisabled(q.a.RUB_BUDGET_PAYMENT),this.isForeignContractDisabled=this.featureFlagsService.isDisabled(q.a.FOREIGN_CONTRACT)})}ngOnInit(){super.ngOnInit(),this.accountStore=this.accountsService.store,this.dateLimit=this.paymentsService.stdDateRangeNgb,this.retrieveKnps(),this.retrieveAccounts(),this.retrieveCountries(),this.retrieveContracts(),this.retrieveCodeWords(),this.retrieveKbks(),this.retrieveStatuses(),this.createControlsStream(this.form),this.getMaskConfig(),this.listenCommission(),this.listenCountrySelect(),this.listenWithinContractSwitch(),this.listenContractsSwitchDescription(),this.listenContractSelect(),this.listenEmailSearch(),this.listenWorkingDays(),this.listenDateMessageStream(),this.listenPurposeMessageStream(),this.listenPurpose(),this.listenPayComission(),this.listenIntermediaryBankSwitch(),this.listenIntermediaryBankSwitchable(),this.listenAmount(),this.applyAmountValidation(),this.listenAmountMessage(),this.setAutoNumeration(),this.listenCompanyType(),this.listenIsRussianBudget(),this.listenIsRussianTaxpayer(),this.listenHasRussianBudgetExtras(),this.listenRouterParams(),this.listenKvo(),this.listenKio(),this.listenCodeWordEnabling(),this.listenCodeWord(),this.listenCodeWordsList(),this.listenRubToNonRussia(),this.listenRubNonRussiaCorrespondentBank(),this.listenAudToAustralia(),this.listenAudNonAustralia(),this.listenCountryIsCanada(),this.listenMaxLengths(),this.applyKbeRules(),this.applyNameRules(),this.applyCountryRules(),this.applyIbanRules()}applyKbeRules(){this.subs.add(this.controlsStream.withinContract.subscribe(t=>{t?this.clearValidation([this.form.controls.kbeCode]):this.setValidation([this.form.controls.kbeCode],[i.H.required,Q.a.kbe])}))}applyNameRules(){const{name:t}=this.form.controls,{withinContract:e,senderAccount:n}=this.controlsStream;this.subs.add(Object(O.a)([e,n]).pipe(Object(P.a)()).subscribe(e=>{var n,o;const[s,c]=e,a=null===(o=null===(n=c)||void 0===n?void 0:n.balance)||void 0===o?void 0:o.currency,r=t.pristine;s?(t.disable(),this.clearValidation([t]),this.masks.name={mask:null}):(t.enable(),this.setValidation([t],[i.H.required]),this.masks.name=a===K.a.RUB?H.a.foreignCyrillic:H.a.foreignLatin),setTimeout(()=>{r&&t.markAsPristine()},0)}))}onNamePaste(t){t.preventDefault();const e=(t.clipboardData||window.clipboardData).getData("text").substring(0,this.nameMaxLength);this.form.controls.name.setValue(e)}applyCountryRules(){const{countryCode:t}=this.form.controls,{withinContract:e,senderAccount:n,contract:o}=this.controlsStream;this.subs.add(Object(O.a)([e,n,o]).pipe(Object(P.a)()).subscribe(e=>{var n,o;const[s,c]=e,a=null===(o=null===(n=c)||void 0===n?void 0:n.balance)||void 0===o?void 0:o.currency,r=t.pristine;if(s)t.disable(),this.clearValidation([t]);else{t.enable();const e=[i.H.required];a===K.a.CNY&&e.push(t=>t.value!==Te.a.CN?{cnyOnlyToChina:!0}:null),this.setValidation([t],e)}setTimeout(()=>{r&&t.markAsPristine()},0)}))}onCountrySearch({term:t}){if(!t)return void this.countries$.next(this.countries);const e=this.countries.filter(e=>e.code.toLowerCase().includes(t.toLowerCase())||e.nameEn.toLowerCase().includes(t.toLowerCase())||e.nameKk.toLowerCase().includes(t.toLowerCase())||e.nameRu.toLowerCase().includes(t.toLowerCase())).sort((e,n)=>this.countrySorter(e,n,t));this.countries$.next(e)}onCountryFocus(){this.form.controls.senderAccount.value||(this.senderAccountDropdown.hasError=!0)}onCountrySelect(t){this.hasDefaultCity=!!t.defaultCityName,this.form.controls.country.setValue(t)}countrySorter(t,e,n){if(t.code.toLowerCase()===n.toLowerCase())return-1;if(e.code.toLowerCase()===n.toLowerCase())return 1;if(t.code.toLowerCase().includes(n.toLowerCase()))return-1;if(e.code.toLowerCase().includes(n.toLowerCase()))return 1;switch(this.translateService.currentLang){case"ru":return t.nameRu<e.nameRu?-1:1;case"en":return t.nameEn<e.nameEn?-1:1;case"kk":return t.nameKk<e.nameKk?-1:1;default:return 0}}countryComparator(t,e){return!0}mapCountryLabel(t){let e;switch(this.translateService.currentLang){case"ru":default:e=t.nameRu;break;case"kk":e=t.nameKk;break;case"en":e=t.nameEn}return`${t.code} - ${e||t.name}`}get currentCountryCode(){var t,e,n;const o=(null===(n=null===(e=null===(t=this.formValue.contract)||void 0===t?void 0:t.contractor)||void 0===e?void 0:e.country)||void 0===n?void 0:n.code)||null;return this.formValue.withinContract&&o?o.substring(0,2):!this.formValue.withinContract&&this.formValue.countryCode?this.formValue.countryCode.substring(0,2):null}retrieveCountries(){return Object(N.a)(this,void 0,void 0,(function*(){this.countries=yield this.currencyPaymentService.getCountries(),this.countries$.next(this.countries)}))}applyIbanRules(){const{senderAccount:t,country:e,countryCode:n,contract:o,contractId:s,bank:c,rubNonRussiaBank:a,withinContract:r}=this.controlsStream;this.subs.add(Object(O.a)([t,c,a,e,n,o,s,r,this.countries$]).subscribe(t=>{var e,n,o;const[s,c,a]=t,r=[i.H.required],l=null===(n=null===(e=s)||void 0===e?void 0:e.balance)||void 0===n?void 0:n.currency,b=this.form.controls.bankAccount.pristine;if(l===K.a.RUB&&this.currentCountryCode===Te.a.RU)this.masks.bankAccount=H.a.russianAccount,r.push(t=>{var e;return((t,e)=>{const n=new RegExp("^[0-9]+$");return t.value&&!t.value.match(n)?{rubInvalidNumbers:!0}:t.value&&e&&!Io(t.value)&&No(e)?{rubInvalidBudget:!0}:t.value&&e&&t.value.length>8&&!Io(t.value)&&Vo(t.value)?{rubInvalid:!0}:t.value&&20!==t.value.length?{rubLength:!0}:null})(t,null===(e=c)||void 0===e?void 0:e.bic)});else{const t=l===K.a.RUB?a:c,e=null===(o=this.countries.find(e=>{var n;return e.id===(null===(n=t)||void 0===n?void 0:n.countryId)}))||void 0===o?void 0:o.code;this.masks.bankAccount=H.a.foreignAccount,r.push(t=>((t,e)=>{var n,o,i;const s=null===(n=t.value)||void 0===n?void 0:n.substring(0,2).match(/[A-Za-z]{2}/);return e&&s&&(null===(o=t.value)||void 0===o?void 0:o.substring(0,2).toUpperCase())!==(null===(i=e)||void 0===i?void 0:i.substring(0,2).toUpperCase())?{currencyMismatch:!0}:null})(t,e)),r.push(i.H.maxLength(this.ibanMaxLength))}this.setValidation([this.form.controls.bankAccount],r),setTimeout(()=>{b&&this.form.controls.bankAccount.markAsPristine()},0)}))}mapContractLabel(t){var e,n,o,i,s;const c=this.form.getRawValue().contract;return(null===(e=t)||void 0===e?void 0:e.contractNumber)||(null===(o=null===(n=t)||void 0===n?void 0:n.contractor)||void 0===o?void 0:o.name)?`${t.contractNumber} - ${null===(i=t.contractor)||void 0===i?void 0:i.name}`:c?`${c.contractNumber} - ${null===(s=c.contractor)||void 0===s?void 0:s.name}`:""}openForeignContractsRecipientsDictionary(){return Object(N.a)(this,void 0,void 0,(function*(){const t=this.modals.open(fe,{backdropClass:"backdrop_light",windowClass:"modal_light modal_dictionary",centered:!0}),{contract:e}=this.form.getRawValue();t.componentInstance.recipients=e.recipients;try{const e=yield t.result;this.selectContractRecipient(e)}catch(n){}}))}selectContractRecipient(t){var e,n,o,i;if(!t)return;const{name:s,country:c,countryCode:a,bankAccount:r,bank:l,cityName:b,fxContractRecipient:u,fxContractRecipientId:m}=this.form.controls;u.setValue(t),m.setValue(t.id),s.setValue(t.name||""),(null===(e=t.country)||void 0===e?void 0:e.code)&&!this.countries.find(e=>{var n;return e.code===(null===(n=t.country)||void 0===n?void 0:n.code)})&&this.countries$.next([...this.countries,t.country]),c.setValue(t.country),a.setValue((null===(n=t.country)||void 0===n?void 0:n.code)||t.countryCode),(t.cityName||t.defaultCityName)&&b.setValue(t.cityName||t.defaultCityName||""),t.iban&&r.setValue(t.iban),t.bankBic&&(l.setValue({code:t.bankBic,name:t.bankName}),null===(o=this.bankDropdown)||void 0===o||o.selectByBic(t.bankBic),null===(i=this.rubNonRussiaBankDropdown)||void 0===i||i.selectByBic(t.bankBic))}showContractDetails(t){t.preventDefault(),t.stopPropagation(),this.contractDetails.show()}onContractSelect(t,e=!1){var n,o,i;return Object(N.a)(this,void 0,void 0,(function*(){const{contract:s,kio:c,contractId:a}=this.form.controls,r=yield this.currencyPaymentService.getContractById(t.id);Object.assign(t,r),s.setValue(t),a.setValue(t.id),t.contractor.iinOrBin&&!e&&(null===(n=c)||void 0===n||n.setValue(t.contractor.iinOrBin));let l=null===(o=t.recipients)||void 0===o?void 0:o.find(t=>t.primary);const{fxContractRecipient:b,fxContractRecipientId:u}=this.form.getRawValue();if(!b&&!u&&l)return void this.selectContractRecipient(l);const m=null===(i=t.recipients)||void 0===i?void 0:i.find(t=>{var e;return(null===(e=b)||void 0===e?void 0:e.id)===t.id||u===t.id});m&&(l=m),this.selectContractRecipient(l)}))}contractComparator(t,e){if(!t)return!0;const n=e.contractor.name.toLowerCase().includes(t.toLowerCase()),o=e.contractNumber.toLowerCase().includes(t.toLowerCase());return n||o}onEmailOnSuccessFocus(t){this.focusEmail$.next(t.target.value)}onSenderAccountSelect(t){t&&(this.form.controls.senderAccount.setValue(t),this.form.controls.senderAccount.markAsDirty(),this.senderAccountDropdown.hasError=!1)}onCommissionAccountSelect(t){this.form.controls.commissionAccount.setValue(t)}get senderAccountsList(){return this.accounts.filter(t=>t.balance.currency!==K.a.KZT)}get commissionAccountsList(){const t=this.form.getRawValue().senderAccount;return this.accounts.filter(e=>{var n,o;return e.balance.currency===K.a.KZT||e.balance.currency===(null===(o=null===(n=t)||void 0===n?void 0:n.balance)||void 0===o?void 0:o.currency)})}codeWordComparator(t,e){return!t||e.name.toLowerCase().includes(t.toLowerCase())||e.code.toLowerCase().includes(t.toLowerCase())}kbkComparator(t,e){return!t||e.code.toLowerCase().includes(t.toLowerCase())||e.description.toLowerCase().includes(t.toLowerCase())}statusComparator(t,e){return!t||e.code.toLowerCase().includes(t.toLowerCase())||e.description.toLowerCase().includes(t.toLowerCase())}scrollToContracts(t){return Object(N.a)(this,void 0,void 0,(function*(){t.preventDefault(),yield this.form.controls.withinContract.setValue(!0),setTimeout(()=>{document.getElementById("contractGroup").scrollIntoView({behavior:"smooth"}),this.contractsSelect.focus(),this.contractsSelect.open()},100)}))}onAmountPaste(t){var e,n;t.preventDefault();const o=this.form.getRawValue(),i=(t.clipboardData||window.clipboardData).getData("text");let s=this.maskService.getNumberedAmount(i);(null===(n=null===(e=o.senderAccount)||void 0===e?void 0:e.balance)||void 0===n?void 0:n.currency)===Co&&(s=Math.trunc(s)),this.form.controls.amount.setValue(s)}mapCodeWordLabel(t){if(t)return`${t.code} - ${t.name}`}listenMaxLengths(){this.subs.add(Object(O.a)([this.isAustraliaAud$,this.isAustraliaNonAud$,this.isCountryCanada$,this.isRubNonRussia$,this.isRubToRussia$,this.controlsStream.name,this.controlsStream.purpose,this.purposeMessage$,this.controlsStream.countryCode]).subscribe(t=>{var e,n;let[o,s,c,a,r,l,b,u]=t;if(r=r||"",l=l||"",b=b||"",o?(this.nameMaxLength=35,this.cityMaxLength=26):s?(this.nameMaxLength=35,this.cityMaxLength=31):c?(this.nameMaxLength=35,this.cityMaxLength=32):(this.nameMaxLength=103,this.cityMaxLength=32),a||c){this.rules.purposeLength=203;const t=r.match(So);(null===(e=t)||void 0===e?void 0:e.length)>0&&(this.nameMaxLength-=2*t.length);const o=l.match(So);(null===(n=o)||void 0===n?void 0:n.length)>0&&(this.rules.purposeLength-=2*o.length)}else this.rules.purposeLength=u===Te.a.CN?300:335;this.setValidation([this.form.controls.purpose],[i.H.maxLength(u===Te.a.CN?this.rules.purposeLength:this.rules.purposeLength-b.length)],!1)}))}listenAudToAustralia(){this.subs.add(this.isAustraliaAud$.subscribe(t=>{const{audIndex:e,audState:n,audStreet:o,audBuildingNumber:s}=this.form.controls;t?this.setValidation([e,n,o,s],[i.H.required]):this.clearValidation([e,n,o,s])}))}listenAudNonAustralia(){this.subs.add(this.isAustraliaNonAud$.subscribe(t=>{const{audAddress:e}=this.form.controls;t?this.setValidation([e],[i.H.required]):this.clearValidation([e])}))}listenCountryIsCanada(){this.subs.add(this.isCountryCanada$.subscribe(t=>{const{canAddress:e}=this.form.controls;t?this.setValidation([e],[i.H.required]):this.clearValidation([e])}))}listenCompanyType(){this.subs.add(this.companyService.refresh$.subscribe(t=>{this.companyService.currentCompany.type===G.a.CORPORATE?(this.agreementText="CURRENCY_PAYMENT.AGREEMENT.CORPORATE",this.isForeignContractDisabled&&(this.isContractsAgreementShown=!1),this.isContractsDescriptionShown=!0):(this.agreementText="CURRENCY_PAYMENT.AGREEMENT.ENTREPRENEUR",this.isForeignContractDisabled&&(this.isContractsAgreementShown=!0),this.isContractsDescriptionShown=!1)}))}retrieveKnps(){this.knp$=this.combineKNP([t=>this.dictionaries.selectByPaymentType(t,{type:B.j.FOREIGN,sortFavourite:!1})])}retrieveAccounts(){return Object(N.a)(this,void 0,void 0,(function*(){this.isAccountsLoading=!0;try{const t=yield this.accountsService.getAccounts(this.companyService.currentId);this.accounts=t.filter(t=>t.balance.currency&&t.accountType===l.a.ACCOUNT).sort(this.sortAccounts),this.selectDefaultSenderAccount(),this.listenCommissionAccount()}catch(t){}finally{this.isAccountsLoading=!1}}))}selectDefaultSenderAccount(){try{1===this.senderAccountsList.length&&(this.senderAccountDropdown.selectAccount(this.senderAccountsList[0]),this.onSenderAccountSelect(this.senderAccountsList[0]),this.senderAccountDropdown.isDisabled=!0)}catch(t){}}retrieveContracts(){var t,e;return Object(N.a)(this,void 0,void 0,(function*(){this.isContractsLoading=!0;try{const n=yield this.currencyPaymentService.getContracts();this.contracts=n.filter(t=>t.status===B.c.REGED);const o=null===(e=null===(t=this.formValue.senderAccount)||void 0===t?void 0:t.balance)||void 0===e?void 0:e.currency;this.filteredContracts=o?this.contracts.filter(t=>t.permittedCurrencies.includes(o)):[...this.contracts]}catch(n){}finally{this.isContractsLoading=!1}}))}retrieveKbks(){return Object(N.a)(this,void 0,void 0,(function*(){this.isKbkLoading=!0;try{this.kbkList=yield this.currencyPaymentService.getKbkList()}catch(t){}finally{this.isKbkLoading=!1}}))}retrieveStatuses(){return Object(N.a)(this,void 0,void 0,(function*(){this.isStatusesLoading=!0;try{this.statuses=yield this.currencyPaymentService.getStatuses()}catch(t){}finally{this.isStatusesLoading=!1}}))}retrieveCodeWords(t=this.currentCountryCode){return Object(N.a)(this,void 0,void 0,(function*(){if(!this.isCodeWordsLoading){this.isCodeWordsLoading=!0;try{if(t){this.codeWords=yield this.currencyPaymentService.getCodeWords(t);const e=this.form.controls.codeWord.value;this.codeWords.find(t=>e.code===t.code&&e.countryCode===t.countryCode)||this.form.controls.codeWord.setValue("")}}catch(e){}finally{this.isCodeWordsLoading=!1}}}))}listenCountrySelect(){const{countryCode:t,senderAccount:e,country:n}=this.controlsStream;this.subs.add(Object(O.a)([t,e,n]).pipe(Object(P.a)()).subscribe(t=>{var e,n;const[o,s]=t;o&&(this.form.controls.bankLabel.setValue(""),this.form.controls.bank.setValue(null),(null===(n=null===(e=s)||void 0===e?void 0:e.balance)||void 0===n?void 0:n.currency)===K.a.RUB||this.hasDefaultCity?(this.isCityShown=!1,this.clearValidation([this.form.controls.cityName])):(this.isCityShown=!0,this.setValidation([this.form.controls.cityName],[i.H.required])))}))}listenContractsSwitchDescription(){this.subs.add(this.controlsStream.senderAccount.subscribe(t=>{var e,n,o,i,s,c;this.filteredContracts=this.contracts.filter(e=>{var n,o,i;return null===(n=e.permittedCurrencies)||void 0===n?void 0:n.includes(null===(i=null===(o=t)||void 0===o?void 0:o.balance)||void 0===i?void 0:i.currency)}),(null===(n=null===(e=this.formValue.contract)||void 0===e?void 0:e.amount)||void 0===n?void 0:n.currency)!==(null===(i=null===(o=t)||void 0===o?void 0:o.balance)||void 0===i?void 0:i.currency)&&(this.form.controls.contract.setValue(null),this.form.controls.contractId.setValue("")),this.updateContractsSwitchDescriptionParams((null===(c=null===(s=t)||void 0===s?void 0:s.balance)||void 0===c?void 0:c.currency)||null)}))}listenIsRussianBudget(){this.subs.add(Object(O.a)([this.controlsStream.senderAccount,this.controlsStream.bankAccount,this.controlsStream.bank,this.controlsStream.withinContract,this.controlsStream.contract,this.controlsStream.country]).subscribe(t=>{var e,n,o;const[i,s,c]=t,a=Io(s)&&No(null===(e=c)||void 0===e?void 0:e.bic);this.currentCountryCode===Te.a.RU&&(null===(o=null===(n=i)||void 0===n?void 0:n.balance)||void 0===o?void 0:o.currency)===K.a.RUB&&a&&!this.featureFlagsService.isDisabled(q.a.RUB_BUDGET_PAYMENT)?(this.isRussianBudget$.next(!0),this.form.controls.isRussianBudget.setValue(!0)):(this.isRussianBudget$.next(!1),this.form.controls.isRussianBudget.setValue(!1))}))}listenWithinContractSwitch(){const{withinContract:t,senderAccount:e,contract:n,country:o}=this.controlsStream;this.subs.add(Object(O.a)([t,e,n,o]).pipe(Object(P.a)()).subscribe(t=>{var e,n,o;const[s,c,a,r]=t;this.withinContract=s;const l=null===(n=null===(e=c)||void 0===e?void 0:e.balance)||void 0===n?void 0:n.currency,{bank:b,bankLabel:u}=this.form.controls,m=[b,u];if(this.currentCountryCode===Te.a.US?(this.cityPlaceholder$.next("CURRENCY_PAYMENT.RECIPIENT.CITY_STATE"),this.clearValidation([this.form.controls.bankLabel,this.form.controls.bank])):this.cityPlaceholder$.next(this.formValue.isRubNonRussia?"CURRENCY_PAYMENT.RECIPIENT.CITY_BANK":"CURRENCY_PAYMENT.RECIPIENT.CITY"),s){const t=l===K.a.RUB;!(null===(o=a)||void 0===o?void 0:o.contractor.iinOrBin)&&t?this.isKioEnabled$.next(!0):this.isKioEnabled$.next(!1),this.clearValidation(m),this.setValidation([this.form.controls.contractId],[t=>this.currentCountryCode!==Te.a.CN&&l===K.a.CNY?{cnyOnlyToChina:!0}:null,i.H.required],!1);const e=l===K.a.AUD,n=this.currentCountryCode===Te.a.CA,s=this.currentCountryCode===Te.a.AU;this.isAustraliaAud$.next(e&&s),this.isAustraliaNonAud$.next(!e&&s),this.isCountryCanada$.next(n),this.currentCountryCode&&l===K.a.RUB&&(this.rubNonRussiaWithinContractCountry=a.contractor.country.code,this.applyRubPaymentRules(this.rubNonRussiaWithinContractCountry))}else{this.form.controls.contract.setValue(null,{emitEvent:!1}),this.form.controls.contractId.setValue(null),this.clearValidation([this.form.controls.contractId]),this.setValidation(m,[i.H.required]);const t=l===K.a.AUD,e=this.currentCountryCode===Te.a.AU,n=this.currentCountryCode===Te.a.CA;this.isAustraliaAud$.next(t&&e),this.isAustraliaNonAud$.next(!t&&e),this.isCountryCanada$.next(n),l===K.a.RUB?this.applyRubPaymentRules(this.currentCountryCode):l===K.a.CNY?(this.form.controls.codeWord.setValue(""),this.applyChinaPaymentRules(this.currentCountryCode)):this.applyDefaultPaymentRules()}}))}listenCodeWordEnabling(){const{withinContract:t,contract:e,country:n}=this.controlsStream;this.subs.add(Object(O.a)([t,e,n]).subscribe(t=>{this.currentCountryCode===Te.a.AE?(this.isCodeWordEnabled$.next(!0),this.codeWordLabel$.next("CURRENCY_PAYMENT.RECIPIENT.CODEWORD_AE")):this.currentCountryCode===Te.a.CN?(this.isCodeWordEnabled$.next(!0),this.codeWordLabel$.next("CURRENCY_PAYMENT.RECIPIENT.CODEWORD")):(this.isCodeWordEnabled$.next(!1),this.codeWordLabel$.next("CURRENCY_PAYMENT.RECIPIENT.CODEWORD"))}))}listenContractSelect(){this.subs.add(this.controlsStream.contractId.pipe(Object(P.a)()).subscribe(t=>{this.isContractSelected=!!t}))}updateContractsSwitchDescriptionParams(t=K.a.USD){return Object(N.a)(this,void 0,void 0,(function*(){if(t&&t!==K.a.USD){this.isContractsDescriptionLoading=!0;const e={currencyFrom:t,currencyTo:K.a.USD,sum:{amount:1e4,currency:K.a.USD}};try{const n=yield this.conversionService.getRate(e);this.contractMaxAmount={amount:n.calculatedSum,currency:t}}catch(o){this.contractMaxAmount={amount:1e4,currency:K.a.USD}}finally{this.isContractsDescriptionLoading=!1}}else this.contractMaxAmount={amount:1e4,currency:K.a.USD};let e=this.maskService.getMaskedAmount(this.contractMaxAmount.amount);e=e.split(",").filter(t=>parseInt(t,10)>0).map((t,e)=>1===e&&t.length<2?`${t}0`:t).join(",");const n=this.curSymbolPipe.transform(this.contractMaxAmount.currency);this.contractsSwitchDescriptionParams={amount:`${e} ${n}`}}))}openForeignRecipientsDictionary(){var t,e;return Object(N.a)(this,void 0,void 0,(function*(){const n=this.modals.open(le,{backdropClass:"backdrop_light",windowClass:"modal_light modal_dictionary",centered:!0});try{const o=yield n.result,{countryCode:i,cityName:s,name:c,bankAccount:a,kbeCode:r,bank:l,kio:b}=this.form.controls,{recipient:u,account:m}=o;i.setValue(u.countryCode),s.setValue(u.cityName||""),c.setValue(u.name||""),a.setValue(m.iban),r.setValue(u.kbe.code),l.setValue({bic:m.bic,name:m.bankName}),this.bankDropdown.selectByBic(m.bic),null===(t=this.rubNonRussiaBankDropdown)||void 0===t||t.selectByBic(m.bic),null===(e=b)||void 0===e||e.setValue(u.iinOrBin)}catch(o){}}))}get formValue(){return this.form.getRawValue()}get shouldBindContract(){var t,e;return-1===Eo.indexOf(this.formValue.knp)&&!this.isForeignContractDisabled&&(null===(e=null===(t=this.formValue.senderAccount)||void 0===t?void 0:t.balance)||void 0===e?void 0:e.currency)===this.contractMaxAmount.currency&&!this.formValue.contractId&&this.maskService.getNumberedAmount(this.formValue.amount)>this.contractMaxAmount.amount}applyAmountValidation(){this.subs.add(Object(O.a)([this.controlsStream.senderAccount,this.controlsStream.contractId]).subscribe(t=>{var e,n;const[o,s]=t;let c=[i.H.required,i.H.min(this.paymentsService.rules.minAmount),i.H.max(this.paymentsService.rules.maxAmount),t=>{var e;return 0===(null===(e=t)||void 0===e?void 0:e.value)?{cantBeZero:!0}:null}];(null===(n=null===(e=o)||void 0===e?void 0:e.balance)||void 0===n?void 0:n.currency)!==this.contractMaxAmount.currency||s||c.push(t=>{const e=this.maskService.getNumberedAmount(t.value);if(!this.isForeignContractDisabled&&!this.withinContract)return e>this.contractMaxAmount.amount?-1!==Eo.indexOf(this.formValue.knp)?null:{mustIncludeContract:!0}:null}),this.setValidation([this.form.controls.amount],c,!1)}))}setValidation(t,e,n=!0){t.forEach(t=>{const o=t.pristine;t.setValidators(e),t.updateValueAndValidity({emitEvent:n}),setTimeout(()=>{o&&t.markAsPristine()},0)})}clearValidation(t,e=!0){t.forEach(t=>{const n=t.pristine;t.clearValidators(),t.updateValueAndValidity({emitEvent:e}),setTimeout(()=>{n&&t.markAsPristine()},0)})}listenPayComission(){this.subs.add(this.controlsStream.payComission.pipe(Object(P.a)()).subscribe(t=>{this.isOurComission=t}))}listenIntermediaryBankSwitchable(){const{senderAccount:t,country:e,bank:n}=this.controlsStream;this.subs.add(Object(O.a)([t,e,n]).subscribe(t=>{var e,n,o;const[i,s,c]=t,a=null===(n=null===(e=i)||void 0===e?void 0:e.balance)||void 0===n?void 0:n.currency,r=null===(o=c)||void 0===o?void 0:o.bic;(a===K.a.EUR||a===K.a.USD&&this.currentCountryCode!==Te.a.US)&&r!==vo.JYSAN?(this.isIntermediaryBankSwitchable=!0,this.setValidation([this.form.controls.intermediaryBankLabel],[t=>{const e=this.form.getRawValue();return t.value&&t.value===e.bankLabel?{equalBanks:!0}:null}])):(this.clearValidation([this.form.controls.intermediaryBankLabel]),this.isIntermediaryBankSwitchable=!1)}))}listenIntermediaryBankSwitch(){this.subs.add(this.controlsStream.hasIntermediaryBank.pipe(Object(P.a)()).subscribe(t=>{this.hasIntermediaryBank=t,t||(this.form.controls.intermediaryBankLabel.setValue(""),this.form.controls.intermediaryBank.setValue(null))}))}listenEmailSearch(){const{emailOnSuccess:t}=this.form.controls;this.subs.add(this.controlsStream.notify.pipe(Object(x.a)(100)).subscribe(e=>e?t.enable():t.disable())),this.search=t=>Object(O.a)([this.prevEmails$.pipe(Object(y.a)(t=>t.map(t=>t.email))),t.pipe(Object(x.a)(200),Object(P.a)(),Object(_.a)("")),this.focusEmail$]).pipe(Object(y.a)(([t,e,n])=>e?t.filter(t=>t.toLowerCase().indexOf(e.toLowerCase())>-1).slice(0,3):t.slice(0,3)))}setAutoNumeration(){this.subs.add(this.paymentsService.foreignPaymentNumber$.pipe(Object(D.a)(this.controlsStream.number)).subscribe(([t,e])=>{e||this.form.controls.number.setValue(t)}))}listenCommission(){const{senderAccount:t,date:e,commissionAccount:n,amount:o,payComission:i}=this.controlsStream;Object(O.a)([t,e,n,o,i,this.workingHours$.asObservable()]).pipe(Object(x.a)(300)).subscribe(t=>{this.updateComission()})}updateComission(){var t,e,n,o,i,s,c,a,r,l,b,u;return Object(N.a)(this,void 0,void 0,(function*(){const{senderAccount:m,date:d,commissionAccount:p,amount:h,payComission:g}=this.form.controls;let A=!0;if([m,d,p,h,g].forEach(t=>{t.invalid&&(A=!1)}),!A)return;const T=this.form.getRawValue();try{const m=T.date?Object(f.ngbStructToISO)(T.date):null,d=this.maskService.getNumberedAmount(T.amount),p={companyId:this.companyService.currentId,category:B.h.FOREIGN,type:B.j.FOREIGN,details:{valueDate:m,paymentAmount:{amount:d,currency:null===(e=null===(t=T.senderAccount)||void 0===t?void 0:t.balance)||void 0===e?void 0:e.currency},foreignPaymentDetails:{type:T.payComission?"OUR":"SHA"},urgent:!1,payerIban:T.senderAccount.iban}};this.commissionBalance=yield this.api.getCommissionWithCurrency(p),this.form.controls.comission.setValue((null===(n=this.commissionBalance)||void 0===n?void 0:n.amount)||0),this.form.controls.comissionCurrency.setValue(this.commissionBalance.currency),this.comissionMessage=(null===(i=null===(o=T.commissionAccount)||void 0===o?void 0:o.balance)||void 0===i?void 0:i.amount)<(null===(s=this.commissionBalance)||void 0===s?void 0:s.amount)&&(null===(a=null===(c=T.commissionAccount)||void 0===c?void 0:c.balance)||void 0===a?void 0:a.currency)===(null===(r=this.commissionBalance)||void 0===r?void 0:r.currency)?this.mapCommissionMessage({amount:(null===(l=this.commissionBalance)||void 0===l?void 0:l.amount)-(null===(u=null===(b=T.commissionAccount)||void 0===b?void 0:b.balance)||void 0===u?void 0:u.amount),currency:this.commissionBalance.currency}):Object(j.a)(null)}catch(y){this.commission$.next(null),this.comissionMessage=null}}))}mapCommissionMessage(t,e=this.workingHours$.value){var n;const o=this.form.getRawValue().date,i=this.maskService.formatAmount(t.amount),s=this.curSymbolPipe.transform(t.currency),c=(null===(n=e)||void 0===n?void 0:n.endTime)||f.edgeTimeLabel;return this.translateService.get(o?"CURRENCY_PAYMENT.MESSAGES.COMMISSION.WITH_DATE":"CURRENCY_PAYMENT.MESSAGES.COMMISSION.DEFAULT",{amount:`${i} ${s}`,edge:`${Object(f.formatNgbDate)(o,this.translateService.currentLang)} ${c}`})}mapAmountMessage(t,e=this.workingHours$.value){var n;const o=this.form.getRawValue().date,i=this.maskService.formatAmount(t.amount),s=this.curSymbolPipe.transform(t.currency),c=(null===(n=e)||void 0===n?void 0:n.endTime)||f.edgeTimeLabel;return this.translateService.get(o?"CURRENCY_PAYMENT.MESSAGES.AMOUNT.WITH_DATE":"CURRENCY_PAYMENT.MESSAGES.AMOUNT.DEFAULT",{amount:`${i} ${s}`,edge:`${Object(f.formatNgbDate)(o,this.translateService.currentLang)} ${c}`})}sortAccounts(t,e){return t.balance.currency===e.balance.currency?0:t.balance.currency===K.a.USD?-1:1}listenAmount(){const{amount:t}=this.form.controls;this.subs.add(this.controlsStream.senderAccount.pipe(Object(P.a)(),Object(y.a)(e=>{var n,o;const i=null===(o=null===(n=e)||void 0===n?void 0:n.balance)||void 0===o?void 0:o.currency,s=t.pristine;return this.amountSuffix=` ${this.curSymbolPipe.transform(i)||i||this.curSymbolPipe.transform(K.a.KZT)}`,i===Co?(this.amountMask="separator.0",this.amountPlaceholder="0"):(this.amountMask="separator.2",this.amountPlaceholder="0,00"),s}),Object(w.a)(0)).subscribe(e=>{e&&e!==t.pristine&&t.markAsPristine()}))}listenAmountMessage(){const{senderAccount:t,date:e,amount:n,contractId:o}=this.controlsStream;Object(O.a)([t,e,n,o,this.workingHours$.asObservable()]).pipe(Object(P.a)()).subscribe(t=>{var e,n,o,i;const[s,c,a,r,l]=t,b=this.maskService.getNumberedAmount(a),u=(null===(n=null===(e=s)||void 0===e?void 0:e.balance)||void 0===n?void 0:n.amount)<b&&!this.shouldBindContract;this.amountMessage=u?this.mapAmountMessage({amount:b-(null===(i=null===(o=s)||void 0===o?void 0:o.balance)||void 0===i?void 0:i.amount),currency:s.balance.currency}):Object(j.a)(null)})}listenCommissionAccount(){this.subs.add(this.controlsStream.senderAccount.pipe(Object(P.a)()).subscribe(t=>{var e,n,o,i,s,c,a,r;const l=this.form.getRawValue().commissionAccount;if(l&&(null===(n=null===(e=l)||void 0===e?void 0:e.balance)||void 0===n?void 0:n.currency)!=(null===(i=null===(o=t)||void 0===o?void 0:o.balance)||void 0===i?void 0:i.currency)&&(this.commissionAccountDropdown.clearSelected(),this.onCommissionAccountSelect(null)),1===this.commissionAccountsList.length){const t=this.commissionAccountsList[0];null===(s=this.commissionAccountDropdown)||void 0===s||s.selectAccount(t),this.onCommissionAccountSelect(t),this.isCommissionAccountSelectable=!1}else this.isCommissionAccountSelectable=!0;const b=this.commissionAccountsList.filter(t=>t.balance.currency===K.a.KZT);1===(null===(c=b)||void 0===c?void 0:c.length)?(null===(a=this.commissionAccountDropdown)||void 0===a||a.selectAccount(b[0]),this.onCommissionAccountSelect(b[0])):0===b.length&&t&&(null===(r=this.commissionAccountDropdown)||void 0===r||r.selectAccount(t),this.onCommissionAccountSelect(t))}))}saveToDraft(t){var e;this.formDirective.submitted=!0,this.formDirective.form.markAsPristine();const n=this.paymentsService.foreignPaymentNumber,o=t||Object.assign({},this.form.value);n.entity=null,this.processingPayment$.next(Object.assign({id:this.paymentId},o)),this.pipeline.saveToDrafts(o,{paymentId:this.paymentId,type:B.j.FOREIGN,commission:null===(e=this.commissionBalance)||void 0===e?void 0:e.amount,userPurpose:this.form.value.purpose,category:B.h.FOREIGN}).then(t=>{t.id!==this.paymentId&&(t&&(this.restoredData={status:t.status,signatures:t.signatures,companyId:t.companyId}),this.router.navigate([this.route.snapshot.params.paymentId?"../":".",t.id],{relativeTo:this.route,state:{silent:!0,resolvedPayment:this.currencyPaymentService.mapForm(this.form.getRawValue())}}))}).catch(t=>{n.entity||n.fetching||(n.entity=o.number)}).finally(()=>{this.processingPayment$.next(null)})}listenRouterParams(){this.subs.add(this.route.params.pipe(Object(y.a)(t=>({state:window.history.state,params:t,route:this.route})),Object(x.a)(0),Object(Y.a)(({params:t,state:e})=>{var n,o,i;if(null===(n=e)||void 0===n?void 0:n.silent)return this.restoredData.status===B.i.DRAFT?this.paymentsService.rootTitle=Te.d.EDIT_DRAFT:this.restoredData.status===B.i.CREATED&&(this.paymentsService.rootTitle=Te.d.EDIT_PAYMENT),W.a;if(null===(o=e)||void 0===o?void 0:o.resolvedPayment)return Object(j.a)(e.resolvedPayment);if(t.paymentId||(null===(i=e)||void 0===i?void 0:i.repeatPaymentId)){const n=t.paymentId||e.repeatPaymentId;return Object(M.a)(this.api.getPaymentById(n)).pipe(Object(U.a)(t=>(this.router.navigate([this.router.url.replace("/"+n,"")]),W.a)))}return this.setAutoNumeration(),this.paymentsService.rootTitle=Te.d.NEW,W.a})).subscribe(t=>{this.restorePayment(t)}))}restorePayment(t){this.subs.add(Object(O.a)([this.knpStore.fetched$]).pipe(Object(L.a)(t=>t.every(t=>t)),Object(F.a)(()=>{var e;let n;try{n=this.pipeline.flattenPaymentToModel(t)}catch(o){n={}}this.restoredData={companyId:t.companyId,status:null===(e=t.status)||void 0===e?void 0:e.code,signatures:t.signatures},t.isNewPayment||t.id&&!this.paymentId?(n.number="",n.date=null,this.restoredData.status=null,this.paymentsService.rootTitle=Te.d.NEW):this.paymentsService.rootTitle=this.restoredData.status===B.i.DRAFT?Te.d.EDIT_DRAFT:Te.d.EDIT_PAYMENT,n.emailOnSuccess&&(n.notify=!0),this.form.patchValue(Object.assign({},n)),this.restoreAsyncData(t),this.isImported=t.imported,n.number||this.setAutoNumeration()}),Object(x.a)(10),Object($.a)(1)).subscribe())}sendPayment(t){var e,n;this.formDirective.form.markAsPristine();const o=this.paymentsService.paymentNumber,i=t||Object.assign({},this.form.value);return this.processingPayment$.next(i),this.paymentsService.paymentNumber.entity=null,this.pipeline.processPayment({paymentId:this.paymentId,total:i.amount,commission:null===(e=this.commissionBalance)||void 0===e?void 0:e.amount,status:null===(n=this.restoredData)||void 0===n?void 0:n.status,userPurpose:this.form.value.purpose,rawBody:i}).then(t=>{t?this.restoredData={status:t.status.code,signatures:t.signatures,companyId:t.companyId}:(this.restoredData=null,o.entity||o.fetching||(o.entity=i.number))}).catch(t=>{}).finally(()=>{this.processingPayment$.next(null)})}onSubmit(t){t&&t.preventDefault(),this.form.valid?this.processPayment():this.form.markAllAsTouched()}processPayment(){return Object(N.a)(this,void 0,void 0,(function*(){const t=this.form.getRawValue();this.processingPayment$.next(t);try{const e=yield this.api.checkWorkingTime(t.date),n=yield this.api.checkAmountLimit(t.amount,this.paymentType);e&&n?this.sendPayment():this.processingPayment$.next(null)}catch(e){this.processingPayment$.next(null)}}))}openContractsAddingModal(t=null){var e;null===(e=t)||void 0===e||e.preventDefault(),this.contractsModalsService.showAddContractModal(!1)}openKnpDictionary(t,e){t.close(),t.blur(),setTimeout(()=>{this.modals.open(bt,{backdropClass:"backdrop_light",windowClass:"modal_light modal_max-height",centered:!0}).result.then(t=>{this.form.controls.knp.patchValue(t),this.form.controls.knpObject.patchValue(t)}).catch(()=>{})},0)}restoreAsyncData(t){var e,n,o,s,c,a,r,l,b,u,m,d,p,h,f,g,A;return Object(N.a)(this,void 0,void 0,(function*(){yield this.retrieveAccounts(),this.senderAccountDropdown.selectByIban(null===(e=t.details)||void 0===e?void 0:e.payerIban);const T=null===(s=null===(o=null===(n=t)||void 0===n?void 0:n.paymentRecipient)||void 0===o?void 0:o.recipientAccount)||void 0===s?void 0:s.bic,y=null===(r=null===(a=null===(c=t)||void 0===c?void 0:c.details)||void 0===a?void 0:a.foreignPaymentDetails)||void 0===r?void 0:r.intermediaryBankBic,R=null===(u=null===(b=null===(l=t)||void 0===l?void 0:l.details)||void 0===b?void 0:b.foreignPaymentDetails)||void 0===u?void 0:u.intermediaryBankIban;(null===(m=this.formValue.senderAccount)||void 0===m?void 0:m.balance.currency)===K.a.RUB&&this.currentCountryCode!==Te.a.RU&&this.isRubNonRussia$.next(!0),T&&setTimeout(()=>{var t,e;this.formValue.isRubNonRussia?null===(t=this.rubNonRussiaBankDropdown)||void 0===t||t.selectByBic(T):null===(e=this.bankDropdown)||void 0===e||e.selectByBic(T)},100),y&&setTimeout(()=>{var t;this.formValue.isRubNonRussia?this.rubNonRussiaCorrespondentBankDropdown.selectByBic(y):null===(t=this.intermediaryBankDropdown)||void 0===t||t.selectByBic(y)},100),R&&this.formValue.isRubNonRussia&&this.form.controls.rubNonRussiaCorrespondentIban.setValue(R),this.withinContract&&this.onContractSelect(this.formValue.contract,!0),(null===(d=t.details)||void 0===d?void 0:d.foreignPaymentDetails.codeWord)&&(yield this.retrieveCodeWords(),this.form.controls.codeWord.setValue(t.details.foreignPaymentDetails.codeWord)),this.commissionAccountDropdown.selectByIban(t.details.foreignPaymentDetails.commissionWithdrawalIban),this.hasDefaultCity=!!(null===(h=null===(p=t.paymentRecipient)||void 0===p?void 0:p.country)||void 0===h?void 0:h.defaultCityName),(null===(A=null===(g=null===(f=t)||void 0===f?void 0:f.details)||void 0===g?void 0:g.paymentAmount)||void 0===A?void 0:A.currency)===K.a.RUB||this.hasDefaultCity?(this.isCityShown=!1,this.clearValidation([this.form.controls.cityName])):(this.isCityShown=!0,this.setValidation([this.form.controls.cityName],[i.H.required]))}))}listenPurposeMessageStream(){this.subs.add(Object(O.a)([this.purposeMessage$,this.controlsStream.purpose,this.controlsStream.countryCode]).pipe(Object(y.a)(t=>{const[e,n,o]=t;return o===Te.a.CN?(n||"").length:(e||"").length+(n||"").length})).subscribe(this.purposeLength$)),this.validatePurpose()}listenIsRussianTaxpayer(){this.subs.add(this.controlsStream.isRussianTaxPayer.subscribe(t=>{t?(this.isRussianTaxpayer=!0,this.setValidation([this.form.controls.payerInn],[i.H.required,ko])):(this.isRussianTaxpayer=!1,this.clearValidation([this.form.controls.payerInn]))}))}listenHasRussianBudgetExtras(){this.subs.add(this.controlsStream.hasRussianBudgetExtras.subscribe(t=>{this.hasRussianBudgetExtras=!!t}))}listenKvo(){this.subs.add(this.isKvoEnabled$.pipe(Object(P.a)()).subscribe(t=>{t?this.setValidation([this.form.controls.kvo],[i.H.required]):this.clearValidation([this.form.controls.kvo])}))}listenPurpose(){this.subs.add(Object(O.a)([this.isKvoEnabled$.pipe(Object(P.a)()),this.controlsStream.kvo.pipe(Object(P.a)()),this.controlsStream.isRubNonRussia.pipe(Object(P.a)()),this.controlsStream.name.pipe(Object(P.a)()),this.controlsStream.withinContract.pipe(Object(P.a)()),this.controlsStream.bankAccount,this.controlsStream.country,this.controlsStream.countryCode,this.controlsStream.codeWord]).subscribe(t=>{var e;const[n,o,i,s,c,a,r,l,b]=t;let u="";n&&(u+=`'(VO${o||""})'`),i&&!c&&(u+=` \u0434\u043b\u044f ${s||""} \u0441\u0447\u0451\u0442 '${a||""}'`),l===Te.a.CN&&(u+=`//${(null===(e=b)||void 0===e?void 0:e.code)||""}`),this.purposeMessage$.next(u)}))}listenKio(){this.subs.add(Object(O.a)([this.isKioEnabled$,this.isRussianBudget$]).pipe(Object(P.a)()).subscribe(t=>{const[e,n]=t;if(e){let t;t=n?[ko,i.H.required]:[ko],this.setValidation([this.form.controls.kio],t)}else this.clearValidation([this.form.controls.kio])}))}listenCodeWordsList(){const{country:t,countryCode:e,contract:n,withinContract:o}=this.controlsStream;this.subs.add(Object(O.a)([t,e,n,o]).subscribe(t=>{this.retrieveCodeWords()}))}listenCodeWord(){this.subs.add(this.isCodeWordEnabled$.pipe(Object(P.a)()).subscribe(t=>{t?this.setValidation([this.form.controls.codeWord],[i.H.required]):this.clearValidation([this.form.controls.codeWord])}))}listenRubToNonRussia(){this.subs.add(Object(O.a)([this.isRussianBudget$,this.isRubToRussia$,this.isRubNonRussia$,this.controlsStream.senderAccount,this.controlsStream.contract,this.controlsStream.withinContract,this.controlsStream.bankAccount,this.controlsStream.bank]).subscribe(t=>{var e;const[n,o,s,c,a,r,l,b]=t;this.form.controls.isRubNonRussia.setValue(s);const u=null===(e=a)||void 0===e?void 0:e.contractor.bankCountryCode;s?(u&&u===Te.a.RU?setTimeout(()=>{this.rubNonRussiaCorrespondentBankDropdown.selectByBic(a.contractor.bank.code)},100):u&&u!==Te.a.RU&&setTimeout(()=>{var t;this.rubNonRussiaBankDropdown.selectByBic(null===(t=this.formValue.contract)||void 0===t?void 0:t.contractor.bank.code)},100),this.clearValidation([this.form.controls.bank,this.form.controls.bankLabel],!1),this.setValidation([this.form.controls.rubNonRussiaCorrespondentBankLabel],[i.H.required]),this.setValidation([this.form.controls.rubNonRussiaCorrespondentIban],[i.H.required,Oo])):(r?this.clearValidation([this.form.controls.bank,this.form.controls.bankLabel],!1):(this.setValidation([this.form.controls.bank],[i.H.required],!1),this.setValidation([this.form.controls.bankLabel],[i.H.required,t=>{var e,n,o,i,s,a;return this.currentCountryCode===Te.a.RU&&(null===(n=null===(e=c)||void 0===e?void 0:e.balance)||void 0===n?void 0:n.currency)===K.a.RUB&&Io(l)&&No(null===(o=b)||void 0===o?void 0:o.bic)&&this.isRussianBudgetDisabled?{rubBudgetDisabled:!0}:this.currentCountryCode===Te.a.RU&&(null===(s=null===(i=c)||void 0===i?void 0:i.balance)||void 0===s?void 0:s.currency)===K.a.RUB&&Io(l)&&!No(null===(a=b)||void 0===a?void 0:a.bic)?{rubBudgetWrongBic:!0}:null}])),this.clearValidation([this.form.controls.rubNonRussiaCorrespondentBankLabel,this.form.controls.rubNonRussiaCorrespondentIban]))}))}listenRubNonRussiaCorrespondentBank(){this.subs.add(this.controlsStream.rubNonRussiaBank.subscribe(t=>{var e;(null===(e=t)||void 0===e?void 0:e.cityName)&&this.form.controls.cityName.setValue(t.cityName)}))}applyRubPaymentRules(t){t&&(this.applyRubPurposeRules(),t===Te.a.RU?(this.isRubNonRussia$.next(!1),this.isRubToRussia$.next(!0),this.applyRubToRussiaKvoAndKioRules(),this.applyRubToRussiaPayCommissionRules()):(this.isRubNonRussia$.next(!0),this.isRubToRussia$.next(!1),this.applyRubToNonRussiaCorrespondentRules(),this.applyRubToNonRussiaKvoAndKioRules()))}applyRubPurposeRules(){this.masks.purpose=H.a.foreignCyrillic}applyRubToRussiaKvoAndKioRules(){this.isKvoEnabled$.next(!0),this.isKioEnabled$.next(!0),this.isKppEnabled$.next(!0)}applyRubToRussiaPayCommissionRules(){this.canPayCommission=!1,this.form.controls.payComission.setValue(!1)}applyRubToNonRussiaCorrespondentRules(){this.cityPlaceholder$.next("CURRENCY_PAYMENT.RECIPIENT.CITY_BANK")}applyRubToNonRussiaKvoAndKioRules(){this.isKvoEnabled$.next(!0),this.isKioEnabled$.next(!1),this.isKppEnabled$.next(!1)}applyDefaultPaymentRules(){this.isRubNonRussia$.next(!1),this.applyDefaultPaymentPurposeRules(),this.applyDefaultPaymentKvoAndKioRules(),this.applyDefaultPaymentPayCommissionRules(),this.applyDefaultPaymentCodeWordRules()}applyDefaultPaymentPayCommissionRules(){this.canPayCommission=!0}applyDefaultPaymentPurposeRules(){this.masks.purpose=H.a.foreignLatin}applyDefaultPaymentKvoAndKioRules(){this.isKioEnabled$.next(!1),this.isKvoEnabled$.next(!1),this.isKppEnabled$.next(!1)}applyDefaultPaymentCodeWordRules(){this.isCodeWordEnabled$.next(!1)}applyChinaPaymentRules(t){t||(this.form.controls.countryCode.setValue(Te.a.CN),this.hasDefaultCity=!1,this.retrieveCodeWords(Te.a.CN)),this.isCodeWordEnabled$.next(!0),this.codeWordLabel$.next("CURRENCY_PAYMENT.RECIPIENT.CODEWORD")}knpIsChanged(){this.subs.add(Object(O.a)([this.controlsStream.senderAccount,this.controlsStream.contractId]).subscribe(t=>{const e=[i.H.required,i.H.min(this.paymentsService.rules.minAmount),i.H.max(this.paymentsService.rules.maxAmount),t=>{var e;return 0===(null===(e=t)||void 0===e?void 0:e.value)?{cantBeZero:!0}:null}];e.push(t=>{const e=this.maskService.getNumberedAmount(t.value);if(!this.isForeignContractDisabled&&!this.withinContract)return e>this.contractMaxAmount.amount?-1!==Eo.indexOf(this.formValue.knp)?null:{mustIncludeContract:!0}:null}),this.setValidation([this.form.controls.amount],e,!1)}))}}return t.\u0275fac=function(e){return new(e||t)(R.Qb(G.b),R.Qb(Te.g),R.Qb(Oe.a),R.Qb(p.a),R.Qb(p.c),R.Qb(Te.c),R.Qb(at.a),R.Qb(a.e),R.Qb(je.c),R.Qb(c.q),R.Qb(Te.f),R.Qb(Te.e),R.Qb(s.b),R.Qb(G.c),R.Qb(q.b),R.Qb(l.c),R.Qb(Te.b),R.Qb(We.c),R.Qb(Me.a),R.Qb(Pe.a))},t.\u0275cmp=R.Kb({type:t,selectors:[["j-currency-payment"]],viewQuery:function(t,e){var n;1&t&&(R.Oc(ze,!0),R.Yc(Je,!0),R.Yc(Ze,!0),R.Yc(tn,!0),R.Yc(en,!0),R.Yc(nn,!0),R.Yc(on,!0),R.Yc(sn,!0),R.Yc(cn,!0),R.Yc(an,!0)),2&t&&(R.Ec(n=R.jc())&&(e.emailOnSuccess=n.first),R.Ec(n=R.jc())&&(e.senderAccountDropdown=n.first),R.Ec(n=R.jc())&&(e.contractsSelect=n.first),R.Ec(n=R.jc())&&(e.contractDetails=n.first),R.Ec(n=R.jc())&&(e.bankDropdown=n.first),R.Ec(n=R.jc())&&(e.intermediaryBankDropdown=n.first),R.Ec(n=R.jc())&&(e.commissionAccountDropdown=n.first),R.Ec(n=R.jc())&&(e.rubNonRussiaBankDropdown=n.first),R.Ec(n=R.jc())&&(e.rubNonRussiaCorrespondentBankDropdown=n.first),R.Ec(n=R.jc())&&(e.rubNonRussiaCorrespondentIbanInput=n.first))},features:[R.zb([{provide:T.a,useClass:T.b}]),R.xb],decls:2,vars:2,consts:[["label","PAYMENTS.RESTRICTED_PLACEHOLDER",3,"isRetryable","isLoading","retried",4,"ngIf"],[4,"ngIf"],["label","PAYMENTS.RESTRICTED_PLACEHOLDER",3,"isRetryable","isLoading","retried"],[1,"payment-section"],["autocomplete","off","jInvalidControlScroll","","jFocusableContainer","",3,"formGroup","submit"],["formDirective","ngForm"],[1,"mb-4"],["translate","",1,"mb-4"],[3,"isLoading","isDisabledSelectable","label","hasError","accounts","selected"],["senderAccountDropdown",""],[1,"j-switch-wrap","form-group"],[3,"formControl"],[1,"ml-3"],["translate",""],["class","contracts-description",3,"jLoading","jLoadingInverted","is-loading",4,"ngIf"],[1,"form-section"],[1,"recipient-title","mb-4"],["translate","",1,"m-0"],["class","btn btn-link p-0 p3","type","button","translate","CURRENCY_PAYMENT.CONTRACTS_DICTIONARY.OPEN",3,"click",4,"ngIf"],["class","btn btn-link p-0 p3","type","button","translate","CURRENCY_PAYMENT.DICTIONARY.OPEN",3,"click",4,"ngIf"],[1,"form-group"],["clearable","true"],["type","text","jFocusOnReturn","","jFormInput","",1,"form-control",3,"mask","dropSpecialCharacters","maxlength","formControl","paste"],["countryWrapper",""],["bindValue","code",3,"appendTo","jFocusOnReturn","formControl","readonly","clearable","searchFn","items","change","focus","search"],["countrySelect",""],["j-option-tmp",""],["j-label-tmp",""],[3,"control","errorMessages"],["class","form-group",4,"ngIf"],["type","text","jFormInput","","jFocusOnReturn","","jUppercase","",1,"form-control",3,"mask","formControl"],["accountInput","jFormInput"],["class","j-switch-wrap form-group",4,"ngIf"],["type","text","jFormInput","","jFocusOnReturn","",1,"form-control",3,"mask","formControl"],["allowAuto","true",3,"datesEnabled","formControl","formatValue","jFocusOnReturn","label","minDate","maxDate","helperText"],["datePicker",""],["knpWrapper",""],["bindLabel","label","bindValue","code",3,"jFocusOnReturn","appendTo","formControl","clearable","searchMask","shadow","compareWith","items","change"],["knpSelect",""],["j-header-tmp",""],[1,"form-group","position-relative"],[1,"payment-section--purpose-length","p3","text-gray"],["jFocusOnReturn","","jFormInput","","rows","5",1,"form-control",3,"formControl","mask","dropSpecialCharacters"],["purpose",""],["jBottomLine","","class","j-form-field-bottom",4,"ngIf"],["translate","",1,"j-input-helper","text-muted","mt-1","mb-0","p3"],[3,"hidden"],[3,"isLoading","accounts","isDisabledSelectable","hasError","label","selected"],["commissionAccountDropdown",""],["class","j-input-helper text-muted comission-message p3",4,"ngIf"],["clearable","true",3,"floatLabel"],["jFocusOnReturn","","jFormInput","","jCursorBound","","jReplaceDot","","thousandSeparator"," ","decimalMarker",",","maxlength","29",1,"form-control",3,"suffix","placeholder","mask","dropSpecialCharacters","formControl","paste"],["class","j-input-helper text-muted mt-1 p3",4,"ngIf"],[1,"j-input-helper","text-muted","mt-2","p3","position-relative"],[4,"ngIf","ngIfElse"],["commission",""],["class","mt-2","translate","CURRENCY_PAYMENT.COMISSION.DESCRIPTION",4,"ngIf"],[1,"list-group"],["class","list-group-item d-flex align-items-center",4,"ngIf"],[1,"list-group-item","d-flex","align-items-center"],[1,"ml-3","flex-grow-1"],["class","mt-1",4,"ngIf"],["class","my-3 p3 text-muted",3,"innerHTML",4,"ngIf"],[1,"payment-section--submit","form-group","pt-4"],["type","ball-scale-ripple-multiple","size","large","color","#d6dadf","zIndex","3","bdColor","rgba(246, 247, 248, 0.3)",3,"name","fullScreen"],[3,"contract",4,"ngIf"],["amountInfo",""],["kbeInfo",""],["kppInfo",""],["oktmoInfo",""],["basisInfo",""],["budgetPeriodInfo",""],[1,"contracts-description",3,"jLoading","jLoadingInverted"],[1,"text-gray",3,"innerHTML"],["id","contractGroup",1,"form-group","mt-4"],["contractsWrapper",""],["bindValue","id",3,"loading","appendTo","jFocusOnReturn","formControl","clearable","searchFn","items","change"],["contractsSelect",""],["j-notfound-tmp",""],["href","#","jSuffix","","class","mr-1 p3","translate","",3,"click",4,"ngIf"],["class","mb-3",4,"ngIf"],[1,"mb-3"],["type","button","class","list-dictionary form-section--action btn btn-xs btn-link float-right",3,"click",4,"ngIf"],["type","button",1,"list-dictionary","form-section--action","btn","btn-xs","btn-link","float-right",3,"click"],[1,"j-option-label","text-wrap","p3"],[1,"text-dark","contract-row"],[3,"money"],[1,"text-muted","contract-row"],["translate","CURRENCY_PAYMENT.CONTRACTS.SELECT.REMAINDER"],[1,"contracts__empty"],["src","assets/img/payments/no_contract.svg"],[1,"mx-auto","mt-3","p2","text-muted",3,"innerHTML"],["href","#",1,"link","d-inline-block","mt-3",3,"click"],["label","CURRENCY_PAYMENT.CONTRACTS.NOT_FOUND"],[1,"text-center","my-2"],["href","#",1,"link","d-inline-block",3,"click"],["href","#","jSuffix","","translate","",1,"mr-1","p3",3,"click"],["type","button","translate","CURRENCY_PAYMENT.CONTRACTS_DICTIONARY.OPEN",1,"btn","btn-link","p-0","p3",3,"click"],["type","button","translate","CURRENCY_PAYMENT.DICTIONARY.OPEN",1,"btn","btn-link","p-0","p3",3,"click"],[1,"j-option-label","text-wrap"],["type","text","jFocusOnReturn","","jFormInput","",1,"form-control",3,"mask","dropSpecialCharacters","maxlength","formControl"],[1,"kbe-account-row"],["type","text","jFocusOnReturn","","jFormInput","","maxlength","4",1,"form-control",3,"formControl"],["type","text","jFocusOnReturn","","jFormInput","","maxlength","28",1,"form-control",3,"formControl"],["type","text","jFocusOnReturn","","jFormInput","","maxlength","10",1,"form-control",3,"formControl"],["type","text","jFocusOnReturn","","jFormInput","","maxlength","25",1,"form-control",3,"formControl"],[1,"mt-0"],["type","text","jFocusOnReturn","","jFormInput","","maxlength","70",1,"form-control",3,"formControl"],[3,"labelText","placeholderText","labelControl","errorMessages","bankControl"],["rubNonRussiaCorrespondentBankDropdown",""],["type","text","jFormInput","","jFocusOnReturn","","jUppercase","",1,"form-control",3,"validation","mask","formControl"],["rubNonRussiaCorrespondentIbanInput","jFormInput"],["type","text","jFormInput","","jFocusOnReturn","",1,"form-control",3,"mask","jShadow","dropSpecialCharacters","formControl"],["href","javascript:void(0)","jSuffix","","tooltipClass","tooltip-light tooltip-large","triggers","mouseenter:mouseleave",1,"mr-1","link-gray",3,"ngbTooltip","inlineSVG"],["rubNonRussiaBankDropdown",""],[3,"placeholderText","labelControl","errorMessages","bankControl"],["bankDropdown",""],["class","j-input-helper text-muted mt-1 mb-0 p3","translate","",4,"ngIf"],[1,"intermediatory-content","ml-3"],["class","intermediatory-input",3,"placeholderText","labelControl","bankControl","errorMessages",4,"ngIf"],["translate","",1,"d-block","text-gray"],[1,"intermediatory-input",3,"placeholderText","labelControl","bankControl","errorMessages"],["intermediaryBankDropdown",""],["type","text","jFocusOnReturn","","jFormInput","","maxlength","12",1,"form-control",3,"mask","dropSpecialCharacters","formControl"],["type","text","jFocusOnReturn","","jFormInput","",1,"form-control",3,"mask","jShadow","validation","formControl"],[1,"custom-control","custom-checkbox"],["type","checkbox","id","isRussianTaxPayer",1,"custom-control-input",3,"formControl"],["for","isRussianTaxPayer",1,"custom-control-label"],["translate","CURRENCY_PAYMENT.RUSSIAN_BUDGET.IS_TAXPAYER",1,"p3","text-muted"],["class","russian-row",4,"ngIf"],[1,"russian-row"],["kbkRowWrapper",""],["kbkWrapper",""],[3,"loading","appendTo","jFocusOnReturn","formControl","clearable","searchFn","items"],["kbkSelect",""],["type","text","jFocusOnReturn","","jFormInput","",1,"form-control",3,"mask","jShadow","formControl"],["payerStatusWrap",""],["bindValue","code",3,"loading","appendTo","jFocusOnReturn","formControl","clearable","searchFn","items"],["payerStatusSelect",""],["type","checkbox","id","hasRussianBudgetExtras",1,"custom-control-input",3,"formControl"],["for","hasRussianBudgetExtras",1,"custom-control-label"],["translate","CURRENCY_PAYMENT.RUSSIAN_BUDGET.EXTRAS",1,"p3","text-muted"],["type","text","jFocusOnReturn","","jFormInput","","maxlength","12",1,"form-control",3,"formControl"],["label","CURRENCY_PAYMENT.RUSSIAN_BUDGET.KBK_NOT_FOUND"],["label","CURRENCY_PAYMENT.RUSSIAN_BUDGET.STATUS_NOT_FOUND"],["type","text","jFocusOnReturn","","jFormInput","",1,"form-control",3,"mask","jShadow","dropSpecialCharacters","formControl"],["type","text","jFocusOnReturn","","jFormInput","",1,"form-control",3,"formControl"],[1,"mr-2",3,"inlineSVG"],["translate","",1,"p2","m-0"],["translate","",1,"p3","text-gray"],["codeWordsWrapper",""],["codeWordsSelect",""],["jBottomLine","",1,"j-form-field-bottom"],[1,"text-truncate","small"],[1,"j-input-helper","text-muted","comission-message","p3"],[3,"innerHTML"],[1,"j-input-helper","text-muted","mt-1","p3"],[1,"text-danger","mr-1",3,"translate","translateParams"],["href","#",1,"link-blue","contracts-scroll-link",3,"click"],["translate","CURRENCY_PAYMENT.COMISSION.DESCRIPTION",1,"mt-2"],["translate","",1,"text-gray"],[1,"text-gray"],[1,"mt-1"],["type","email","jFormInput","","jFocusOnReturn","","autocomplete","off",1,"form-control",3,"ngbTypeahead","formControl","focus"],["emailOnSuccess","ngbTypeahead"],[1,"my-3","p3","text-muted",3,"innerHTML"],["type","button",1,"btn","btn-link","btn-static",3,"click"],["type","submit",1,"btn","btn-primary","btn-static","ml-3"],["type","submit","translate","",1,"btn","btn-outline-primary","btn-static"],[3,"contract"],["contractDetails",""],[1,"p4",3,"innerHTML"]],template:function(t,e){1&t&&(R.Rc(0,rn,1,2,"j-restricted-placeholder",0),R.Rc(1,Ro,157,144,"ng-container",1)),2&t&&(R.uc("ngIf",e.isRestricted),R.Ab(1),R.uc("ngIf",!e.isRestricted))},directives:[o.u,xe.a,i.J,i.u,_e.b,Nt.b,i.l,a.a,De.a,we.a,i.t,i.i,z.a,Vt.a,tt.a,i.c,Nt.a,s.a,i.o,Ye.a,Ue.j,Ue.d,Ot.a,Le.a,Fe.a,Ue.b,$e.a,Be.a,Ke.a,He.a,Ue.h,Ft.a,jt.a,It.a,Lt,Qe.a,c.E,kt.a,i.a,Ge.a,c.G,te,qe.a],pipes:[o.b,a.d,Xe.a],styles:[".payments__header{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;-webkit-box-pack:justify;justify-content:space-between;margin-bottom:1.5rem}.payment-section--submit{text-align:right}.payment-section{max-width:582px}.payment-section--purpose-length{position:absolute;right:.8rem;top:.4rem;z-index:1}.payment-section--summary .payment-section--amount-warn{color:#666c72}@media(min-width:960px){.payment-section--summary .payment-section--amount-warn{width:70%;text-align:right;margin-left:auto}}.kbe-account-row{margin-bottom:1rem}@media(min-width:960px){.kbe-account-row{display:grid;-webkit-column-gap:12px;-moz-column-gap:12px;column-gap:12px;grid-template-columns:130px 1fr}}@media(min-width:960px){.kbe-account-row .form-group{margin-bottom:0}}.intermediatory-content{width:100%}.intermediatory-input{margin-top:.5rem;position:relative;margin-bottom:.25rem}.intermediatory-input .bic-dropdown{left:0;right:0}.contract-row{display:-webkit-box;display:flex;width:100%;-webkit-box-pack:justify;justify-content:space-between}.contract-row>:first-child{padding-right:1rem}.list-dictionary{display:-webkit-inline-box;display:inline-flex;-webkit-box-align:center;align-items:center;line-height:1}.list-dictionary span{display:block}.comission-message{margin-top:-12px}.j-select .j-spinner-loader{top:19px}.contracts__empty{text-align:center;max-width:312px;margin:0 auto}.russian-row{position:relative;display:-webkit-box;display:flex;-webkit-box-pack:justify;justify-content:space-between;margin-bottom:1rem}.russian-row>*{width:100%;max-width:calc(50% - 6px)}.contracts-description{position:relative}.contracts-description.is-loading small{opacity:.5}.contracts-scroll-link{border-bottom:1px dashed #1586bb}.contracts-scroll-link:hover{border-color:#ef5630}.recipient-title{display:-webkit-box;display:flex;-webkit-box-pack:justify;justify-content:space-between;-webkit-box-align:center;align-items:center}"],encapsulation:2}),t})();const Wo=["paymentComponent"];let Mo=(()=>{class t{constructor(t,e,n){this.router=t,this.navService=e,this.paymentsService=n}ngOnInit(){this.title$=this.paymentsService.rootTitle$.pipe(Object(y.a)(t=>`CURRENCY_PAYMENT.${t}`))}onClose(){this.navService.retrieveContractBadges(),this.navService.retrieveLetterBadges(),this.router.navigate(["/"])}ngAfterViewInit(){this.formDirective=this.paymentComponent.formDirective,this.form=this.paymentComponent.form}}return t.\u0275fac=function(e){return new(e||t)(R.Qb(p.c),R.Qb(v.a),R.Qb(C.c))},t.\u0275cmp=R.Kb({type:t,selectors:[["j-currency-payments"]],viewQuery:function(t,e){var n;1&t&&R.Yc(Wo,!0),2&t&&R.Ec(n=R.jc())&&(e.paymentComponent=n.first)},features:[R.zb([{provide:T.a,useClass:T.b}])],decls:9,vars:5,consts:[[3,"closed"],[1,"f-page-title"],["paymentComponent",""]],template:function(t,e){1&t&&(R.Wb(0,"f-page",0),R.ic("closed",(function(t){return e.onClose()})),R.Wb(1,"f-page-header"),R.Wb(2,"h1",1),R.Tc(3),R.nc(4,"translate"),R.nc(5,"async"),R.Vb(),R.Vb(),R.Wb(6,"f-page-body"),R.Rb(7,"j-currency-payment",null,2),R.Vb(),R.Vb()),2&t&&(R.Ab(3),R.Vc(" ",R.oc(4,1,R.oc(5,3,e.title$))," "))},directives:[E.a,S.a,V.a,jo],pipes:[a.d,o.b],styles:[""]}),t})();var Po=n("aDQ/"),xo=n("7o/Q");class _o{call(t,e){return e.subscribe(new Do(t))}}class Do extends xo.a{constructor(t){super(t),this.hasPrev=!1}_next(t){let e;this.hasPrev?e=[this.prev,t]:this.hasPrev=!0,this.prev=t,e&&this.destination.next(e)}}let wo=(()=>{class t{constructor(){this.subs=new Et.a,this.itemChanges$=new I.a(0),this.routerTrigger$=this.itemChanges$.pipe(Object(_.a)(this.itemChanges$.getValue()),t=>t.lift(new _o),Object(y.a)(([t,e])=>{const n={offsetEnterX:0,offsetLeaveX:0};return 0!==t&&(n.offsetEnterX=t>e?-100:100,n.offsetLeaveX=t>e?100:-100),{value:e,params:n}}),Object(ve.a)())}ngOnInit(){this.subs.add(this.routerTrigger$.subscribe())}ngOnDestroy(){this.subs.unsubscribe()}onActivate(t,e){e.activatedRouteData&&e.activatedRouteData.animation&&e.activatedRouteData.index!==this.itemChanges$.getValue()&&this.itemChanges$.next(e.activatedRouteData.index)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=R.Lb({type:t}),t})();const Yo=function(t){return[t]};let Uo=(()=>{class t extends wo{constructor(t,e,n){super(),this.navService=t,this.router=e,this.paymentsService=n,this.routes=h.a}ngOnInit(){super.ngOnInit(),this.title$=this.paymentsService.rootTitle$.pipe(Object(y.a)(t=>`PAYMENTS.${t}`))}onClose(){this.navService.retrieveContractBadges(),this.navService.retrieveLetterBadges(),this.router.navigate(["/"])}}return t.\u0275fac=function(e){return new(e||t)(R.Qb(v.a),R.Qb(p.c),R.Qb(C.c))},t.\u0275cmp=R.Kb({type:t,selectors:[["j-tenge-payments"]],features:[R.zb([{provide:T.a,useClass:T.b}]),R.xb],decls:21,vars:23,consts:[[3,"closed"],[1,"f-page-title"],[1,"f-page-tabs-wrap"],[1,"f-page-tabs"],["routerLinkActive","active",3,"routerLink"],[1,"outlet-animation-wrapper"],["outlet","outlet"]],template:function(t,e){1&t&&(R.Wb(0,"f-page",0),R.ic("closed",(function(t){return e.onClose()})),R.Wb(1,"f-page-header"),R.Wb(2,"h1",1),R.Tc(3),R.nc(4,"translate"),R.nc(5,"async"),R.Vb(),R.Wb(6,"div",2),R.Wb(7,"nav",3),R.Wb(8,"a",4),R.Tc(9),R.nc(10,"translate"),R.Vb(),R.Wb(11,"a",4),R.Tc(12),R.nc(13,"translate"),R.Vb(),R.Wb(14,"a",4),R.Tc(15),R.nc(16,"translate"),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Wb(17,"f-page-body"),R.Wb(18,"div",5),R.Rb(19,"router-outlet",null,6),R.Vb(),R.Vb(),R.Vb()),2&t&&(R.Ab(3),R.Vc(" ",R.oc(4,7,R.oc(5,9,e.title$))," "),R.Ab(5),R.uc("routerLink",R.zc(17,Yo,e.routes.tenge.order)),R.Ab(1),R.Vc(" ",R.oc(10,11,"PAYMENTS.TABS.PAYMENT_ORDER")," "),R.Ab(2),R.uc("routerLink",R.zc(19,Yo,e.routes.tenge.state.root)),R.Ab(1),R.Vc(" ",R.oc(13,13,"PAYMENTS.TABS.BUDGET")," "),R.Ab(2),R.uc("routerLink",R.zc(21,Yo,e.routes.tenge.salary)),R.Ab(1),R.Vc(" ",R.oc(16,15,"PAYMENTS.TABS.SALARY")," "))},directives:[E.a,S.a,p.f,p.e,V.a,p.h],pipes:[a.d,o.b],styles:[".payment-section--submit{text-align:right}.payment-section{max-width:582px}.payment-section--purpose-length{position:absolute;right:.8rem;top:.4rem;z-index:1}.payment-section--summary .payment-section--amount-warn{color:#666c72}"],encapsulation:2,data:{animation:[Po.c]}}),t})();var Lo=n("gcYM"),Fo=n("jMpN"),$o=n("Dwsl"),Bo=n("+uUT"),Ko=n("zOyH"),Ho=n("ttPG"),Qo=n("0eeg"),Go=n("Wo9y"),qo=n("EBek"),Xo=n("vZvt"),zo=n("570E"),Jo=n("zdqJ"),Zo=n("mCLR"),ti=n("VnnJ"),ei=n("+BgI"),ni=n("wtV8"),oi=n("kFTB"),ii=n("wGsJ"),si=n("I0Rk");const ci=["vinTpl"],ai=["protocolNumberTpl"];function ri(t,e){if(1&t){const t=R.Xb();R.Wb(0,"j-restricted-placeholder",2),R.ic("retried",(function(e){return R.Ic(t),R.mc().updatePermissions()})),R.Vb()}if(2&t){const t=R.mc();R.uc("isRetryable",t.isPermissionsUpdateAllowed)("isLoading",t.isPermissionsUpdating)}}function li(t,e){if(1&t&&(R.Wb(0,"div",54),R.Wb(1,"p",55),R.Tc(2),R.Vb(),R.Wb(3,"p",56),R.Tc(4),R.nc(5,"translate"),R.Vb(),R.Vb()),2&t){const t=e.item;R.Ab(2),R.Uc(t.label),R.Ab(2),R.Wc("",R.oc(5,3,"PAYMENTS.FORM.BIN")," ",t.bin,"")}}function bi(t,e){if(1&t){const t=R.Xb();R.Wb(0,"div"),R.Wb(1,"button",57),R.ic("click",(function(e){R.Ic(t),R.mc(2);const n=R.Fc(19);return R.mc().openDepartmentDictionary(n,e)})),R.Tc(2),R.nc(3,"translate"),R.Vb(),R.Wb(4,"p",58),R.Tc(5),R.nc(6,"translate"),R.Vb(),R.Vb()}2&t&&(R.Ab(2),R.Vc(" ",R.oc(3,2,"PAYMENTS.DICTIONARY.TITLE")," "),R.Ab(3),R.Vc(" ",R.oc(6,4,"PAYMENTS.DICTIONARY.FREQUENT_UGD")," "))}function ui(t,e){1&t&&R.Rc(0,bi,7,6,"div",1),2&t&&R.uc("ngIf",!e.searchTerm)}function mi(t,e){1&t&&R.Rb(0,"div",9)}function di(t,e){if(1&t){const t=R.Xb();R.Wb(0,"div"),R.Wb(1,"button",57),R.ic("click",(function(e){R.Ic(t),R.mc(2);const n=R.Fc(67);return R.mc().openKBKDictionary(n,e)})),R.Tc(2),R.nc(3,"translate"),R.Vb(),R.Wb(4,"p",58),R.Tc(5),R.nc(6,"translate"),R.Vb(),R.Vb()}2&t&&(R.Ab(2),R.Vc(" ",R.oc(3,2,"PAYMENTS.DICTIONARY.TITLE")," "),R.Ab(3),R.Vc(" ",R.oc(6,4,"PAYMENTS.DICTIONARY.FREQUENT_KBK")," "))}function pi(t,e){1&t&&R.Rc(0,di,7,6,"div",1),2&t&&R.uc("ngIf",!e.searchTerm)}function hi(t,e){if(1&t){const t=R.Xb();R.Wb(0,"div"),R.Wb(1,"button",57),R.ic("click",(function(e){R.Ic(t),R.mc(2);const n=R.Fc(77);return R.mc().openKnpDictionary(n,e)})),R.Tc(2),R.nc(3,"translate"),R.Vb(),R.Wb(4,"p",59),R.Tc(5),R.nc(6,"translate"),R.Vb(),R.Wb(7,"p",60),R.Tc(8),R.nc(9,"translate"),R.Vb(),R.Vb()}2&t&&(R.Ab(2),R.Vc(" ",R.oc(3,3,"PAYMENTS.DICTIONARY.TITLE")," "),R.Ab(3),R.Uc(R.oc(6,5,"PAYMENTS.DICTIONARY.FREQUENT_KNP")),R.Ab(3),R.Uc(R.oc(9,7,"PAYMENTS.DICTIONARY.KNP_DESCRIPTION")))}function fi(t,e){1&t&&R.Rc(0,hi,10,9,"div",1),2&t&&R.uc("ngIf",!e.searchTerm)}function gi(t,e){if(1&t&&(R.Wb(0,"div",61),R.Wb(1,"div",62),R.Tc(2),R.Vb(),R.Vb()),2&t){const t=e.ngIf;R.Ab(2),R.Vc(" ",t," ")}}function Ai(t,e){1&t&&R.Rb(0,"div",9)}function Ti(t,e){if(1&t&&(R.Wb(0,"div",63),R.Rb(1,"span",64),R.nc(2,"translate"),R.Vb()),2&t){const t=e.ngIf;R.Ab(1),R.uc("innerHTML",R.oc(2,1,t),R.Jc)}}function yi(t,e){1&t&&(R.Ub(0),R.Tc(1),R.nc(2,"translate"),R.Tb()),2&t&&(R.Ab(1),R.Vc(" ",R.oc(2,1,"PAYMENTS.COMMISSION_CALC_AUTO")," "))}function Ri(t,e){if(1&t&&(R.Tc(0),R.nc(1,"translate"),R.nc(2,"amountFormat"),R.nc(3,"async")),2&t){const t=R.mc(2);R.Wc(" ",R.oc(1,2,"PAYMENTS.COMMISSION"),": ",R.oc(2,4,R.oc(3,6,t.commission$))," \u20b8 ")}}function vi(t,e){if(1&t){const t=R.Xb();R.Ub(0),R.Wb(1,"button",65),R.ic("click",(function(e){return R.Ic(t),R.mc(2).saveToDraft()})),R.Tc(2),R.nc(3,"translate"),R.Vb(),R.Wb(4,"button",66),R.Tc(5),R.nc(6,"translate"),R.Vb(),R.Tb()}if(2&t){const t=R.mc(2);R.Ab(2),R.Uc(R.oc(3,2,"PAYMENTS.FORM.SAVE")),R.Ab(3),R.Vc("",R.oc(6,4,t.submitLabel)," ")}}function Ci(t,e){1&t&&(R.Ub(0),R.Wb(1,"button",67),R.Tc(2),R.nc(3,"translate"),R.Vb(),R.Tb()),2&t&&(R.Ab(2),R.Uc(R.oc(3,1,"PAYMENTS.FORM.SAVE_EDIT")))}function Ei(t,e){if(1&t&&(R.Wb(0,"div",68),R.Wb(1,"div",69),R.Rb(2,"j-period-input",70,71),R.nc(4,"translate"),R.Vb(),R.Vb()),2&t){const t=R.Fc(3),e=R.mc(2);R.Ab(2),R.uc("hasError",e.hasError(t,e.form.controls.period))("label",R.oc(4,3,"SHARED.TIME.PERIOD"))("formControl",e.form.controls.period)}}function Si(t,e){if(1&t&&(R.Wb(0,"div",68),R.Wb(1,"div",72),R.Rb(2,"j-period-input",70,73),R.nc(4,"translate"),R.nc(5,"translate"),R.Vb(),R.Wb(6,"div",72),R.Rb(7,"j-period-input",70,74),R.nc(9,"translate"),R.nc(10,"translate"),R.Vb(),R.Vb()),2&t){const t=R.Fc(3),e=R.Fc(8),n=R.mc(2);R.Ab(2),R.xc("label","",R.oc(4,8,"SHARED.TIME.MONTH")," ",R.oc(5,10,"SHARED.PREPOSITION.FROM"),""),R.uc("hasError",n.hasError(t,n.form.controls.periodStart)||n.hasError(e,n.form.controls.periodEnd))("formControl",n.form.controls.periodStart),R.Ab(5),R.xc("label","",R.oc(9,12,"SHARED.TIME.MONTH")," ",R.oc(10,14,"SHARED.PREPOSITION.TO"),""),R.uc("hasError",n.hasError(e,n.form.controls.periodEnd)||n.hasError(t,n.form.controls.periodStart))("formControl",n.form.controls.periodEnd)}}function Vi(t,e){if(1&t&&(R.Wb(0,"j-form-field",15),R.Wb(1,"j-label"),R.Tc(2),R.nc(3,"translate"),R.Vb(),R.Rb(4,"input",75),R.Rb(5,"j-error",19),R.Vb(),R.Wb(6,"div",63),R.Rb(7,"span",64),R.Vb()),2&t){const t=R.mc(2);R.Ab(2),R.Uc(R.oc(3,5,"PAYMENTS.FORM.VIN")),R.Ab(2),R.uc("formControl",t.form.controls.vin),R.Ab(1),R.uc("control",t.form.controls.vin)("errorMessages",t.errors.vin),R.Ab(2),R.uc("innerHTML",t.vinMessage,R.Jc)}}function Ni(t,e){if(1&t&&(R.Wb(0,"j-form-field",15),R.Wb(1,"j-label"),R.Tc(2),R.nc(3,"translate"),R.Vb(),R.Rb(4,"input",21),R.Vb()),2&t){const t=R.mc(2);R.Ab(2),R.Uc(R.oc(3,3,"PAYMENTS.FORM.PROTOCOL_NUMBER")),R.Ab(2),R.uc("mask",t.masks.protocolNumber.mask)("formControl",t.form.controls.protocolNumber)}}function Ii(t,e){if(1&t){const t=R.Xb();R.Ub(0),R.Wb(1,"form",3,4),R.ic("submit",(function(e){return R.Ic(t),R.mc().onSubmit(e)})),R.Wb(3,"div",5),R.Wb(4,"fieldset"),R.Wb(5,"div",6),R.Wb(6,"h2",7),R.Tc(7),R.nc(8,"translate"),R.Vb(),R.Wb(9,"button",8),R.ic("click",(function(e){R.Ic(t);const n=R.Fc(19);return R.mc().openDepartmentDictionary(n,e)})),R.Tc(10),R.nc(11,"translate"),R.Vb(),R.Vb(),R.Wb(12,"div",9),R.Wb(13,"j-form-field",null,10),R.Wb(15,"j-label"),R.Tc(16),R.nc(17,"translate"),R.Vb(),R.Wb(18,"j-select",11,12),R.nc(20,"async"),R.Rc(21,li,6,5,"ng-template",13),R.Rc(22,ui,1,1,"ng-template",14),R.Vb(),R.Vb(),R.Vb(),R.Wb(23,"div",9),R.Wb(24,"j-form-field",15),R.Rb(25,"j-entity-logo",16),R.nc(26,"bankFromAccount"),R.Wb(27,"j-label"),R.Tc(28),R.nc(29,"translate"),R.Vb(),R.Rb(30,"input",17,18),R.Rb(32,"j-error",19),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Wb(33,"div",5),R.Wb(34,"fieldset"),R.Wb(35,"legend",20),R.Tc(36),R.nc(37,"translate"),R.Vb(),R.Wb(38,"div",9),R.Wb(39,"j-form-field"),R.Wb(40,"j-label"),R.Tc(41),R.nc(42,"translate"),R.Vb(),R.Rb(43,"input",21),R.Vb(),R.Vb(),R.Rc(44,mi,1,0,"div",22),R.Wb(45,"div",9),R.Wb(46,"ul",23),R.Wb(47,"li",24),R.Rb(48,"j-switch",25),R.Wb(49,"span",26),R.Tc(50),R.nc(51,"translate"),R.Rb(52,"br"),R.Wb(53,"small",27),R.Tc(54),R.nc(55,"translate"),R.Wb(56,"span",28),R.Tc(57),R.nc(58,"async"),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Wb(59,"div",9),R.Wb(60,"div",9),R.Wb(61,"j-form-field",null,29),R.Wb(63,"j-label"),R.Tc(64),R.nc(65,"translate"),R.Vb(),R.Wb(66,"j-select",30,31),R.ic("change",(function(e){return R.Ic(t),R.mc().onKbkSelect(e)})),R.nc(68,"async"),R.Rc(69,pi,1,1,"ng-template",14),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Wb(70,"div",9),R.Wb(71,"j-form-field",null,32),R.Wb(73,"j-label"),R.Tc(74),R.nc(75,"translate"),R.Vb(),R.Wb(76,"j-select",33,34),R.Rc(78,fi,1,1,"ng-template",14),R.Vb(),R.Vb(),R.Vb(),R.Wb(79,"div",35),R.Wb(80,"span",36),R.Tc(81),R.nc(82,"async"),R.Vb(),R.Wb(83,"j-form-field"),R.Wb(84,"j-label"),R.Tc(85),R.nc(86,"translate"),R.Vb(),R.Rb(87,"textarea",37,38),R.Rb(89,"j-error",19),R.Rc(90,gi,3,1,"div",39),R.nc(91,"async"),R.Vb(),R.Vb(),R.Rc(92,Ai,1,0,"div",22),R.Vb(),R.Vb(),R.Wb(93,"div",5),R.Wb(94,"fieldset"),R.Wb(95,"div",9),R.Wb(96,"j-account-dropdown",40,41),R.ic("selected",(function(e){return R.Ic(t),R.mc().onSenderAccountSelect(e)})),R.nc(98,"async"),R.nc(99,"async"),R.Vb(),R.Vb(),R.Wb(100,"div",9),R.Wb(101,"div",9),R.Wb(102,"j-form-field",42),R.Wb(103,"j-label"),R.Tc(104),R.nc(105,"translate"),R.Vb(),R.Rb(106,"input",43),R.Vb(),R.Rc(107,Ti,3,3,"div",44),R.nc(108,"async"),R.Wb(109,"div",45),R.Rc(110,yi,3,3,"ng-container",46),R.nc(111,"async"),R.Rc(112,Ri,4,8,"ng-template",null,47,R.Sc),R.Vb(),R.Vb(),R.Vb(),R.Wb(114,"div",9),R.Wb(115,"ul",23),R.Wb(116,"li",24),R.Rb(117,"j-switch",25),R.Wb(118,"span",26),R.Tc(119),R.nc(120,"translate"),R.Rb(121,"br"),R.Wb(122,"small",27),R.Tc(123),R.nc(124,"translate"),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Wb(125,"div",48),R.Wb(126,"div",48),R.Rc(127,vi,7,6,"ng-container",1),R.Rc(128,Ci,4,3,"ng-container",1),R.Vb(),R.Vb(),R.Rc(129,Ei,5,5,"ng-template",null,49,R.Sc),R.Rc(131,Si,11,16,"ng-template",null,50,R.Sc),R.Rc(133,Vi,8,7,"ng-template",null,51,R.Sc),R.Rc(135,Ni,5,5,"ng-template",null,52,R.Sc),R.Rb(137,"ngx-spinner",53),R.Rb(138,"ngx-spinner",53),R.Vb(),R.Tb()}if(2&t){const t=R.Fc(14),e=R.Fc(19),n=R.Fc(62),o=R.Fc(67),i=R.Fc(72),s=R.Fc(77),c=R.Fc(113),a=R.Fc(130),r=R.Fc(132),l=R.mc();R.Ab(1),R.uc("formGroup",l.form),R.Ab(6),R.Vc(" ",R.oc(8,72,"PAYMENTS.RECIPIENT.TITLE")," "),R.Ab(3),R.Vc(" ",R.oc(11,74,"PAYMENTS.SELECT_FROM_DICTIONARY")," "),R.Ab(6),R.Uc(R.oc(17,76,"PAYMENTS.FORM.UGD")),R.Ab(2),R.uc("appendTo",t.elementRef.nativeElement)("jFocusOnReturn",e)("formControl",l.form.controls.ugd)("clearable",!1)("searchFn",l.paymentsService.ugdSearchFn)("items",R.oc(20,78,l.ugdStore.items$)),R.Ab(7),R.uc("name",R.oc(26,80,"KZ"+l.form.controls.bankAccount.value)),R.Ab(3),R.Uc(R.oc(29,82,"PAYMENTS.FORM.IBAN")),R.Ab(2),R.uc("jShadow",l.masks.bankAccount.shadow)("dropSpecialCharacters",!0)("mask",l.masks.bankAccount.mask)("formControl",l.form.controls.bankAccount),R.Ab(2),R.uc("control",l.form.controls.bankAccount)("errorMessages",l.errors.bankAccount),R.Ab(4),R.Uc(R.oc(37,84,"PAYMENTS.FORM.DETAILS")),R.Ab(5),R.Uc(R.oc(42,86,"PAYMENTS.FORM.DOCUMENT_NUMBER")),R.Ab(2),R.uc("mask",l.masks.number.mask)("formControl",l.form.controls.number),R.Ab(1),R.uc("ngTemplateOutlet",l.form.controls.intervalEnabled.value?r:a),R.Ab(4),R.uc("formControl",l.form.controls.intervalEnabled),R.Ab(2),R.Vc(" ",R.oc(51,88,"PAYMENTS.FORPERIOD")," "),R.Ab(4),R.Vc(" ",R.oc(55,90,l.intervalSwitchLabel)," "),R.Ab(2),R.uc("hidden",!l.form.controls.intervalEnabled.value),R.Ab(1),R.Vc(": ",R.oc(58,92,l.periodMessage$)," "),R.Ab(7),R.Uc(R.oc(65,94,"PAYMENTS.FORM.KBK")),R.Ab(2),R.uc("jFocusOnReturn",o)("appendTo",n.elementRef.nativeElement)("formControl",l.form.controls.kbk)("clearable",!1)("searchMask",l.masks.kbk.mask)("shadow",l.masks.kbk.shadow)("items",R.oc(68,96,l.kbkStore.items$)),R.Ab(8),R.Uc(R.oc(75,98,"PAYMENTS.FORM.KNP_REGULAR")),R.Ab(2),R.uc("appendTo",i.elementRef.nativeElement)("jFocusOnReturn",s)("formControl",l.form.controls.knp)("clearable",!1)("searchMask",l.masks.knp.mask)("shadow",l.masks.knp.shadow)("items",l.filteredKnpList),R.Ab(5),R.Wc(" ",R.oc(82,100,l.purposeLength$),"/",l.rules.purposeLength,""),R.Ab(4),R.Uc(R.oc(86,102,"PAYMENTS.FORM.PURPOSE")),R.Ab(2),R.uc("formControl",l.form.controls.purpose),R.Ab(2),R.uc("control",l.form.controls.purpose)("errorMessages",l.errors.purpose),R.Ab(1),R.uc("ngIf",R.oc(91,104,l.purposeMessage$)),R.Ab(2),R.uc("ngTemplateOutlet",l.associatedFieldTpl),R.Ab(4),R.uc("isLoading",R.oc(98,106,l.accountStore.fetching$))("label","PAYMENTS.SENDER_ACCOUNT.UNSELECTED")("hasError",l.form.controls.senderAccount.touched&&l.form.controls.senderAccount.errors)("accounts",R.oc(99,108,l.acceptableAccounts$)),R.Ab(6),R.uc("floatLabel","always"),R.Ab(2),R.Uc(R.oc(105,110,"PAYMENTS.FORM.AMOUNT")),R.Ab(2),R.uc("dropSpecialCharacters",!0)("formControl",l.form.controls.amount),R.Ab(1),R.uc("ngIf",R.oc(108,112,l.amountMessage$)),R.Ab(3),R.uc("ngIf",null===R.oc(111,114,l.commission$))("ngIfElse",c),R.Ab(7),R.uc("formControl",l.form.controls.urgent),R.Ab(2),R.Vc("",R.oc(120,116,"PAYMENTS.FORM.URGENT")," "),R.Ab(4),R.Uc(R.oc(124,118,"PAYMENTS.URGENT_HELPER")),R.Ab(4),R.uc("ngIf",l.restoredData.status!==l.PAYMENT_STATUS.CREATED),R.Ab(1),R.uc("ngIf",l.restoredData.status===l.PAYMENT_STATUS.CREATED),R.Ab(9),R.uc("name",l.SPINNER)("fullScreen",!1),R.Ab(1),R.uc("name",l.SPINNER)("fullScreen",!1)}}let ki=(()=>{class t extends ke{constructor(t,e,n,o,i,s,c,a,r,l,b,u,m,d,p,h){super(p.createTaxForm(),u,t,e,o,n,s,l,m,b,c,h,d),this.route=t,this.router=e,this.paymentsService=n,this.companyService=o,this.dateAdapter=i,this.maskService=s,this.translate=c,this.datePipe=a,this.accountsService=r,this.modalService=l,this.pipelines=b,this.api=u,this.dictionaries=m,this.featureFlagsService=d,this.paymentsFormsFactory=p,this.authorityPermissionsService=h,this.associatedFieldTpl=void 0,this.masks={number:"paymentNum",amount:"amount",vin:"vin",knp:"knp",kbk:"kbk",protocolNumber:"protocol",bankAccount:"tengeAccount"},this.commission$=new I.a(0),this.protocolMessage$=new I.a(""),this.vinLength=17,this.subs=new Et.a,this.paymentType=B.j.TAX}ngOnInit(){super.ngOnInit(),this.dateLimit=this.paymentsService.stdDateRangeNgb,this.accountStore=this.accountsService.store,this.acceptableAccounts$=this.paymentsService.combineAcceptableAccounts(this.accountStore).pipe(Object(F.a)(t=>this.checkPersonalAccounts(t))),this.getMaskConfig(),this.createControlsStream(this.form),this.combineKBK(this.paymentType),this.knp$=this.combineKNP([(t,e)=>{if(e[0]){const t=this.knpStore.getItemsByIds(this.kbkStore.entities[e[0]].associatedKnpList),n=this.form.controls.knp;return n.enable(),setTimeout(()=>{1===t.length?(n.patchValue(t[0].code),this.focusableContainer.focusNext()):t.some(t=>t.code===n.value)||n.patchValue("")},100),t}return[]}],[this.controlsStream.kbk]),this.listenWorkingDays(),this.listenCommission(),this.listenTotal(),this.provideAmountMessage(),this.listenDateMessageStream(),this.listenKnpUpdates(),this.subs.add(this.createPeriodMessage$().subscribe(this.periodMessage$)),this.subs.add(Object(O.a)([this.controlsStream.vin.pipe(Object(y.a)(t=>t?`VIN${t}/V`:"")),this.controlsStream.protocolNumber.pipe(Object(y.a)(t=>t?`ADM${t}/A`:""))]).subscribe(t=>{this.protocolMessage$.next(t.join(" "))}));const t=[this.protocolMessage$.pipe(Object(y.a)(t=>["protocol",t])),Object(O.a)([this.translate.get("SHARED.NOT_SELECTED"),this.translate.get("SHARED.TIME.PERIOD"),this.periodMessage$]).pipe(Object(y.a)(([t,e,n])=>n&&n!==t?`${e}: ${n}.`:""),Object(y.a)(t=>["period",t]))];this.listenPurposeMessageStream(t,["protocol","kbk","knp","period"]),this.subs.add(this.controlsStream.kbk.pipe().subscribe(t=>{const{protocolNumber:e,vin:n}=this.form.controls;this.rules.kbkCodeVinReq.some(e=>e===t)?(n.enable(),e.disable(),e.value&&e.patchValue(""),this.associatedFieldTpl=this.vinTpl):/^204\d+$/.test(t)?(n.disable(),n.value&&n.patchValue(""),e.enable(),this.associatedFieldTpl=this.protocolNumberTpl):(this.associatedFieldTpl=null,n.disable(),e.disable(),e.value&&e.patchValue(""),n.value&&n.patchValue(""))})),this.subs.add(this.controlsStream.intervalEnabled.pipe(Object(Lo.a)(300,void 0,{leading:!0,trailing:!0}),Object(P.a)()).subscribe(t=>{const{period:e,periodEnd:n,periodStart:o}=this.form.controls;t?([n,o].forEach(t=>t.enable()),e.disable()):([n,o].forEach(t=>t.disable()),e.enable())})),this.form.get("bankAccount").value||this.form.get("bankAccount").setValue(B.p.TAX_ACCOUNT)}get intervalSwitchLabel(){return this.form.controls.intervalEnabled.value?"PAYMENTS.INTERVAL.ENABLED":"PAYMENTS.INTERVAL.DISABLED"}onKbkSelect(t){!this.form.controls.knp.value&&t.associatedKnpList&&this.form.controls.knp.setValue(t.associatedKnpList[0])}openDepartmentDictionary(t,e){e&&e.preventDefault(),t&&(t.blur(),t.close()),this.modalService.open(dt,{backdropClass:"backdrop_light",windowClass:"modal_light modal_max-height",centered:!0}).result.then(t=>{this.form.controls.ugd.setValue(t.code)}).catch(()=>{})}openKBKDictionary(t,e){e&&e.preventDefault(),t&&(t.blur(),t.close());const n=this.modalService.open(yt,{backdropClass:"backdrop_light",windowClass:"modal_light modal_max-height",centered:!0});Object.assign(n.componentInstance,{store:this.kbkStore}),n.result.then(t=>{this.form.controls.kbk.setValue(t.code)}).catch(()=>{})}onUgdSelect(t){}createPeriodMessage$(){const{intervalEnabled:t,periodEnd:e,periodStart:n,period:o}=this.controlsStream;return Object(O.a)([t,this.translate.get("SHARED.NOT_SELECTED"),o,n,e]).pipe(Object(x.a)(0),Object(y.a)(([t,e,...n])=>{const[o,i,s]=n.map(t=>t?this.datePipe.transform(t,"MM.yyyy"):"");return!t&&!o||t&&!i&&!s?e:t?`${i||e} - ${s||e}`:`${o||e}`}))}sendPayment(){return super.sendPayment(this.constructTaxPaymentBody())}saveToDraft(){return super.saveToDraft(this.constructTaxPaymentBody())}openKnpDictionary(t,e){t.close(),t.blur(),setTimeout(()=>{const t=this.modals.open(bt,{backdropClass:"backdrop_light",windowClass:"modal_light modal_max-height",centered:!0});t.componentInstance.paymentType=this.paymentType,t.result.then(t=>{if(!this.filteredKnpList.includes(t)){const e=this.kbkStore.items.find(t=>{var e;return t.code==(null===(e=this.form.controls.kbk)||void 0===e?void 0:e.value)}),n=this.knpStore.getItemsByIds(e.associatedKnpList);this.filteredKnpList=[...n,t]}this.form.controls.knp.patchValue(t.code)}).catch(()=>{})},0)}constructTaxPaymentBody(){const t=this.form.value,e=this.protocolMessage$.getValue();let n="";return n=e?this.purposeMessage$.getValue().replace(e,[e,t.purpose].filter(t=>!!t).join(" ")):[t.purpose,this.purposeMessage$.getValue()].filter(t=>!!t).join(". "),Object.assign(Object.assign({},t),{purpose:n})}listenKnpUpdates(){this.knp$.subscribe(t=>{this.filteredKnpList=t})}get vinMessage(){var t,e;return this.form.controls.vin.value&&0!==this.form.controls.vin.value.length?(null===(t=this.form.controls.vin.value)||void 0===t?void 0:t.length)<this.vinLength?this.translate.instant("PAYMENTS.VIN_MESSAGE.LESS",{length:this.vinLength}):(null===(e=this.form.controls.vin.value)||void 0===e?void 0:e.length)>this.vinLength?this.translate.instant("PAYMENTS.VIN_MESSAGE.MORE",{length:this.vinLength}):"":this.translate.instant("PAYMENTS.VIN_MESSAGE.OPTIONAL")}}return t.\u0275fac=function(e){return new(e||t)(R.Qb(p.a),R.Qb(p.c),R.Qb(C.c),R.Qb(ti.a),R.Qb(c.c),R.Qb(Oe.a),R.Qb(a.e),R.Qb(o.f),R.Qb(l.c),R.Qb(c.q),R.Qb(ei.a),R.Qb(ni.a),R.Qb(at.a),R.Qb(q.b),R.Qb(oi.a),R.Qb(je.c))},t.\u0275cmp=R.Kb({type:t,selectors:[["j-tax-payment"]],viewQuery:function(t,e){var n;1&t&&(R.Yc(i.v,!0),R.Yc(Nt.b,!0),R.Yc(ci,!0,R.L),R.Yc(ai,!0,R.L)),2&t&&(R.Ec(n=R.jc())&&(e.ngForm=n.first),R.Ec(n=R.jc())&&(e.focusableContainer=n.first),R.Ec(n=R.jc())&&(e.vinTpl=n.first),R.Ec(n=R.jc())&&(e.protocolNumberTpl=n.first))},features:[R.xb],decls:2,vars:2,consts:[["label","PAYMENTS.RESTRICTED_PLACEHOLDER",3,"isRetryable","isLoading","retried",4,"ngIf"],[4,"ngIf"],["label","PAYMENTS.RESTRICTED_PLACEHOLDER",3,"isRetryable","isLoading","retried"],["autocomplete","off","jInvalidControlScroll","","jFocusableContainer","",1,"p-relative",3,"formGroup","submit"],["formDirective","ngForm"],[1,"form-section"],[1,"payments__header"],[1,"h2","mb-0"],["type","button",1,"btn","btn-link","p-0","p3",3,"click"],[1,"form-group"],["selectWrapper",""],["bindValue","code","bindLabel","label",3,"appendTo","jFocusOnReturn","formControl","clearable","searchFn","items"],["ugdSelect",""],["j-option-tmp",""],["j-header-tmp",""],["clearable","true"],["jPrefix","","hideEmpty","true",3,"name"],["type","text","jFormInput","","jReplaceOnPaste","KZ","jDynamicPrefix","KZ","jFocusOnReturn","","jUppercase","",1,"form-control",3,"jShadow","dropSpecialCharacters","mask","formControl"],["accountInput","jFormInput"],[3,"control","errorMessages"],[1,"h2"],["type","text","jFormInput","","jFocusOnReturn","",1,"form-control",3,"mask","formControl"],["class","form-group",4,"ngTemplateOutlet"],[1,"list-group"],[1,"list-group-item","text-left","d-flex","align-items-center"],[3,"formControl"],[1,"ml-3"],[1,"text-gray"],[3,"hidden"],["kbkWrapper",""],["bindValue","code","bindLabel","label",3,"jFocusOnReturn","appendTo","formControl","clearable","searchMask","shadow","items","change"],["kbkSelect",""],["knpWrapper",""],["bindValue","code","bindLabel","label",3,"appendTo","jFocusOnReturn","formControl","clearable","searchMask","shadow","items"],["knpSelect",""],[1,"form-group","position-relative"],[1,"payment-section--purpose-length","p3","text-gray"],["jFocusOnReturn","","jFormInput","","rows","5",1,"form-control",3,"formControl"],["purpose",""],["jBottomLine","","class","j-form-field-bottom",4,"ngIf"],[3,"isLoading","label","hasError","accounts","selected"],["senderAccountDropdown",""],["clearable","true",3,"floatLabel"],["type","text","suffix"," \u20b8","jFormInput","","jCursorBound","","placeholder","0,00","mask","separator.2","jReplaceDot","","thousandSeparator"," ","decimalMarker",",",1,"form-control",3,"dropSpecialCharacters","formControl"],["class","j-input-helper text-muted mt-1 p3",4,"ngIf"],[1,"j-input-helper","text-muted","mt-1","p3","position-relative"],[4,"ngIf","ngIfElse"],["commission",""],[1,"payment-section--submit","form-group","pt-4"],["periodTpl",""],["intervalTpl",""],["vinTpl",""],["protocolNumberTpl",""],["type","ball-scale-ripple-multiple","size","large","color","#d6dadf","zIndex","3","bdColor","rgba(246, 247, 248, 0.3)",3,"name","fullScreen"],[1,"j-option-label","text-wrap"],[1,"m-0"],[1,"p3","text-gray","m-0"],["type","button",1,"form-section--action","btn","btn-xs","btn-link","float-right",3,"click"],[1,"p2"],[1,"p2","m-0"],[1,"p3","text-gray"],["jBottomLine","",1,"j-form-field-bottom"],[1,"text-truncate","small"],[1,"j-input-helper","text-muted","mt-1","p3"],[3,"innerHTML"],["type","button",1,"btn","btn-outline-primary","btn-static",3,"click"],["type","submit",1,"btn","btn-primary","btn-static","ml-3"],["type","submit",1,"btn","btn-outline-primary","btn-static"],[1,"row"],[1,"col"],[3,"hasError","label","formControl"],["period",""],[1,"col","col-md-6"],["periodStart",""],["periodEnd",""],["type","text","jFormInput","","jFocusOnReturn","","maxlength","64","jUppercase","",1,"form-control",3,"formControl"]],template:function(t,e){1&t&&(R.Rc(0,ri,1,2,"j-restricted-placeholder",0),R.Rc(1,Ii,139,120,"ng-container",1)),2&t&&(R.uc("ngIf",e.isRestricted),R.Ab(1),R.uc("ngIf",!e.isRestricted))},directives:[o.u,xe.a,i.J,i.u,_e.b,Nt.b,i.l,z.a,Vt.a,Ye.a,Nt.a,i.t,i.i,Ue.j,Ue.b,et.a,Z.a,tt.a,i.c,Ko.a,Fo.a,Le.a,Qe.a,s.a,Ot.a,o.B,we.a,De.a,$e.a,Be.a,Ke.a,Ge.a,ii.a,i.o],pipes:[a.d,o.b,nt.a,si.a],styles:[".payments__header[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;-webkit-box-pack:justify;justify-content:space-between;margin-bottom:1.5rem}"]}),t})();const Oi=function(t){return[t]};let ji=(()=>{class t extends wo{constructor(){super(),this.routes=h.a}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=R.Kb({type:t,selectors:[["j-budget-payments"]],features:[R.xb],decls:17,vars:24,consts:[[1,"payment-section"],[1,"form-group","mb-5"],["routerLinkActive","active",1,"btn","btn-sm","btn-outline-dark","btn-shadow",3,"routerLink"],["routerLinkActive","active",1,"btn","btn-sm","btn-outline-dark","btn-shadow","ml-2",3,"routerLink"],[1,"outlet-animation-wrapper"],[3,"activate"],["outlet","outlet"]],template:function(t,e){if(1&t){const t=R.Xb();R.Wb(0,"div",0),R.Wb(1,"div",1),R.Wb(2,"a",2),R.Tc(3),R.nc(4,"translate"),R.Vb(),R.Wb(5,"a",3),R.Tc(6),R.nc(7,"translate"),R.Vb(),R.Wb(8,"a",3),R.Tc(9),R.nc(10,"translate"),R.Vb(),R.Wb(11,"a",3),R.Tc(12),R.nc(13,"translate"),R.Vb(),R.Vb(),R.Wb(14,"div",4),R.Wb(15,"router-outlet",5,6),R.ic("activate",(function(n){R.Ic(t);const o=R.Fc(16);return e.onActivate(n,o)})),R.Vb(),R.Vb(),R.Vb()}2&t&&(R.Ab(2),R.uc("routerLink",R.zc(16,Oi,e.routes.tenge.state.tax)),R.Ab(1),R.Uc(R.oc(4,8,"PAYMENTS.TABS.TAX")),R.Ab(2),R.uc("routerLink",R.zc(18,Oi,e.routes.tenge.state.pension)),R.Ab(1),R.Uc(R.oc(7,10,"PAYMENTS.TABS.PENSION")),R.Ab(2),R.uc("routerLink",R.zc(20,Oi,e.routes.tenge.state.social)),R.Ab(1),R.Uc(R.oc(10,12,"PAYMENTS.TABS.SOCIAL")),R.Ab(2),R.uc("routerLink",R.zc(22,Oi,e.routes.tenge.state.osms)),R.Ab(1),R.Uc(R.oc(13,14,"PAYMENTS.TABS.MEDICAL")))},directives:[p.f,p.e,p.h],pipes:[a.d],styles:[""],data:{animation:[Po.c]}}),t})();var Wi=n("ZF+8");const Mi=["emailOnSuccess"];function Pi(t,e){if(1&t){const t=R.Xb();R.Wb(0,"j-restricted-placeholder",2),R.ic("retried",(function(e){return R.Ic(t),R.mc().updatePermissions()})),R.Vb()}if(2&t){const t=R.mc();R.uc("isRetryable",t.isPermissionsUpdateAllowed)("isLoading",t.isPermissionsUpdating)}}function xi(t,e){if(1&t){const t=R.Xb();R.Wb(0,"button",56),R.ic("click",(function(e){return R.Ic(t),R.mc(2).checkIin()})),R.Tc(1),R.nc(2,"translate"),R.Vb()}2&t&&(R.Ab(1),R.Uc(R.oc(2,1,"PAYMENTS.FORM.CHECK")))}function _i(t,e){1&t&&(R.Wb(0,"span"),R.Wb(1,"span",57),R.Tc(2,"PAYMENTS.TRUSTED_COUNTERPARTY"),R.Vb(),R.Rb(3,"span",58),R.Vb()),2&t&&(R.Ab(3),R.uc("inlineSVG","/assets/icons/counterparty/status.svg"))}function Di(t,e){1&t&&(R.Wb(0,"span"),R.Wb(1,"span",57),R.Tc(2,"PAYMENTS.UNTRUSTED_COUNTERPARTY"),R.Vb(),R.Rb(3,"span",59),R.Vb()),2&t&&(R.Ab(3),R.uc("inlineSVG","/assets/icons/counterparty/status.svg"))}function wi(t,e){if(1&t&&(R.Wb(0,"li",60),R.Tc(1),R.nc(2,"translate"),R.Vb()),2&t){const t=e.$implicit;R.Ab(1),R.Vc(" \u2022 ",R.oc(2,1,t.name)," ")}}function Yi(t,e){if(1&t){const t=R.Xb();R.Wb(0,"div"),R.Wb(1,"button",61),R.ic("click",(function(e){R.Ic(t),R.mc(2);const n=R.Fc(80);return R.mc().openKnpDictionary(n,e)})),R.Tc(2),R.nc(3,"translate"),R.Vb(),R.Wb(4,"p",62),R.Tc(5),R.nc(6,"translate"),R.Vb(),R.Wb(7,"p",63),R.Tc(8),R.nc(9,"translate"),R.Vb(),R.Vb()}2&t&&(R.Ab(2),R.Vc(" ",R.oc(3,3,"PAYMENTS.DICTIONARY.TITLE")," "),R.Ab(3),R.Uc(R.oc(6,5,"PAYMENTS.DICTIONARY.FREQUENT_KNP")),R.Ab(3),R.Uc(R.oc(9,7,"PAYMENTS.DICTIONARY.KNP_DESCRIPTION")))}function Ui(t,e){1&t&&R.Rc(0,Yi,10,9,"div",1),2&t&&R.uc("ngIf",!e.searchTerm)}function Li(t,e){if(1&t&&(R.Wb(0,"div",64),R.Wb(1,"div",65),R.Tc(2),R.Vb(),R.Vb()),2&t){const t=e.ngIf;R.Ab(2),R.Vc(" ",t," ")}}function Fi(t,e){if(1&t&&(R.Wb(0,"div",37),R.Rb(1,"span",66),R.nc(2,"translate"),R.Vb()),2&t){const t=e.ngIf;R.Ab(1),R.uc("innerHTML",R.oc(2,1,t),R.Jc)}}function $i(t,e){1&t&&(R.Ub(0),R.Tc(1),R.nc(2,"translate"),R.Tb()),2&t&&(R.Ab(1),R.Vc(" ",R.oc(2,1,"PAYMENTS.COMMISSION_CALC_AUTO")," "))}function Bi(t,e){if(1&t&&(R.Tc(0),R.nc(1,"translate"),R.nc(2,"amountFormat"),R.nc(3,"async")),2&t){const t=R.mc(2);R.Wc(" ",R.oc(1,2,"PAYMENTS.COMMISSION"),": ",R.oc(2,4,R.oc(3,6,t.commission$))," \u20b8 ")}}function Ki(t,e){1&t&&(R.Wb(0,"div"),R.Wb(1,"small",50),R.Tc(2),R.nc(3,"translate"),R.Vb(),R.Vb()),2&t&&(R.Ab(2),R.Uc(R.oc(3,1,"PAYMENTS.NOTIFY.DESCRIPTION")))}function Hi(t,e){if(1&t){const t=R.Xb();R.Wb(0,"div",67),R.Wb(1,"j-form-field"),R.Wb(2,"j-label"),R.Tc(3),R.nc(4,"translate"),R.Vb(),R.Wb(5,"input",68,69),R.ic("focus",(function(e){return R.Ic(t),R.mc(2).onEmailOnSuccessFocus(e)})),R.Vb(),R.Rb(7,"j-error",14),R.Vb(),R.Wb(8,"small",50),R.Tc(9),R.nc(10,"translate"),R.Vb(),R.Vb()}if(2&t){const t=R.mc(2);R.Ab(3),R.Uc(R.oc(4,6,"PAYMENTS.NOTIFY.EMAIL")),R.Ab(2),R.uc("ngbTypeahead",t.search)("formControl",t.form.controls.emailOnSuccess),R.Ab(2),R.uc("control",t.form.controls.emailOnSuccess)("errorMessages",t.errors.email),R.Ab(2),R.Uc(R.oc(10,8,"PAYMENTS.NOTIFY.EMAIL"))}}function Qi(t,e){if(1&t){const t=R.Xb();R.Ub(0),R.Wb(1,"button",70),R.ic("click",(function(e){return R.Ic(t),R.mc(2).saveToDraft()})),R.Tc(2),R.nc(3,"translate"),R.Vb(),R.Wb(4,"button",71),R.Tc(5),R.nc(6,"translate"),R.Vb(),R.Tb()}if(2&t){const t=R.mc(2);R.Ab(2),R.Uc(R.oc(3,2,"PAYMENTS.FORM.SAVE")),R.Ab(3),R.Vc("",R.oc(6,4,t.submitLabel)," ")}}function Gi(t,e){1&t&&(R.Ub(0),R.Wb(1,"button",72),R.Tc(2),R.nc(3,"translate"),R.Vb(),R.Tb()),2&t&&(R.Ab(2),R.Uc(R.oc(3,1,"PAYMENTS.FORM.SAVE_EDIT")))}function qi(t,e){1&t&&R.Rb(0,"j-kbe-info")}function Xi(t,e){if(1&t){const t=R.Xb();R.Ub(0),R.Wb(1,"div",3),R.Wb(2,"form",4,5),R.ic("submit",(function(e){return R.Ic(t),R.mc().onSubmit(e)})),R.Wb(4,"div",6),R.Wb(5,"fieldset"),R.Wb(6,"div",7),R.Wb(7,"h2",8),R.Tc(8),R.nc(9,"translate"),R.Vb(),R.Wb(10,"button",9),R.ic("click",(function(e){return R.Ic(t),R.mc().openSavedPayments()})),R.Tc(11),R.nc(12,"translate"),R.Vb(),R.Vb(),R.Wb(13,"div",10),R.Wb(14,"j-form-field"),R.Wb(15,"j-label"),R.Tc(16),R.nc(17,"translate"),R.Vb(),R.Rb(18,"input",11),R.Rc(19,xi,3,3,"button",12),R.nc(20,"async"),R.nc(21,"async"),R.Wb(22,"div",13),R.nc(23,"async"),R.Rc(24,_i,4,1,"span",1),R.nc(25,"async"),R.Rc(26,Di,4,1,"span",1),R.nc(27,"async"),R.Vb(),R.Rb(28,"j-error",14),R.Vb(),R.Wb(29,"ul",15),R.Rc(30,wi,3,3,"li",16),R.Vb(),R.Vb(),R.Wb(31,"div",10),R.Wb(32,"j-form-field",17),R.Wb(33,"j-label"),R.Tc(34),R.nc(35,"translate"),R.Vb(),R.Rb(36,"input",18),R.Vb(),R.Vb(),R.Wb(37,"div",10),R.Wb(38,"j-form-field",17),R.Rb(39,"j-entity-logo",19),R.nc(40,"bankFromAccount"),R.Wb(41,"j-label"),R.Tc(42),R.nc(43,"translate"),R.Vb(),R.Rb(44,"input",20,21),R.Rb(46,"j-error",14),R.Vb(),R.Vb(),R.Wb(47,"div",10),R.Wb(48,"j-form-field",17),R.Wb(49,"j-label"),R.Tc(50),R.nc(51,"translate"),R.Vb(),R.Rb(52,"input",22),R.Rb(53,"a",23),R.Rb(54,"j-error",14),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Wb(55,"div",6),R.Wb(56,"fieldset"),R.Wb(57,"legend",24),R.Tc(58),R.nc(59,"translate"),R.Vb(),R.Wb(60,"div",10),R.Wb(61,"j-form-field"),R.Wb(62,"j-label"),R.Tc(63),R.nc(64,"translate"),R.Vb(),R.Rb(65,"input",25),R.Vb(),R.Vb(),R.Wb(66,"div",10),R.Rb(67,"j-date-picker",26,27),R.nc(69,"async"),R.nc(70,"translate"),R.nc(71,"translate"),R.nc(72,"async"),R.Vb(),R.Wb(73,"div",10),R.Wb(74,"j-form-field",null,28),R.Wb(76,"j-label"),R.Tc(77),R.nc(78,"translate"),R.Vb(),R.Wb(79,"j-select",29,30),R.nc(81,"async"),R.Rc(82,Ui,1,1,"ng-template",31),R.Vb(),R.Vb(),R.Vb(),R.Wb(83,"div",32),R.Wb(84,"span",33),R.Tc(85),R.nc(86,"async"),R.Vb(),R.Wb(87,"j-form-field"),R.Wb(88,"j-label"),R.Tc(89),R.nc(90,"translate"),R.Vb(),R.Rb(91,"textarea",34,35),R.Rb(93,"j-error",14),R.Rc(94,Li,3,1,"div",36),R.nc(95,"async"),R.Vb(),R.Wb(96,"div",37),R.Tc(97),R.nc(98,"translate"),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Wb(99,"div",6),R.Wb(100,"fieldset"),R.Wb(101,"div",10),R.Wb(102,"j-account-dropdown",38,39),R.ic("selected",(function(e){return R.Ic(t),R.mc().onSenderAccountSelect(e)})),R.nc(104,"async"),R.nc(105,"async"),R.Vb(),R.Vb(),R.Wb(106,"div",10),R.Wb(107,"div",10),R.Wb(108,"j-form-field",40),R.Wb(109,"j-label"),R.Tc(110),R.nc(111,"translate"),R.Vb(),R.Rb(112,"input",41),R.Vb(),R.Rc(113,Fi,3,3,"div",42),R.nc(114,"async"),R.Wb(115,"div",43),R.Rc(116,$i,3,3,"ng-container",44),R.nc(117,"async"),R.Rc(118,Bi,4,8,"ng-template",null,45,R.Sc),R.Vb(),R.Vb(),R.Vb(),R.Wb(120,"div",10),R.Wb(121,"ul",46),R.Wb(122,"li",47),R.Rb(123,"j-switch",48),R.Wb(124,"span",49),R.Tc(125),R.nc(126,"translate"),R.Rb(127,"br"),R.Wb(128,"small",50),R.Tc(129),R.nc(130,"translate"),R.nc(131,"amountFormat"),R.nc(132,"async"),R.Vb(),R.Vb(),R.Vb(),R.Wb(133,"li",47),R.Rb(134,"j-switch",48),R.Wb(135,"span",49),R.Tc(136),R.nc(137,"translate"),R.Rb(138,"br"),R.Wb(139,"small",50),R.Tc(140),R.nc(141,"translate"),R.Vb(),R.Vb(),R.Vb(),R.Wb(142,"li",47),R.Rb(143,"j-switch",48),R.Wb(144,"div",51),R.Wb(145,"strong"),R.Tc(146),R.nc(147,"translate"),R.Vb(),R.Rb(148,"br"),R.Rc(149,Ki,4,3,"div",1),R.Rc(150,Hi,11,10,"div",52),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Wb(151,"div",53),R.Wb(152,"div",53),R.Rc(153,Qi,7,6,"ng-container",1),R.Rc(154,Gi,4,3,"ng-container",1),R.Vb(),R.Vb(),R.Rb(155,"ngx-spinner",54),R.Vb(),R.Vb(),R.Rc(156,qi,1,0,"ng-template",null,55,R.Sc),R.Tb()}if(2&t){const t=R.Fc(68),e=R.Fc(75),n=R.Fc(80),o=R.Fc(119),i=R.Fc(157),s=R.mc();R.Ab(2),R.uc("formGroup",s.form),R.Ab(6),R.Vc(" ",R.oc(9,90,"PAYMENTS.RECIPIENT.TITLE")," "),R.Ab(3),R.Vc(" ",R.oc(12,92,"PAYMENTS.SELECT_FROM_DICTIONARY")," "),R.Ab(5),R.Uc(R.oc(17,94,"PAYMENTS.FORM.IIN")),R.Ab(2),R.uc("dropSpecialCharacters",!0)("jShadow",s.masks.iinOrBin.shadow)("mask",s.masks.iinOrBin.mask)("formControl",s.form.controls.iinOrBin),R.Ab(1),R.uc("ngIf",s.form.controls.iinOrBin.valid&&s.iinIsNotOwn&&!R.oc(20,96,s.iinIsSubmitted$)&&!R.oc(21,98,s.iinIsFound$)),R.Ab(3),R.uc("jLoading",R.oc(23,100,s.isCounterPartyLoading$))("jLoadingInverted",!0),R.Ab(2),R.uc("ngIf",R.oc(25,102,s.counterParty$)===s.counterPartyStatus.SUCCESS),R.Ab(2),R.uc("ngIf",R.oc(27,104,s.counterParty$)===s.counterPartyStatus.ERROR),R.Ab(2),R.uc("control",s.form.controls.iinOrBin)("errorMessages",s.errors.iinOrBin),R.Ab(2),R.uc("ngForOf",s.riskGroups),R.Ab(4),R.Uc(R.oc(35,106,"PAYMENTS.FORM.NAME")),R.Ab(2),R.uc("formControl",s.form.controls.name),R.Ab(3),R.uc("name",R.oc(40,108,"KZ"+s.form.controls.bankAccount.value)),R.Ab(3),R.Uc(R.oc(43,110,"PAYMENTS.FORM.IBAN")),R.Ab(2),R.uc("jShadow",s.masks.bankAccount.shadow)("dropSpecialCharacters",!0)("mask",s.masks.bankAccount.mask)("formControl",s.form.controls.bankAccount),R.Ab(2),R.uc("control",s.form.controls.bankAccount)("errorMessages",s.errors.bankAccount),R.Ab(4),R.Uc(R.oc(51,112,"PAYMENTS.FORM.KBE")),R.Ab(2),R.uc("mask",s.masks.kbeCode.mask)("jShadow",s.masks.kbeCode.shadow)("dropSpecialCharacters",!0)("formControl",s.form.controls.kbeCode),R.Ab(1),R.uc("ngbTooltip",i)("inlineSVG","/assets/icons/payments/question.svg"),R.Ab(1),R.uc("control",s.form.controls.kbeCode)("errorMessages",s.errors.kbeCode),R.Ab(4),R.Uc(R.oc(59,114,"PAYMENTS.FORM.DETAILS")),R.Ab(5),R.Uc(R.oc(64,116,"PAYMENTS.FORM.DOCUMENT_NUMBER")),R.Ab(2),R.uc("mask",s.masks.number.mask)("formControl",s.form.controls.number),R.Ab(2),R.uc("datesEnabled",R.oc(69,118,s.workingDays$))("formControl",s.form.controls.date)("formatValue",!0)("jFocusOnReturn",t)("label",R.oc(70,120,"PAYMENTS.FORM.VALUE_DATE"))("minDate",s.dateLimit.minDate)("maxDate",s.dateLimit.maxDate)("helperText",R.oc(71,122,R.oc(72,124,s.dateMessage$))),R.Ab(10),R.Uc(R.oc(78,126,"PAYMENTS.FORM.KNP_REGULAR")),R.Ab(2),R.uc("jFocusOnReturn",n)("appendTo",e.elementRef.nativeElement)("formControl",s.form.controls.knp)("clearable",!1)("searchMask",s.masks.knp.mask)("shadow",s.masks.knp.shadow)("compareWith",s.knpComparator)("items",R.oc(81,128,s.knp$)),R.Ab(6),R.Wc(" ",R.oc(86,130,s.purposeLength$),"/",s.rules.purposeLength,""),R.Ab(4),R.Uc(R.oc(90,132,"PAYMENTS.FORM.PURPOSE")),R.Ab(2),R.uc("formControl",s.form.controls.purpose),R.Ab(2),R.uc("control",s.form.controls.purpose)("errorMessages",s.errors.purpose),R.Ab(1),R.uc("ngIf",R.oc(95,134,s.purposeMessage$)),R.Ab(3),R.Vc(" ",R.oc(98,136,"PAYMENTS.FORM.PURPOSE_HELPER")," "),R.Ab(5),R.uc("isLoading",R.oc(104,138,s.accountStore.fetching$))("label","PAYMENTS.SENDER_ACCOUNT.UNSELECTED")("hasError",s.form.controls.senderAccount.touched&&s.form.controls.senderAccount.errors)("accounts",R.oc(105,140,s.acceptableAccounts$)),R.Ab(6),R.uc("floatLabel","always"),R.Ab(2),R.Uc(R.oc(111,142,"PAYMENTS.FORM.AMOUNT")),R.Ab(2),R.uc("dropSpecialCharacters",!0)("formControl",s.form.controls.amount),R.Ab(1),R.uc("ngIf",R.oc(114,144,s.amountMessage$)),R.Ab(3),R.uc("ngIf",null===R.oc(117,146,s.commission$))("ngIfElse",o),R.Ab(7),R.uc("formControl",s.form.controls.vat),R.Ab(2),R.Vc(" ",R.oc(126,148,"PAYMENTS.VAT.TITLE"),""),R.Ab(4),R.Wc("",R.oc(130,150,"PAYMENTS.VAT.DESCRIPTION")," = ",R.oc(131,152,R.oc(132,154,s.vat$))," \u20b8"),R.Ab(5),R.uc("formControl",s.form.controls.urgent),R.Ab(2),R.Vc("",R.oc(137,156,"PAYMENTS.FORM.URGENT")," "),R.Ab(4),R.Uc(R.oc(141,158,"PAYMENTS.URGENT_HELPER")),R.Ab(3),R.uc("formControl",s.form.controls.notify),R.Ab(3),R.Uc(R.oc(147,160,"PAYMENTS.NOTIFY.TITLE")),R.Ab(3),R.uc("ngIf",!s.form.controls.notify.value),R.Ab(1),R.uc("ngIf",s.form.controls.notify.value),R.Ab(3),R.uc("ngIf",s.restoredData.status!==s.PAYMENT_STATUS.CREATED),R.Ab(1),R.uc("ngIf",s.restoredData.status===s.PAYMENT_STATUS.CREATED),R.Ab(1),R.uc("name",s.SPINNER)("fullScreen",!1)}}var zi=function(t){return t.SUCCESS="SUCCESS",t.ERROR="ERROR",t}({});let Ji=(()=>{class t extends ke{constructor(t,e,n,o,i,s,c,a,r,l,b,u,m,d,p,h){super(d.createPaymentInTengeForm(),s,o,i,t,e,n,u,c,m,a,r,l),this.companyService=t,this.paymentsService=e,this.maskService=n,this.route=o,this.router=i,this.api=s,this.dictionaries=c,this.translateService=a,this.authorityPermissionsService=r,this.featureFlagsService=l,this.accountsService=b,this.modalService=u,this.pipelines=m,this.paymentsFormsFactory=d,this.recipientsService=p,this.userService=h,this.isCounterPartyLoading$=new I.a(null),this.masks={iinOrBin:"iin",bankAccount:"tengeAccount",kbeCode:"kbe",knp:"knp",number:"paymentNum",amount:"amount"},this.riskGroups=[],this.counterPartyStatus=zi,this.counterParty$=new I.a(null),this.focusEmail$=new k.a,this.prevEmails$=new I.a([]),this.fetchingEmailsFor$=new I.a(null),this.iinIsSubmitted$=new I.a(null),this.iinIsFound$=new I.a(null),this.paymentType=B.j.REGULAR_PAYMENT_ORDER,this.user=this.userService.user}ngOnInit(){super.ngOnInit(),this.dateLimit=this.paymentsService.stdDateRangeNgb,this.accountStore=this.accountsService.store,this.acceptableAccounts$=this.paymentsService.combineAcceptableAccounts(this.accountStore).pipe(Object(F.a)(t=>this.checkPersonalAccounts(t))),this.knp$=this.combineKNP([t=>this.dictionaries.selectByPaymentType(t,{type:B.j.REGULAR_PAYMENT_ORDER,sortFavourite:!0})]),this.listenWorkingDays(),this.getMaskConfig(),this.createControlsStream(this.form),this.listenVAT(),this.listenCommission(),this.listenTotal(),this.provideAmountMessage(),this.listenDateMessageStream(),this.listenPurposeMessageStream(),this.listenEmailSearch();const{bankAccount:t,senderAccount:e}=this.controlsStream;this.subs.add(Object(O.a)([t.pipe(Object(L.a)(t=>this.form.controls.bankAccount.valid),Object(_.a)("")),e.pipe(Object(L.a)(t=>this.form.controls.senderAccount.valid),Object(y.a)(t=>t.iban),Object(_.a)(""))]).pipe(Object(y.a)(([t,e])=>this.paymentsService.checkPaymentTypeFromIban(e,"KZ"+t))).subscribe(t=>this.paymentType=t)),this.applyCounterAgentVerification()}openSavedPayments(){this.modalService.open(ct,{backdropClass:"backdrop_light",windowClass:"modal_light modal_max-height",centered:!0}).result.then(({recipient:t,account:e})=>{this.form.patchValue({bankAccount:e.iban,iinOrBin:t.iinOrBin,name:t.name,kbeCode:t.kbe.code}),this.form.markAsDirty()}).catch(()=>{})}onEmailOnSuccessFocus(t){this.focusEmail$.next(t.target.value)}openKnpDictionary(t,e){t.close(),t.blur(),setTimeout(()=>{const t=this.modals.open(bt,{backdropClass:"backdrop_light",windowClass:"modal_light modal_max-height",centered:!0});t.componentInstance.paymentType=B.j.REGULAR_PAYMENT_ORDER,t.result.then(t=>{this.form.controls.knp.patchValue(t.code)}).catch(()=>{})},0)}applyCounterAgentVerification(){const{iinOrBin:t}=this.form.controls;this.subs.add(this.controlsStream.iinOrBin.pipe(Object(P.a)(),Object(x.a)(300),Object(Y.a)(e=>(this.counterParty$.next(null),this.iinIsFound$.next(null),this.iinIsSubmitted$.next(null),t.valid&&(this.iinIsNotOwn=this.user.iin!==e,this.isCounterPartyLoading$.next(e)),this.isCounterPartyLoading$.next(null),Object(j.a)(null)))).subscribe(t=>{t&&this.checkCounterParty(t),this.isCounterPartyLoading$.next(null)}))}checkCounterParty(t){var e,n,o;(null===(e=t.companyInfo)||void 0===e?void 0:e.name)&&this.form.controls.name.setValue(null===(n=t.companyInfo)||void 0===n?void 0:n.name),t.riskGroups&&(this.riskGroups=t.riskGroups),this.counterParty$.next(0===(null===(o=t.riskGroups)||void 0===o?void 0:o.length)?this.counterPartyStatus.SUCCESS:this.counterPartyStatus.ERROR)}listenEmailSearch(){const{emailOnSuccess:t}=this.form.controls;this.subs.add(this.controlsStream.notify.pipe(Object(x.a)(100)).subscribe(e=>e?t.enable():t.disable())),this.subs.add(this.controlsStream.iinOrBin.pipe(Object(x.a)(200),Object(L.a)(t=>this.form.controls.iinOrBin.valid),Object(Y.a)(t=>(this.fetchingEmailsFor$.next(t),this.prevEmails$.next([]),this.recipientsService.getPrevNotifications(t).catch(t=>[])))).subscribe(t=>{this.prevEmails$.next(t),this.fetchingEmailsFor$.next(null)})),this.search=t=>Object(O.a)([this.prevEmails$.pipe(Object(y.a)(t=>t.map(t=>t.email))),t.pipe(Object(x.a)(200),Object(P.a)(),Object(_.a)("")),this.focusEmail$]).pipe(Object(y.a)(([t,e,n])=>e?t.filter(t=>t.toLowerCase().indexOf(e.toLowerCase())>-1).slice(0,3):t.slice(0,3)))}checkIin(){return Object(N.a)(this,void 0,void 0,(function*(){this.riskGroups=[],this.iinIsSubmitted$.next(!0);const t=this.form.controls.iinOrBin.value;this.isCounterPartyLoading$.next(t),this.recipientsService.checkCounterParty(t).then(t=>Object(N.a)(this,void 0,void 0,(function*(){t&&this.checkCounterParty(t),yield this.successfulCounterPartyResult()}))).catch(t=>{console.error(t),this.iinIsSubmitted$.next(null),this.iinIsFound$.next(null),this.isCounterPartyLoading$.next(null),this.showSignError()})}))}showSignError(){return Object(N.a)(this,void 0,void 0,(function*(){return this.modalService.open(ge,{backdropClass:"backdrop_light",windowClass:"modal_light modal_max-height",centered:!0}).result}))}successfulCounterPartyResult(){return Object(N.a)(this,void 0,void 0,(function*(){this.iinIsSubmitted$.next(null),this.iinIsFound$.next(!0),this.isCounterPartyLoading$.next(null)}))}}return t.\u0275fac=function(e){return new(e||t)(R.Qb(ti.a),R.Qb(C.c),R.Qb(Oe.a),R.Qb(p.a),R.Qb(p.c),R.Qb(ni.a),R.Qb(at.a),R.Qb(a.e),R.Qb(je.c),R.Qb(q.b),R.Qb(l.c),R.Qb(c.q),R.Qb(ei.a),R.Qb(oi.a),R.Qb(X.a),R.Qb(Wi.h))},t.\u0275cmp=R.Kb({type:t,selectors:[["j-payment-order"]],viewQuery:function(t,e){var n;1&t&&R.Oc(Mi,!0),2&t&&R.Ec(n=R.jc())&&(e.emailOnSuccess=n.first)},features:[R.xb],decls:2,vars:2,consts:[["label","PAYMENTS.RESTRICTED_PLACEHOLDER",3,"isRetryable","isLoading","retried",4,"ngIf"],[4,"ngIf"],["label","PAYMENTS.RESTRICTED_PLACEHOLDER",3,"isRetryable","isLoading","retried"],[1,"payment-section"],["jInvalidControlScroll","","jFocusableContainer","",3,"formGroup","submit"],["formDirective","ngForm"],[1,"form-section"],[1,"payments__header"],[1,"h2","mb-0"],["type","button",1,"btn","btn-link","p-0","p3",3,"click"],[1,"form-group"],["type","text","jFocusOnReturn","","jFormInput","",1,"form-control",3,"dropSpecialCharacters","jShadow","mask","formControl"],["jSuffix","","type","button","class","btn btn-xs btn-link",3,"click",4,"ngIf"],["jSuffix","",1,"counterParty","p3",3,"jLoading","jLoadingInverted"],[3,"control","errorMessages"],[1,"navbar-nav","mt-2"],["class","p3 risk-li text-muted",4,"ngFor","ngForOf"],["clearable","true"],["type","text","jFocusOnReturn","","jFormInput","",1,"form-control",3,"formControl"],["jPrefix","","hideEmpty","true",3,"name"],["type","text","jFormInput","","jReplaceOnPaste","KZ","jDynamicPrefix","KZ","jFocusOnReturn","","jUppercase","",1,"form-control",3,"jShadow","dropSpecialCharacters","mask","formControl"],["accountInput","jFormInput"],["type","text","jFormInput","","jFocusOnReturn","",1,"form-control",3,"mask","jShadow","dropSpecialCharacters","formControl"],["href","javascript:void(0)","jSuffix","","tooltipClass","tooltip-light tooltip-large","triggers","mouseenter:mouseleave",1,"mr-1","link-gray",3,"ngbTooltip","inlineSVG"],[1,"h2"],["type","text","jFormInput","","jFocusOnReturn","",1,"form-control",3,"mask","formControl"],["allowAuto","true",3,"datesEnabled","formControl","formatValue","jFocusOnReturn","label","minDate","maxDate","helperText"],["datePicker",""],["knpWrapper",""],["bindValue","code","bindLabel","label",3,"jFocusOnReturn","appendTo","formControl","clearable","searchMask","shadow","compareWith","items"],["select",""],["j-header-tmp",""],[1,"form-group","position-relative"],[1,"payment-section--purpose-length","p3","text-gray"],["jFocusOnReturn","","jFormInput","","rows","5",1,"form-control",3,"formControl"],["purpose",""],["jBottomLine","","class","j-form-field-bottom",4,"ngIf"],[1,"j-input-helper","text-muted","mt-1","p3"],[3,"isLoading","label","hasError","accounts","selected"],["senderAccountDropdown",""],["clearable","true",3,"floatLabel"],["type","text","jFocusOnReturn","","jFormInput","","jCursorBound","","jReplaceDot","","suffix"," \u20b8","placeholder","0,00","mask","separator.2","thousandSeparator"," ","decimalMarker",",",1,"form-control",3,"dropSpecialCharacters","formControl"],["class","j-input-helper text-muted mt-1 p3",4,"ngIf"],[1,"j-input-helper","text-muted","mt-1","p3","position-relative"],[4,"ngIf","ngIfElse"],["commission",""],[1,"list-group"],[1,"list-group-item","d-flex","align-items-center"],[3,"formControl"],[1,"ml-3"],[1,"text-gray"],[1,"ml-3","flex-grow-1"],["class","mt-1",4,"ngIf"],[1,"payment-section--submit","form-group","pt-4"],["type","ball-scale-ripple-multiple","size","large","color","#d6dadf","zIndex","3","bdColor","rgba(246, 247, 248, 0.3)",3,"name","fullScreen"],["kbeInfo",""],["jSuffix","","type","button",1,"btn","btn-xs","btn-link",3,"click"],["translate","",1,"text-muted","mr-2"],[1,"text-success",3,"inlineSVG"],[1,"text-danger",3,"inlineSVG"],[1,"p3","risk-li","text-muted"],["type","button",1,"form-section--action","btn","btn-xs","btn-link","float-right",3,"click"],[1,"p2","m-0"],[1,"p3","text-gray"],["jBottomLine","",1,"j-form-field-bottom"],[1,"text-truncate","small"],[3,"innerHTML"],[1,"mt-1"],["type","email","jFormInput","","jFocusOnReturn","","autocomplete","off",1,"form-control",3,"ngbTypeahead","formControl","focus"],["emailOnSuccess","ngbTypeahead"],["type","button",1,"btn","btn-outline-primary","btn-static",3,"click"],["type","submit",1,"btn","btn-primary","btn-static","ml-3"],["type","submit",1,"btn","btn-outline-primary","btn-static"]],template:function(t,e){1&t&&(R.Rc(0,Pi,1,2,"j-restricted-placeholder",0),R.Rc(1,Xi,158,162,"ng-container",1)),2&t&&(R.uc("ngIf",e.isRestricted),R.Ab(1),R.uc("ngIf",!e.isRestricted))},directives:[o.u,xe.a,i.J,i.u,_e.b,Nt.b,i.l,z.a,Vt.a,tt.a,i.c,Nt.a,Qe.a,s.a,i.t,i.i,It.a,He.a,Ot.a,o.t,et.a,Z.a,Ko.a,Fo.a,Le.a,c.E,kt.a,Fe.a,Ye.a,Ue.b,De.a,$e.a,Be.a,we.a,Ke.a,a.a,Ge.a,c.G,qe.a],pipes:[a.d,o.b,nt.a,si.a],styles:[".payments__header[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;-webkit-box-pack:justify;justify-content:space-between;margin-bottom:1.5rem}.counterParty[_ngcontent-%COMP%]{position:relative;min-width:40px;height:100%}li.risk-li[_ngcontent-%COMP%] + li.risk-li[_ngcontent-%COMP%]{margin-top:.5rem}"]}),t})();var Zi=n("LXWx");function ts(t,e){if(1&t){const t=R.Xb();R.Wb(0,"j-restricted-placeholder",2),R.ic("retried",(function(e){return R.Ic(t),R.mc().updatePermissions()})),R.Vb()}if(2&t){const t=R.mc();R.uc("isRetryable",t.isPermissionsUpdateAllowed)("isLoading",t.isPermissionsUpdating)}}function es(t,e){if(1&t&&(R.Wb(0,"div",36),R.Wb(1,"div",37),R.Tc(2),R.Vb(),R.Vb()),2&t){const t=e.ngIf;R.Ab(2),R.Vc(" ",t," ")}}function ns(t,e){if(1&t&&(R.Wb(0,"div",38),R.Rb(1,"span",39),R.nc(2,"translate"),R.Vb()),2&t){const t=e.ngIf;R.Ab(1),R.uc("innerHTML",R.oc(2,1,t),R.Jc)}}function os(t,e){1&t&&(R.Ub(0),R.Tc(1),R.nc(2,"translate"),R.Tb()),2&t&&(R.Ab(1),R.Vc(" ",R.oc(2,1,"PAYMENTS.COMMISSION_CALC_AUTO")," "))}function is(t,e){if(1&t&&(R.Tc(0),R.nc(1,"translate"),R.nc(2,"amountFormat"),R.nc(3,"async")),2&t){const t=R.mc(2);R.Wc(" ",R.oc(1,2,"PAYMENTS.COMMISSION"),": ",R.oc(2,4,R.oc(3,6,t.commission$))," \u20b8 ")}}function ss(t,e){if(1&t){const t=R.Xb();R.Ub(0),R.Wb(1,"button",40),R.ic("click",(function(e){return R.Ic(t),R.mc(2).saveToDraft()})),R.Tc(2),R.nc(3,"translate"),R.Vb(),R.Wb(4,"button",41),R.Tc(5),R.nc(6,"translate"),R.Vb(),R.Tb()}if(2&t){const t=R.mc(2);R.Ab(2),R.Uc(R.oc(3,2,"PAYMENTS.FORM.SAVE")),R.Ab(3),R.Vc("",R.oc(6,4,t.submitLabel)," ")}}function cs(t,e){1&t&&(R.Ub(0),R.Wb(1,"button",42),R.Tc(2),R.nc(3,"translate"),R.Vb(),R.Tb()),2&t&&(R.Ab(2),R.Uc(R.oc(3,1,"PAYMENTS.FORM.SAVE_EDIT")))}function as(t,e){if(1&t){const t=R.Xb();R.Ub(0),R.Wb(1,"form",3,4),R.ic("submit",(function(e){return R.Ic(t),R.mc().onSubmit(e)})),R.Wb(3,"div",5),R.Wb(4,"fieldset"),R.Wb(5,"legend",6),R.Tc(6),R.nc(7,"translate"),R.Vb(),R.Wb(8,"div",7),R.Wb(9,"j-form-field"),R.Wb(10,"j-label"),R.Tc(11),R.nc(12,"translate"),R.Vb(),R.Rb(13,"input",8),R.Vb(),R.Vb(),R.Wb(14,"div",7),R.Wb(15,"j-form-field",null,9),R.Wb(17,"j-label"),R.Tc(18),R.nc(19,"translate"),R.Vb(),R.Rb(20,"j-select",10,11),R.nc(22,"async"),R.Vb(),R.Vb(),R.Wb(23,"div",12),R.Wb(24,"span",13),R.Tc(25),R.nc(26,"async"),R.Vb(),R.Wb(27,"j-form-field"),R.Wb(28,"j-label"),R.Tc(29),R.nc(30,"translate"),R.Vb(),R.Rb(31,"textarea",14,15),R.Rb(33,"j-error",16),R.Rc(34,es,3,1,"div",17),R.nc(35,"async"),R.Vb(),R.Vb(),R.Wb(36,"div",7),R.Wb(37,"j-account-dropdown",18,19),R.ic("selected",(function(e){return R.Ic(t),R.mc().onSenderAccountSelect(e)})),R.nc(39,"async"),R.nc(40,"async"),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Wb(41,"div",5),R.Wb(42,"fieldset"),R.Wb(43,"j-employee-group-control",20),R.Rb(44,"j-error",16),R.Vb(),R.Vb(),R.Vb(),R.Wb(45,"div",21),R.Wb(46,"div",7),R.Wb(47,"fieldset"),R.Wb(48,"ul",22),R.Wb(49,"li",23),R.Wb(50,"h5",24),R.Tc(51),R.nc(52,"translate"),R.Wb(53,"span",25),R.Wb(54,"strong"),R.Tc(55),R.nc(56,"amountFormat"),R.nc(57,"async"),R.Vb(),R.Tc(58," \u20b8"),R.Vb(),R.Vb(),R.Rc(59,ns,3,3,"div",26),R.nc(60,"async"),R.Wb(61,"p",27),R.Rc(62,os,3,3,"ng-container",28),R.nc(63,"async"),R.Rc(64,is,4,8,"ng-template",null,29,R.Sc),R.Vb(),R.Vb(),R.Wb(66,"li",30),R.Rb(67,"j-switch",31),R.Wb(68,"span",32),R.Tc(69),R.nc(70,"translate"),R.Rb(71,"br"),R.Wb(72,"small",33),R.Tc(73),R.nc(74,"translate"),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Wb(75,"div",34),R.Wb(76,"div",34),R.Rc(77,ss,7,6,"ng-container",1),R.Rc(78,cs,4,3,"ng-container",1),R.Vb(),R.Vb(),R.Rb(79,"ngx-spinner",35),R.Vb(),R.Tb()}if(2&t){const t=R.Fc(16),e=R.Fc(21),n=R.Fc(65),o=R.mc();R.Ab(1),R.uc("formGroup",o.form),R.Ab(5),R.Uc(R.oc(7,45,"PAYMENTS.FORM.DETAILS")),R.Ab(5),R.Uc(R.oc(12,47,"PAYMENTS.FORM.DOCUMENT_NUMBER")),R.Ab(2),R.uc("mask",o.masks.number.mask)("formControl",o.form.controls.number),R.Ab(5),R.Uc(R.oc(19,49,"PAYMENTS.FORM.KNP")),R.Ab(2),R.uc("jFocusOnReturn",e)("appendTo",t.elementRef.nativeElement)("formControl",o.form.controls.knp)("clearable",!1)("searchMask",o.masks.knp.mask)("shadow",o.masks.knp.shadow)("items",R.oc(22,51,o.knp$)),R.Ab(5),R.Wc(" ",R.oc(26,53,o.purposeLength$),"/",o.rules.purposeLength,""),R.Ab(4),R.Uc(R.oc(30,55,"PAYMENTS.FORM.PURPOSE")),R.Ab(2),R.uc("formControl",o.form.controls.purpose),R.Ab(2),R.uc("control",o.form.controls.purpose)("errorMessages",o.errors.purpose),R.Ab(1),R.uc("ngIf",R.oc(35,57,o.purposeMessage$)),R.Ab(3),R.uc("isLoading",R.oc(39,59,o.accountStore.fetching$))("label","PAYMENTS.SENDER_ACCOUNT.UNSELECTED")("hasError",o.form.controls.senderAccount.touched&&o.form.controls.senderAccount.errors)("accounts",R.oc(40,61,o.acceptableAccounts$)),R.Ab(6),R.uc("formControl",o.form.controls.employees)("paymentType",o.paymentType)("minAmount",o.employeeMinAmount)("maxAmount",o.employeeMaxAmount)("periodRequired",!0)("birthDateRequired",!0)("additionalPeriodEnabled",!0),R.Ab(1),R.uc("control",o.form.controls.employees)("errorMessages",o.errors.employees),R.Ab(7),R.Vc("",R.oc(52,63,"PAYMENTS.FORM.TOTAL_AMOUNT"),": "),R.Ab(4),R.Uc(R.oc(56,65,R.oc(57,67,o.total$))),R.Ab(4),R.uc("ngIf",R.oc(60,69,o.amountMessage$)),R.Ab(3),R.uc("ngIf",null===R.oc(63,71,o.commission$))("ngIfElse",n),R.Ab(5),R.uc("formControl",o.form.controls.urgent),R.Ab(2),R.Vc("",R.oc(70,73,"PAYMENTS.FORM.URGENT")," "),R.Ab(4),R.Uc(R.oc(74,75,"PAYMENTS.URGENT_HELPER")),R.Ab(4),R.uc("ngIf",o.restoredData.status!==o.PAYMENT_STATUS.CREATED),R.Ab(1),R.uc("ngIf",o.restoredData.status===o.PAYMENT_STATUS.CREATED),R.Ab(1),R.uc("name",o.SPINNER)("fullScreen",!1)}}let rs=(()=>{class t extends ke{constructor(t,e,n,o,i,s,c,a,r,l,b,u,m,d,p){super(d.createPensionForm(),l,t,e,o,n,s,a,r,b,u,m,p),this.route=t,this.router=e,this.paymentsService=n,this.companyService=o,this.dateAdapter=i,this.maskService=s,this.accountsService=c,this.modalService=a,this.dictionaries=r,this.api=l,this.pipeline=b,this.translateService=u,this.authorityPermissionsService=m,this.paymentsFormsFactory=d,this.featureFlagsService=p,this.masks={number:"paymentNum",amount:"amount",knp:"knp"},this.employeeMinAmount=6e3,this.employeeMaxAmount=null,this.employees$=new I.a([]),this.amount$=new I.a(0),this.subs=new Et.a,this.paymentType=B.j.PENSION}ngOnInit(){super.ngOnInit(),this.accountStore=this.accountsService.store,this.acceptableAccounts$=this.paymentsService.combineAcceptableAccounts(this.accountStore).pipe(Object(F.a)(t=>this.checkPersonalAccounts(t))),this.getMaskConfig(),this.createControlsStream(this.form),this.knp$=this.combineKNP(),this.combineEmployeesAmount(),this.listenCommission(),this.listenTotal(),this.provideAmountMessage(),this.listenDateMessageStream(),this.listenPurposeMessageStream()}}return t.\u0275fac=function(e){return new(e||t)(R.Qb(p.a),R.Qb(p.c),R.Qb(Te.g),R.Qb(ti.a),R.Qb(c.c),R.Qb(Oe.a),R.Qb(l.c),R.Qb(c.q),R.Qb(Wi.a),R.Qb(Te.c),R.Qb(Te.f),R.Qb(a.e),R.Qb(je.c),R.Qb(Te.e),R.Qb(q.b))},t.\u0275cmp=R.Kb({type:t,selectors:[["j-pension-payment"]],features:[R.xb],decls:2,vars:2,consts:[["label","PAYMENTS.RESTRICTED_PLACEHOLDER",3,"isRetryable","isLoading","retried",4,"ngIf"],[4,"ngIf"],["label","PAYMENTS.RESTRICTED_PLACEHOLDER",3,"isRetryable","isLoading","retried"],["jInvalidControlScroll","","autocomplete","off","jFocusableContainer","",3,"formGroup","submit"],["formDirective","ngForm"],[1,"form-section"],[1,"h2"],[1,"form-group"],["jFocusOnReturn","","type","text","jFormInput","",1,"form-control",3,"mask","formControl"],["knpWrapper",""],["bindValue","code","bindLabel","label",3,"jFocusOnReturn","appendTo","formControl","clearable","searchMask","shadow","items"],["select",""],[1,"form-group","position-relative"],[1,"payment-section--purpose-length","p3","text-gray"],["jFocusOnReturn","","jFormInput","","rows","5",1,"form-control",3,"formControl"],["purpose",""],[3,"control","errorMessages"],["jBottomLine","","class","j-form-field-bottom",4,"ngIf"],[3,"isLoading","label","hasError","accounts","selected"],["senderAccountDropdown",""],[3,"formControl","paymentType","minAmount","maxAmount","periodRequired","birthDateRequired","additionalPeriodEnabled"],[1,"payment-section--summary","form-section"],[1,"list-group"],[1,"list-group-item"],[1,"light","m-0"],[1,"h3"],["class","payment-section--amount-warn mt-1 p2",4,"ngIf"],[1,"p3","text","text-gray","d-inline-block","m-0"],[4,"ngIf","ngIfElse"],["commission",""],[1,"list-group-item","d-flex","align-items-center"],[3,"formControl"],[1,"ml-3"],[1,"text-gray"],[1,"payment-section--submit","form-group","pt-4"],["type","ball-scale-ripple-multiple","size","large","color","#d6dadf","zIndex","3","bdColor","rgba(246, 247, 248, 0.3)",3,"name","fullScreen"],["jBottomLine","",1,"j-form-field-bottom"],[1,"text-truncate","small"],[1,"payment-section--amount-warn","mt-1","p2"],[3,"innerHTML"],["type","button",1,"btn","btn-outline-primary","btn-static",3,"click"],["type","submit",1,"btn","btn-primary","btn-static","ml-3"],["type","submit",1,"btn","btn-outline-primary","btn-static"]],template:function(t,e){1&t&&(R.Rc(0,ts,1,2,"j-restricted-placeholder",0),R.Rc(1,as,80,77,"ng-container",1)),2&t&&(R.uc("ngIf",e.isRestricted),R.Ab(1),R.uc("ngIf",!e.isRestricted))},directives:[o.u,xe.a,i.J,i.u,_e.b,Nt.b,i.l,z.a,Vt.a,tt.a,i.c,Nt.a,s.a,i.t,i.i,Ye.a,Ot.a,De.a,Zi.a,we.a,Ke.a,Ge.a],pipes:[a.d,o.b,si.a],styles:[""],encapsulation:2}),t})();function ls(t,e){if(1&t){const t=R.Xb();R.Wb(0,"j-restricted-placeholder",2),R.ic("retried",(function(e){return R.Ic(t),R.mc().updatePermissions()})),R.Vb()}if(2&t){const t=R.mc();R.uc("isRetryable",t.isPermissionsUpdateAllowed)("isLoading",t.isPermissionsUpdating)}}function bs(t,e){if(1&t&&(R.Wb(0,"div",36),R.Wb(1,"div",37),R.Tc(2),R.Vb(),R.Vb()),2&t){const t=e.ngIf;R.Ab(2),R.Vc(" ",t," ")}}function us(t,e){if(1&t&&(R.Wb(0,"div",38),R.Rb(1,"span",39),R.nc(2,"translate"),R.Vb()),2&t){const t=e.ngIf;R.Ab(1),R.uc("innerHTML",R.oc(2,1,t),R.Jc)}}function ms(t,e){1&t&&(R.Ub(0),R.Tc(1),R.nc(2,"translate"),R.Tb()),2&t&&(R.Ab(1),R.Vc(" ",R.oc(2,1,"PAYMENTS.COMMISSION_CALC_AUTO")," "))}function ds(t,e){if(1&t&&(R.Tc(0),R.nc(1,"translate"),R.nc(2,"amountFormat"),R.nc(3,"async")),2&t){const t=R.mc(2);R.Wc(" ",R.oc(1,2,"PAYMENTS.COMMISSION"),": ",R.oc(2,4,R.oc(3,6,t.commission$))," \u20b8 ")}}function ps(t,e){if(1&t){const t=R.Xb();R.Ub(0),R.Wb(1,"button",40),R.ic("click",(function(e){return R.Ic(t),R.mc(2).saveToDraft()})),R.Tc(2),R.nc(3,"translate"),R.Vb(),R.Wb(4,"button",41),R.Tc(5),R.nc(6,"translate"),R.Vb(),R.Tb()}if(2&t){const t=R.mc(2);R.Ab(2),R.Uc(R.oc(3,2,"PAYMENTS.FORM.SAVE")),R.Ab(3),R.Vc("",R.oc(6,4,t.submitLabel)," ")}}function hs(t,e){1&t&&(R.Ub(0),R.Wb(1,"button",42),R.Tc(2),R.nc(3,"translate"),R.Vb(),R.Tb()),2&t&&(R.Ab(2),R.Uc(R.oc(3,1,"PAYMENTS.FORM.SAVE_EDIT")))}function fs(t,e){if(1&t){const t=R.Xb();R.Ub(0),R.Wb(1,"form",3,4),R.ic("submit",(function(e){return R.Ic(t),R.mc().onSubmit(e)})),R.Wb(3,"div",5),R.Wb(4,"fieldset"),R.Wb(5,"legend",6),R.Tc(6),R.nc(7,"translate"),R.Vb(),R.Wb(8,"div",7),R.Wb(9,"j-form-field"),R.Wb(10,"j-label"),R.Tc(11),R.nc(12,"translate"),R.Vb(),R.Rb(13,"input",8),R.Vb(),R.Vb(),R.Wb(14,"div",7),R.Wb(15,"j-form-field",null,9),R.Wb(17,"j-label"),R.Tc(18),R.nc(19,"translate"),R.Vb(),R.Rb(20,"j-select",10,11),R.nc(22,"async"),R.Vb(),R.Vb(),R.Wb(23,"div",12),R.Wb(24,"span",13),R.Tc(25),R.nc(26,"async"),R.Vb(),R.Wb(27,"j-form-field"),R.Wb(28,"j-label"),R.Tc(29),R.nc(30,"translate"),R.Vb(),R.Rb(31,"textarea",14,15),R.Rb(33,"j-error",16),R.Rc(34,bs,3,1,"div",17),R.nc(35,"async"),R.Vb(),R.Vb(),R.Wb(36,"div",7),R.Wb(37,"j-account-dropdown",18,19),R.ic("selected",(function(e){return R.Ic(t),R.mc().onSenderAccountSelect(e)})),R.nc(39,"async"),R.nc(40,"async"),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Wb(41,"div",5),R.Wb(42,"fieldset"),R.Wb(43,"j-employee-group-control",20),R.Rb(44,"j-error",16),R.Vb(),R.Vb(),R.Vb(),R.Wb(45,"div",21),R.Wb(46,"div",7),R.Wb(47,"fieldset"),R.Wb(48,"ul",22),R.Wb(49,"li",23),R.Wb(50,"h5",24),R.Tc(51),R.nc(52,"translate"),R.Wb(53,"span",25),R.Wb(54,"strong"),R.Tc(55),R.nc(56,"amountFormat"),R.nc(57,"async"),R.Vb(),R.Tc(58," \u20b8"),R.Vb(),R.Vb(),R.Rc(59,us,3,3,"div",26),R.nc(60,"async"),R.Wb(61,"p",27),R.Rc(62,ms,3,3,"ng-container",28),R.nc(63,"async"),R.Rc(64,ds,4,8,"ng-template",null,29,R.Sc),R.Vb(),R.Vb(),R.Wb(66,"li",30),R.Rb(67,"j-switch",31),R.Wb(68,"span",32),R.Tc(69),R.nc(70,"translate"),R.Rb(71,"br"),R.Wb(72,"small",33),R.Tc(73),R.nc(74,"translate"),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Wb(75,"div",34),R.Wb(76,"div",34),R.Rc(77,ps,7,6,"ng-container",1),R.Rc(78,hs,4,3,"ng-container",1),R.Vb(),R.Vb(),R.Rb(79,"ngx-spinner",35),R.Vb(),R.Tb()}if(2&t){const t=R.Fc(16),e=R.Fc(21),n=R.Fc(65),o=R.mc();R.Ab(1),R.uc("formGroup",o.form),R.Ab(5),R.Uc(R.oc(7,45,"PAYMENTS.FORM.DETAILS")),R.Ab(5),R.Uc(R.oc(12,47,"PAYMENTS.FORM.DOCUMENT_NUMBER")),R.Ab(2),R.uc("mask",o.masks.number.mask)("formControl",o.form.controls.number),R.Ab(5),R.Uc(R.oc(19,49,"PAYMENTS.FORM.KNP")),R.Ab(2),R.uc("jFocusOnReturn",e)("appendTo",t.elementRef.nativeElement)("formControl",o.form.controls.knp)("clearable",!1)("searchMask",o.masks.knp.mask)("shadow",o.masks.knp.shadow)("items",R.oc(22,51,o.knp$)),R.Ab(5),R.Wc(" ",R.oc(26,53,o.purposeLength$),"/",o.rules.purposeLength,""),R.Ab(4),R.Uc(R.oc(30,55,"PAYMENTS.FORM.PURPOSE")),R.Ab(2),R.uc("formControl",o.form.controls.purpose),R.Ab(2),R.uc("control",o.form.controls.purpose)("errorMessages",o.errors.purpose),R.Ab(1),R.uc("ngIf",R.oc(35,57,o.purposeMessage$)),R.Ab(3),R.uc("isLoading",R.oc(39,59,o.accountStore.fetching$))("label","PAYMENTS.SENDER_ACCOUNT.UNSELECTED")("hasError",o.form.controls.senderAccount.touched&&o.form.controls.senderAccount.errors)("accounts",R.oc(40,61,o.acceptableAccounts$)),R.Ab(6),R.uc("formControl",o.form.controls.employees)("paymentType",o.paymentType)("periodRequired",!0)("birthDateRequired",!0)("minAmount",o.employeeMinAmount)("maxAmount",o.employeeMaxAmount)("additionalPeriodEnabled",!0),R.Ab(1),R.uc("control",o.form.controls.employees)("errorMessages",o.errors.employees),R.Ab(7),R.Vc("",R.oc(52,63,"PAYMENTS.FORM.TOTAL_AMOUNT"),": "),R.Ab(4),R.Uc(R.oc(56,65,R.oc(57,67,o.total$))),R.Ab(4),R.uc("ngIf",R.oc(60,69,o.amountMessage$)),R.Ab(3),R.uc("ngIf",null===R.oc(63,71,o.commission$))("ngIfElse",n),R.Ab(5),R.uc("formControl",o.form.controls.urgent),R.Ab(2),R.Vc("",R.oc(70,73,"PAYMENTS.FORM.URGENT")," "),R.Ab(4),R.Uc(R.oc(74,75,"PAYMENTS.URGENT_HELPER")),R.Ab(4),R.uc("ngIf",o.restoredData.status!==o.PAYMENT_STATUS.CREATED),R.Ab(1),R.uc("ngIf",o.restoredData.status===o.PAYMENT_STATUS.CREATED),R.Ab(1),R.uc("name",o.SPINNER)("fullScreen",!1)}}let gs=(()=>{class t extends ke{constructor(t,e,n,o,i,s,c,a,r,l,b,u,m,d,p){super(m.createSocialForm(),r,o,i,e,t,s,a,l,b,u,p,d),this.paymentsService=t,this.companyService=e,this.dateAdapter=n,this.route=o,this.router=i,this.maskService=s,this.accountsService=c,this.modalService=a,this.api=r,this.dictionaries=l,this.pipeline=b,this.translateService=u,this.paymentsFormsFactory=m,this.featureFlagsService=d,this.authorityPermissionsService=p,this.masks={number:"paymentNum",amount:"amount",knp:"knp"},this.employeeMinAmount=2100,this.employeeMaxAmount=null,this.paymentType=B.j.SOCIAL}ngOnInit(){super.ngOnInit(),this.dateLimit=this.paymentsService.stdDateRangeNgb,this.accountStore=this.accountsService.store,this.acceptableAccounts$=this.paymentsService.combineAcceptableAccounts(this.accountStore).pipe(Object(F.a)(t=>this.checkPersonalAccounts(t))),this.getMaskConfig(),this.createControlsStream(this.form),this.listenWorkingDays(),this.combineEmployeesAmount(),this.listenCommission(),this.listenTotal(),this.provideAmountMessage(),this.listenDateMessageStream(),this.listenPurposeMessageStream(),this.knp$=this.combineKNP()}}return t.\u0275fac=function(e){return new(e||t)(R.Qb(C.c),R.Qb(ti.a),R.Qb(c.c),R.Qb(p.a),R.Qb(p.c),R.Qb(Oe.a),R.Qb(l.c),R.Qb(c.q),R.Qb(ni.a),R.Qb(at.a),R.Qb(ei.a),R.Qb(a.e),R.Qb(oi.a),R.Qb(q.b),R.Qb(je.c))},t.\u0275cmp=R.Kb({type:t,selectors:[["j-social-payment"]],features:[R.xb],decls:2,vars:2,consts:[["label","PAYMENTS.RESTRICTED_PLACEHOLDER",3,"isRetryable","isLoading","retried",4,"ngIf"],[4,"ngIf"],["label","PAYMENTS.RESTRICTED_PLACEHOLDER",3,"isRetryable","isLoading","retried"],["jInvalidControlScroll","","jFocusableContainer","","autocomplete","off",3,"formGroup","submit"],["formDirective","ngForm"],[1,"form-section"],[1,"h2"],[1,"form-group"],["jFocusOnReturn","","type","text","jFormInput","",1,"form-control",3,"mask","formControl"],["knpWrapper",""],["bindValue","code","bindLabel","label",3,"jFocusOnReturn","appendTo","formControl","clearable","searchMask","shadow","items"],["select",""],[1,"form-group","position-relative"],[1,"payment-section--purpose-length","p3","text-gray"],["jFocusOnReturn","","jFormInput","","rows","5",1,"form-control",3,"formControl"],["purpose",""],[3,"control","errorMessages"],["jBottomLine","","class","j-form-field-bottom",4,"ngIf"],[3,"isLoading","label","hasError","accounts","selected"],["senderAccountDropdown",""],[3,"formControl","paymentType","periodRequired","birthDateRequired","minAmount","maxAmount","additionalPeriodEnabled"],[1,"payment-section--summary","form-section"],[1,"list-group"],[1,"list-group-item"],[1,"light","m-0"],[1,"h3"],["class","payment-section--amount-warn mt-1 p2",4,"ngIf"],[1,"p3","text","text-gray","d-inline-block","m-0"],[4,"ngIf","ngIfElse"],["commission",""],[1,"list-group-item","d-flex","align-items-center"],[3,"formControl"],[1,"ml-3"],[1,"text-gray"],[1,"payment-section--submit","form-group","pt-4"],["type","ball-scale-ripple-multiple","size","large","color","#d6dadf","zIndex","3","bdColor","rgba(246, 247, 248, 0.3)",3,"name","fullScreen"],["jBottomLine","",1,"j-form-field-bottom"],[1,"text-truncate","small"],[1,"payment-section--amount-warn","mt-1","p2"],[3,"innerHTML"],["type","button",1,"btn","btn-outline-primary","btn-static",3,"click"],["type","submit",1,"btn","btn-primary","btn-static","ml-3"],["type","submit",1,"btn","btn-outline-primary","btn-static"]],template:function(t,e){1&t&&(R.Rc(0,ls,1,2,"j-restricted-placeholder",0),R.Rc(1,fs,80,77,"ng-container",1)),2&t&&(R.uc("ngIf",e.isRestricted),R.Ab(1),R.uc("ngIf",!e.isRestricted))},directives:[o.u,xe.a,i.J,i.u,_e.b,Nt.b,i.l,z.a,Vt.a,tt.a,i.c,Nt.a,s.a,i.t,i.i,Ye.a,Ot.a,De.a,Zi.a,we.a,Ke.a,Ge.a],pipes:[a.d,o.b,si.a],styles:[""]}),t})();function As(t,e){if(1&t){const t=R.Xb();R.Wb(0,"j-restricted-placeholder",2),R.ic("retried",(function(e){return R.Ic(t),R.mc().updatePermissions()})),R.Vb()}if(2&t){const t=R.mc();R.uc("isRetryable",t.isPermissionsUpdateAllowed)("isLoading",t.isPermissionsUpdating)}}function Ts(t,e){if(1&t&&(R.Wb(0,"div",36),R.Wb(1,"div",37),R.Tc(2),R.nc(3,"translate"),R.Vb(),R.Vb()),2&t){const t=e.ngIf;R.Ab(2),R.Vc(" ",R.oc(3,1,t)," ")}}function ys(t,e){if(1&t&&(R.Wb(0,"div",38),R.Rb(1,"span",39),R.nc(2,"translate"),R.Vb()),2&t){const t=e.ngIf;R.Ab(1),R.uc("innerHTML",R.oc(2,1,t),R.Jc)}}function Rs(t,e){1&t&&(R.Ub(0),R.Tc(1),R.nc(2,"translate"),R.Tb()),2&t&&(R.Ab(1),R.Vc(" ",R.oc(2,1,"PAYMENTS.COMMISSION_CALC_AUTO")," "))}function vs(t,e){if(1&t&&(R.Tc(0),R.nc(1,"translate"),R.nc(2,"amountFormat"),R.nc(3,"async")),2&t){const t=R.mc(2);R.Wc(" ",R.oc(1,2,"PAYMENTS.COMMISSION"),": ",R.oc(2,4,R.oc(3,6,t.commission$))," \u20b8 ")}}function Cs(t,e){if(1&t){const t=R.Xb();R.Ub(0),R.Wb(1,"button",40),R.ic("click",(function(e){return R.Ic(t),R.mc(2).saveToDraft()})),R.Tc(2),R.nc(3,"translate"),R.Vb(),R.Wb(4,"button",41),R.Tc(5),R.nc(6,"translate"),R.Vb(),R.Tb()}if(2&t){const t=R.mc(2);R.Ab(2),R.Uc(R.oc(3,2,"PAYMENTS.FORM.SAVE")),R.Ab(3),R.Vc("",R.oc(6,4,t.submitLabel)," ")}}function Es(t,e){1&t&&(R.Ub(0),R.Wb(1,"button",42),R.Tc(2),R.nc(3,"translate"),R.Vb(),R.Tb()),2&t&&(R.Ab(2),R.Uc(R.oc(3,1,"PAYMENTS.FORM.SAVE_EDIT")))}function Ss(t,e){if(1&t){const t=R.Xb();R.Ub(0),R.Wb(1,"form",3,4),R.ic("submit",(function(e){return R.Ic(t),R.mc().onSubmit(e)})),R.Wb(3,"div",5),R.Wb(4,"fieldset"),R.Wb(5,"legend",6),R.Tc(6),R.nc(7,"translate"),R.Vb(),R.Wb(8,"div",7),R.Wb(9,"j-form-field"),R.Wb(10,"j-label"),R.Tc(11),R.nc(12,"translate"),R.Vb(),R.Rb(13,"input",8),R.Vb(),R.Vb(),R.Wb(14,"div",7),R.Wb(15,"j-form-field",null,9),R.Wb(17,"j-label"),R.Tc(18),R.nc(19,"translate"),R.Vb(),R.Rb(20,"j-select",10,11),R.nc(22,"async"),R.Vb(),R.Vb(),R.Wb(23,"div",12),R.Wb(24,"span",13),R.Tc(25),R.nc(26,"async"),R.Vb(),R.Wb(27,"j-form-field"),R.Wb(28,"j-label"),R.Tc(29),R.nc(30,"translate"),R.Vb(),R.Rb(31,"textarea",14,15),R.Rb(33,"j-error",16),R.Rc(34,Ts,4,3,"div",17),R.nc(35,"async"),R.Vb(),R.Vb(),R.Wb(36,"div",7),R.Wb(37,"j-account-dropdown",18,19),R.ic("selected",(function(e){return R.Ic(t),R.mc().onSenderAccountSelect(e)})),R.nc(39,"async"),R.nc(40,"async"),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Wb(41,"div",5),R.Wb(42,"fieldset"),R.Wb(43,"j-employee-group-control",20),R.Rb(44,"j-error",16),R.Vb(),R.Vb(),R.Vb(),R.Wb(45,"div",21),R.Wb(46,"div",7),R.Wb(47,"fieldset"),R.Wb(48,"ul",22),R.Wb(49,"li",23),R.Wb(50,"h5",24),R.Tc(51),R.nc(52,"translate"),R.Wb(53,"span",25),R.Wb(54,"strong"),R.Tc(55),R.nc(56,"amountFormat"),R.nc(57,"async"),R.Vb(),R.Tc(58," \u20b8"),R.Vb(),R.Vb(),R.Rc(59,ys,3,3,"div",26),R.nc(60,"async"),R.Wb(61,"p",27),R.Rc(62,Rs,3,3,"ng-container",28),R.nc(63,"async"),R.Rc(64,vs,4,8,"ng-template",null,29,R.Sc),R.Vb(),R.Vb(),R.Wb(66,"li",30),R.Rb(67,"j-switch",31),R.Wb(68,"span",32),R.Tc(69),R.nc(70,"translate"),R.Rb(71,"br"),R.Wb(72,"small",33),R.Tc(73),R.nc(74,"translate"),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Wb(75,"div",34),R.Rc(76,Cs,7,6,"ng-container",1),R.Rc(77,Es,4,3,"ng-container",1),R.Vb(),R.Rb(78,"ngx-spinner",35),R.Vb(),R.Tb()}if(2&t){const t=R.Fc(16),e=R.Fc(21),n=R.Fc(65),o=R.mc();R.Ab(1),R.uc("formGroup",o.form),R.Ab(5),R.Uc(R.oc(7,45,"PAYMENTS.FORM.DETAILS")),R.Ab(5),R.Uc(R.oc(12,47,"PAYMENTS.FORM.DOCUMENT_NUMBER")),R.Ab(2),R.uc("mask",o.masks.number.mask)("formControl",o.form.controls.number),R.Ab(5),R.Uc(R.oc(19,49,"PAYMENTS.FORM.KNP")),R.Ab(2),R.uc("jFocusOnReturn",e)("appendTo",t.elementRef.nativeElement)("formControl",o.form.controls.knp)("clearable",!1)("searchMask",o.masks.knp.mask)("shadow",o.masks.knp.shadow)("items",R.oc(22,51,o.knp$)),R.Ab(5),R.Wc(" ",R.oc(26,53,o.purposeLength$),"/",o.rules.purposeLength,""),R.Ab(4),R.Uc(R.oc(30,55,"PAYMENTS.FORM.PURPOSE")),R.Ab(2),R.uc("formControl",o.form.controls.purpose),R.Ab(2),R.uc("control",o.form.controls.purpose)("errorMessages",o.errors.purpose),R.Ab(1),R.uc("ngIf",R.oc(35,57,o.purposeMessage$)),R.Ab(3),R.uc("isLoading",R.oc(39,59,o.accountStore.fetching$))("label","PAYMENTS.SENDER_ACCOUNT.UNSELECTED")("hasError",o.form.controls.senderAccount.touched&&o.form.controls.senderAccount.errors)("accounts",R.oc(40,61,o.acceptableAccounts$)),R.Ab(6),R.uc("formControl",o.form.controls.employees)("paymentType",o.paymentType)("minAmount",o.employeeMinAmount)("maxAmount",o.employeeMaxAmount)("periodRequired",!0)("birthDateRequired",!0)("additionalPeriodEnabled",!0),R.Ab(1),R.uc("control",o.form.controls.employees)("errorMessages",o.errors.employees),R.Ab(7),R.Vc("",R.oc(52,63,"PAYMENTS.FORM.TOTAL_AMOUNT"),": "),R.Ab(4),R.Uc(R.oc(56,65,R.oc(57,67,o.total$))),R.Ab(4),R.uc("ngIf",R.oc(60,69,o.amountMessage$)),R.Ab(3),R.uc("ngIf",null===R.oc(63,71,o.commission$))("ngIfElse",n),R.Ab(5),R.uc("formControl",o.form.controls.urgent),R.Ab(2),R.Vc("",R.oc(70,73,"PAYMENTS.FORM.URGENT")," "),R.Ab(4),R.Uc(R.oc(74,75,"PAYMENTS.URGENT_HELPER")),R.Ab(3),R.uc("ngIf",o.restoredData.status!==o.PAYMENT_STATUS.CREATED),R.Ab(1),R.uc("ngIf",o.restoredData.status===o.PAYMENT_STATUS.CREATED),R.Ab(1),R.uc("name",o.SPINNER)("fullScreen",!1)}}let Vs=(()=>{class t extends ke{constructor(t,e,n,o,i,s,c,a,r,l,b,u,m,d,p){super(m.createMedicalForm(),l,t,e,o,n,s,a,r,b,u,d,p),this.route=t,this.router=e,this.paymentsService=n,this.companyService=o,this.dateAdapter=i,this.maskService=s,this.accountsService=c,this.modalService=a,this.dictionaries=r,this.api=l,this.pipeline=b,this.translateService=u,this.paymentsFormsFactory=m,this.authorityPermissionsService=d,this.featureFlagsService=p,this.masks={number:"paymentNum",amount:"amount",knp:"knp"},this.employeeMinAmount=4200,this.employeeMaxAmount=null,this.paymentType=B.j.MEDICAL}ngOnInit(){super.ngOnInit(),this.accountStore=this.accountsService.store,this.acceptableAccounts$=this.paymentsService.combineAcceptableAccounts(this.accountStore).pipe(Object(F.a)(t=>this.checkPersonalAccounts(t))),this.getMaskConfig(),this.createControlsStream(this.form),this.knp$=this.combineKNP(),this.combineEmployeesAmount(),this.listenCommission(),this.listenTotal(),this.provideAmountMessage(),this.listenDateMessageStream(),this.listenPurposeMessageStream()}}return t.\u0275fac=function(e){return new(e||t)(R.Qb(p.a),R.Qb(p.c),R.Qb(C.c),R.Qb(ti.a),R.Qb(c.c),R.Qb(Oe.a),R.Qb(l.c),R.Qb(c.q),R.Qb(at.a),R.Qb(ni.a),R.Qb(ei.a),R.Qb(a.e),R.Qb(oi.a),R.Qb(je.c),R.Qb(q.b))},t.\u0275cmp=R.Kb({type:t,selectors:[["j-medical-payment"]],features:[R.xb],decls:2,vars:2,consts:[["label","PAYMENTS.RESTRICTED_PLACEHOLDER",3,"isRetryable","isLoading","retried",4,"ngIf"],[4,"ngIf"],["label","PAYMENTS.RESTRICTED_PLACEHOLDER",3,"isRetryable","isLoading","retried"],["jInvalidControlScroll","","jFocusableContainer","","autocomplete","off",3,"formGroup","submit"],["formDirective","ngForm"],[1,"form-section"],[1,"h2"],[1,"form-group"],["jFocusOnReturn","","type","text","jFormInput","",1,"form-control",3,"mask","formControl"],["knpWrapper",""],["bindValue","code","bindLabel","label",3,"jFocusOnReturn","appendTo","formControl","clearable","searchMask","shadow","items"],["select",""],[1,"form-group","position-relative"],[1,"payment-section--purpose-length","p3","text-gray"],["jFocusOnReturn","","jFormInput","","rows","5",1,"form-control",3,"formControl"],["purpose",""],[3,"control","errorMessages"],["jBottomLine","","class","j-form-field-bottom",4,"ngIf"],[3,"isLoading","label","hasError","accounts","selected"],["senderAccountDropdown",""],[3,"formControl","paymentType","minAmount","maxAmount","periodRequired","birthDateRequired","additionalPeriodEnabled"],[1,"payment-section--summary","form-section"],[1,"list-group"],[1,"list-group-item"],[1,"light","m-0"],[1,"h3"],["class","payment-section--amount-warn mt-1 p2",4,"ngIf"],[1,"p3","text","text-gray","d-inline-block","m-0"],[4,"ngIf","ngIfElse"],["commission",""],[1,"list-group-item","d-flex","align-items-center"],[3,"formControl"],[1,"ml-3"],[1,"text-gray"],[1,"payment-section--submit","form-group","pt-4"],["type","ball-scale-ripple-multiple","size","large","color","#d6dadf","zIndex","3","bdColor","rgba(246, 247, 248, 0.3)",3,"name","fullScreen"],["jBottomLine","",1,"j-form-field-bottom"],[1,"text-truncate","small"],[1,"payment-section--amount-warn","mt-1","p2"],[3,"innerHTML"],["type","button",1,"btn","btn-outline-primary","btn-static",3,"click"],["type","submit",1,"btn","btn-primary","btn-static","ml-3"],["type","submit",1,"btn","btn-outline-primary","btn-static"]],template:function(t,e){1&t&&(R.Rc(0,As,1,2,"j-restricted-placeholder",0),R.Rc(1,Ss,79,77,"ng-container",1)),2&t&&(R.uc("ngIf",e.isRestricted),R.Ab(1),R.uc("ngIf",!e.isRestricted))},directives:[o.u,xe.a,i.J,i.u,_e.b,Nt.b,i.l,z.a,Vt.a,tt.a,i.c,Nt.a,s.a,i.t,i.i,Ye.a,Ot.a,De.a,Zi.a,we.a,Ke.a,Ge.a],pipes:[a.d,o.b,si.a],styles:[""]}),t})();function Ns(t,e){if(1&t){const t=R.Xb();R.Wb(0,"j-restricted-placeholder",2),R.ic("retried",(function(e){return R.Ic(t),R.mc().updatePermissions()})),R.Vb()}if(2&t){const t=R.mc();R.uc("isRetryable",t.isPermissionsUpdateAllowed)("isLoading",t.isPermissionsUpdating)}}function Is(t,e){1&t&&(R.Wb(0,"j-label"),R.Tc(1),R.nc(2,"translate"),R.Vb()),2&t&&(R.Ab(1),R.Vc("",R.oc(2,1,"PAYMENTS.FORM.RECEIVER_BANK")," "))}function ks(t,e){if(1&t&&(R.Wb(0,"div",56),R.Wb(1,"div",57),R.Rb(2,"j-entity-logo",58),R.Vb(),R.Wb(3,"div",59),R.Wb(4,"p",60),R.Tc(5),R.nc(6,"translate"),R.Vb(),R.Wb(7,"p",61),R.Tc(8),R.Vb(),R.Vb(),R.Vb()),2&t){const t=e.item;R.Ab(2),R.uc("name",t.bic),R.Ab(3),R.Vc(" ",t.salaryTransitIban?R.oc(6,4,"PAYMENTS.FORM.ACCOUNT")+t.salaryTransitIban:t.name," "),R.Ab(3),R.Wc("",t.bic,": ",t.name,"")}}function Os(t,e){if(1&t&&(R.Wb(0,"div",62),R.Wb(1,"div",57),R.Rb(2,"j-entity-logo",58),R.Vb(),R.Wb(3,"div",59),R.Wb(4,"p",60),R.Tc(5),R.nc(6,"translate"),R.Vb(),R.Wb(7,"p",61),R.Tc(8),R.Vb(),R.Vb(),R.Vb()),2&t){const t=e.item;R.Ab(2),R.uc("name",t.bic),R.Ab(3),R.Vc(" ",t.salaryTransitIban?R.oc(6,4,"PAYMENTS.FORM.ACCOUNT")+t.salaryTransitIban:t.name," "),R.Ab(3),R.Wc("",t.bic,": ",t.name," ")}}function js(t,e){if(1&t&&(R.Wb(0,"div",10),R.Wb(1,"j-form-field",63),R.Wb(2,"j-label"),R.Tc(3),R.nc(4,"translate"),R.Vb(),R.Rb(5,"input",64,65),R.Rb(7,"j-error",28),R.Vb(),R.Vb()),2&t){const t=R.mc(2);R.Ab(3),R.Uc(R.oc(4,7,"PAYMENTS.FORM.BANK_IBAN")),R.Ab(2),R.uc("jShadow",t.masks.bankAccount.shadow)("dropSpecialCharacters",!0)("mask",t.masks.bankAccount.mask)("formControl",t.form.controls.bankAccount),R.Ab(2),R.uc("control",t.form.controls.bankAccount)("errorMessages",t.errors.bankAccount)}}function Ws(t,e){if(1&t&&(R.Wb(0,"div",66),R.Tc(1),R.Vb()),2&t){const t=e.item;R.Ab(1),R.Uc(t.label)}}function Ms(t,e){if(1&t&&(R.Wb(0,"div",67),R.Wb(1,"div",68),R.Tc(2),R.Vb(),R.Vb()),2&t){const t=e.ngIf;R.Ab(2),R.Vc(" ",t," ")}}function Ps(t,e){if(1&t&&(R.Wb(0,"div",69),R.Rb(1,"span",70),R.nc(2,"translate"),R.Vb()),2&t){const t=e.ngIf;R.Ab(1),R.uc("innerHTML",R.oc(2,1,t),R.Jc)}}function xs(t,e){1&t&&(R.Ub(0),R.Tc(1),R.nc(2,"translate"),R.Tb()),2&t&&(R.Ab(1),R.Vc(" ",R.oc(2,1,"PAYMENTS.COMMISSION_CALC_AUTO")," "))}function _s(t,e){if(1&t&&(R.Tc(0),R.nc(1,"translate"),R.nc(2,"amountFormat"),R.nc(3,"async")),2&t){const t=R.mc(2);R.Wc(" ",R.oc(1,2,"PAYMENTS.COMMISSION"),": ",R.oc(2,4,R.oc(3,6,t.commission$))," \u20b8 ")}}function Ds(t,e){1&t&&(R.Rb(0,"p",71),R.nc(1,"translate")),2&t&&R.uc("innerHTML",R.oc(1,1,"PAYMENTS.FORM.RESIDENT_AGREEMENT"),R.Jc)}function ws(t,e){if(1&t){const t=R.Xb();R.Ub(0),R.Wb(1,"button",72),R.ic("click",(function(e){return R.Ic(t),R.mc(2).saveToDraft()})),R.Tc(2),R.nc(3,"translate"),R.Vb(),R.Wb(4,"button",73),R.Tc(5),R.nc(6,"translate"),R.Vb(),R.Tb()}if(2&t){const t=R.mc(2);R.Ab(2),R.Uc(R.oc(3,2,"PAYMENTS.FORM.SAVE")),R.Ab(3),R.Vc("",R.oc(6,4,t.submitLabel)," ")}}function Ys(t,e){1&t&&(R.Ub(0),R.Wb(1,"button",74),R.Tc(2),R.nc(3,"translate"),R.Vb(),R.Tb()),2&t&&(R.Ab(2),R.Uc(R.oc(3,1,"PAYMENTS.FORM.SAVE_EDIT")))}function Us(t,e){if(1&t){const t=R.Xb();R.Ub(0),R.Wb(1,"div",3),R.Wb(2,"form",4,5),R.ic("submit",(function(e){return R.Ic(t),R.mc().onSubmit(e)})),R.Wb(4,"div",6),R.Wb(5,"fieldset"),R.Wb(6,"div",7),R.Wb(7,"h2",8),R.Tc(8),R.nc(9,"translate"),R.Vb(),R.Wb(10,"button",9),R.ic("click",(function(e){return R.Ic(t),R.mc().openBanksDictionary()})),R.Tc(11),R.nc(12,"translate"),R.Vb(),R.Vb(),R.Wb(13,"div",10),R.Wb(14,"j-form-field",null,11),R.Rc(16,Is,3,3,"j-label",1),R.Wb(17,"j-select",12,13),R.nc(19,"async"),R.Rc(20,ks,9,6,"ng-template",14),R.Rc(21,Os,9,6,"ng-template",15),R.Vb(),R.Vb(),R.Vb(),R.Rc(22,js,8,9,"div",16),R.Vb(),R.Vb(),R.Wb(23,"div",6),R.Wb(24,"fieldset"),R.Wb(25,"legend",17),R.Tc(26),R.nc(27,"translate"),R.Vb(),R.Wb(28,"div",10),R.Wb(29,"j-form-field"),R.Wb(30,"j-label"),R.Tc(31),R.nc(32,"translate"),R.Vb(),R.Rb(33,"input",18),R.Vb(),R.Vb(),R.Wb(34,"div",10),R.Rb(35,"j-date-picker",19,20),R.nc(37,"async"),R.nc(38,"translate"),R.nc(39,"translate"),R.nc(40,"async"),R.Vb(),R.Wb(41,"div",10),R.Wb(42,"j-form-field",null,21),R.Wb(44,"j-label"),R.Tc(45),R.nc(46,"translate"),R.Vb(),R.Wb(47,"j-select",22,23),R.nc(49,"async"),R.Rc(50,Ws,2,1,"ng-template",14),R.Vb(),R.Vb(),R.Vb(),R.Wb(51,"div",24),R.Wb(52,"span",25),R.Tc(53),R.nc(54,"async"),R.Vb(),R.Wb(55,"j-form-field"),R.Wb(56,"j-label"),R.Tc(57),R.nc(58,"translate"),R.Vb(),R.Rb(59,"textarea",26,27),R.Rb(61,"j-error",28),R.Rc(62,Ms,3,1,"div",29),R.nc(63,"async"),R.Vb(),R.Vb(),R.Wb(64,"div",10),R.Wb(65,"j-account-dropdown",30,31),R.ic("selected",(function(e){return R.Ic(t),R.mc().onSenderAccountSelect(e)})),R.nc(67,"async"),R.nc(68,"async"),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Wb(69,"div",6),R.Wb(70,"fieldset"),R.Wb(71,"j-employee-group-control",32),R.Wb(72,"div",33),R.Wb(73,"div",34),R.Wb(74,"div",35),R.Rb(75,"input",36),R.Wb(76,"label",37),R.Tc(77),R.nc(78,"translate"),R.Vb(),R.Vb(),R.Vb(),R.Wb(79,"div",34),R.Wb(80,"div",35),R.Rb(81,"input",38),R.Wb(82,"label",39),R.Tc(83),R.nc(84,"translate"),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Rb(85,"j-error",28),R.Vb(),R.Vb(),R.Vb(),R.Wb(86,"div",40),R.Wb(87,"div",10),R.Wb(88,"fieldset"),R.Wb(89,"ul",41),R.Wb(90,"li",42),R.Wb(91,"h5",43),R.Tc(92),R.nc(93,"translate"),R.Wb(94,"span",44),R.Wb(95,"strong"),R.Tc(96),R.nc(97,"amountFormat"),R.nc(98,"async"),R.Vb(),R.Tc(99," \u20b8"),R.Vb(),R.Vb(),R.Rc(100,Ps,3,3,"div",45),R.nc(101,"async"),R.Wb(102,"p",46),R.Rc(103,xs,3,3,"ng-container",47),R.nc(104,"async"),R.Rc(105,_s,4,8,"ng-template",null,48,R.Sc),R.Vb(),R.Vb(),R.Wb(107,"li",49),R.Rb(108,"j-switch",50),R.Wb(109,"span",51),R.Tc(110),R.nc(111,"translate"),R.Rb(112,"br"),R.Wb(113,"small",52),R.Tc(114),R.nc(115,"translate"),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Vb(),R.Wb(116,"div",53),R.Rc(117,Ds,2,3,"p",54),R.nc(118,"async"),R.Wb(119,"div",53),R.Rc(120,ws,7,6,"ng-container",1),R.Rc(121,Ys,4,3,"ng-container",1),R.Vb(),R.Vb(),R.Rb(122,"ngx-spinner",55),R.Vb(),R.Vb(),R.Tb()}if(2&t){const t=R.Fc(15),e=R.Fc(18),n=R.Fc(36),o=R.Fc(43),i=R.Fc(48),s=R.Fc(106),c=R.mc();R.Ab(2),R.uc("formGroup",c.form),R.Ab(6),R.Vc(" ",R.oc(9,67,"PAYMENTS.RECIPIENT.TITLE")," "),R.Ab(3),R.Vc(" ",R.oc(12,69,"PAYMENTS.SELECT_FROM_DICTIONARY")," "),R.Ab(5),R.uc("ngIf",!c.form.controls.bankReceiver.value),R.Ab(1),R.uc("searchFn",c.paymentsService.bankReceiverSearchFn)("jFocusOnReturn",e)("appendTo",t.elementRef.nativeElement)("formControl",c.form.controls.bankReceiver)("clearable",!1)("items",R.oc(19,71,c.banks.items$)),R.Ab(5),R.uc("ngIf",c.form.controls.bankAccount.enabled),R.Ab(4),R.Uc(R.oc(27,73,"PAYMENTS.FORM.DETAILS")),R.Ab(5),R.Uc(R.oc(32,75,"PAYMENTS.FORM.DOCUMENT_NUMBER")),R.Ab(2),R.uc("mask",c.masks.number.mask)("formControl",c.form.controls.number),R.Ab(2),R.uc("jFocusOnReturn",n)("datesEnabled",R.oc(37,77,c.workingDays$))("formControl",c.form.controls.date)("formatValue",!0)("label",R.oc(38,79,"PAYMENTS.FORM.VALUE_DATE"))("minDate",c.dateLimit.minDate)("maxDate",c.dateLimit.maxDate)("helperText",R.oc(39,81,R.oc(40,83,c.dateMessage$))),R.Ab(10),R.Uc(R.oc(46,85,"PAYMENTS.FORM.KNP")),R.Ab(2),R.uc("jFocusOnReturn",i)("appendTo",o.elementRef.nativeElement)("formControl",c.form.controls.knp)("clearable",!1)("searchMask",c.masks.knp.mask)("shadow",c.masks.knp.shadow)("items",R.oc(49,87,c.knp$)),R.Ab(6),R.Wc(" ",R.oc(54,89,c.purposeLength$),"/",c.rules.purposeLength,""),R.Ab(4),R.Uc(R.oc(58,91,"PAYMENTS.FORM.PURPOSE")),R.Ab(2),R.uc("formControl",c.form.controls.purpose),R.Ab(2),R.uc("control",c.form.controls.purpose)("errorMessages",c.errors.purpose),R.Ab(1),R.uc("ngIf",R.oc(63,93,c.purposeMessage$)),R.Ab(3),R.uc("isLoading",R.oc(67,95,c.accountStore.fetching$))("label","PAYMENTS.SENDER_ACCOUNT.UNSELECTED")("hasError",c.form.controls.senderAccount.touched&&c.form.controls.senderAccount.errors)("accounts",R.oc(68,97,c.acceptableAccounts$)),R.Ab(6),R.uc("formControl",c.form.controls.employees)("paymentType",c.paymentType)("minAmount",c.employeeMinAmount)("maxAmount",c.employeeMaxAmount)("birthDateRequired",!1)("ibanRequired",!0),R.Ab(4),R.uc("value",!0),R.Ab(2),R.Vc(" ",R.oc(78,99,"PAYMENTS.FORM.EMPLOYEE_RESIDENTS")," "),R.Ab(4),R.uc("value",!1),R.Ab(2),R.Vc(" ",R.oc(84,101,"PAYMENTS.FORM.EMPLOYEE_NON-RESIDENTS")," "),R.Ab(2),R.uc("control",c.form.controls.employees)("errorMessages",c.errors.employees),R.Ab(7),R.Vc("",R.oc(93,103,"PAYMENTS.FORM.TOTAL_AMOUNT"),": "),R.Ab(4),R.Uc(R.oc(97,105,R.oc(98,107,c.total$))),R.Ab(4),R.uc("ngIf",R.oc(101,109,c.amountMessage$)),R.Ab(3),R.uc("ngIf",null===R.oc(104,111,c.commission$))("ngIfElse",s),R.Ab(5),R.uc("formControl",c.form.controls.urgent),R.Ab(2),R.Vc("",R.oc(111,113,"PAYMENTS.FORM.URGENT")," "),R.Ab(4),R.Uc(R.oc(115,115,"PAYMENTS.URGENT_HELPER")),R.Ab(3),R.uc("ngIf",R.oc(118,117,c.controlsStream.isResidents)),R.Ab(3),R.uc("ngIf",c.restoredData.status!==c.PAYMENT_STATUS.CREATED),R.Ab(1),R.uc("ngIf",c.restoredData.status===c.PAYMENT_STATUS.CREATED),R.Ab(1),R.uc("name",c.SPINNER)("fullScreen",!1)}}let Ls=(()=>{class t extends ke{constructor(t,e,n,o,i,s,c,a,r,l,b,u,m,d,p){super(m.createSalaryForm(),r,o,i,e,t,s,a,l,b,u,d,p),this.paymentsService=t,this.companyService=e,this.dateAdapter=n,this.route=o,this.router=i,this.maskService=s,this.accountsService=c,this.modalService=a,this.api=r,this.dictionaries=l,this.pipeline=b,this.translateService=u,this.paymentsFormsFactory=m,this.authorityPermissionsService=d,this.featureFlagsService=p,this.masks={number:"paymentNum",amount:"amount",knp:"knp",bankAccount:"tengeAccount"},this.employeeMinAmount=.01,this.employeeMaxAmount=null,this.paymentType=B.j.SALARY}ngOnInit(){super.ngOnInit(),this.banks=this.dictionaries.bankDictionary,this.dateLimit=this.paymentsService.stdDateRangeNgb,this.accountStore=this.accountsService.store,this.acceptableAccounts$=this.paymentsService.combineAcceptableAccounts(this.accountStore).pipe(Object(F.a)(t=>this.checkPersonalAccounts(t))),this.getMaskConfig(),this.createControlsStream(this.form),this.listenWorkingDays(),this.combineEmployeesAmount(),this.listenCommission(),this.listenTotal(),this.provideAmountMessage(),this.listenDateMessageStream(),this.listenPurposeMessageStream(),this.knp$=this.combineKNP(),this.subs.add(this.controlsStream.bankReceiver.pipe(Object(D.a)(this.banks.entities$),Object(y.a)(([t,e])=>t&&e[t]),Object(P.a)()).subscribe(t=>{const{bankAccount:e}=this.form.controls;!t||t.salaryTransitIban&&e.enabled?(e.disable(),e.patchValue("")):t&&!t.salaryTransitIban&&e.disabled?e.enable():t&&e.updateValueAndValidity()}))}openBanksDictionary(){this.modals.open(gt,{backdropClass:"backdrop_light",windowClass:"modal_light modal_max-height",centered:!0}).result.then(t=>t&&this.form.controls.bankReceiver.patchValue(t.id)).catch(()=>{})}}return t.\u0275fac=function(e){return new(e||t)(R.Qb(C.c),R.Qb(ti.a),R.Qb(c.c),R.Qb(p.a),R.Qb(p.c),R.Qb(Oe.a),R.Qb(l.c),R.Qb(c.q),R.Qb(ni.a),R.Qb(at.a),R.Qb(ei.a),R.Qb(a.e),R.Qb(oi.a),R.Qb(je.c),R.Qb(q.b))},t.\u0275cmp=R.Kb({type:t,selectors:[["j-salary-payment"]],features:[R.xb],decls:2,vars:2,consts:[["label","PAYMENTS.RESTRICTED_PLACEHOLDER",3,"isRetryable","isLoading","retried",4,"ngIf"],[4,"ngIf"],["label","PAYMENTS.RESTRICTED_PLACEHOLDER",3,"isRetryable","isLoading","retried"],[1,"payment-section"],["jInvalidControlScroll","","autocomplete","off","jFocusableContainer","",3,"formGroup","submit"],["formDirective","ngForm"],[1,"form-section"],[1,"payments__header"],[1,"h2","mb-0"],["type","button",1,"btn","btn-link","p-0","p3",3,"click"],[1,"form-group"],["receiverWrapper",""],["bindValue","id",3,"searchFn","jFocusOnReturn","appendTo","formControl","clearable","items"],["receiverSelect",""],["j-label-tmp",""],["j-option-tmp",""],["class","form-group",4,"ngIf"],[1,"h2"],["jFocusOnReturn","","type","text","jFormInput","",1,"form-control",3,"mask","formControl"],["allowAuto","true",3,"jFocusOnReturn","datesEnabled","formControl","formatValue","label","minDate","maxDate","helperText"],["datepicker",""],["knpWrapper",""],["bindValue","code",3,"jFocusOnReturn","appendTo","formControl","clearable","searchMask","shadow","items"],["select",""],[1,"form-group","position-relative"],[1,"payment-section--purpose-length","p3","text-gray"],["jFocusOnReturn","","jFormInput","","rows","5",1,"form-control",3,"formControl"],["purpose",""],[3,"control","errorMessages"],["jBottomLine","","class","j-form-field-bottom",4,"ngIf"],[3,"isLoading","label","hasError","accounts","selected"],["senderAccountDropdown",""],[3,"formControl","paymentType","minAmount","maxAmount","birthDateRequired","ibanRequired"],["ngProjectAs","[header]",5,["","header",""],1,"row"],[1,"form-group","col"],[1,"custom-control","custom-radio"],["type","radio","id","residents","name","isResidents","formControlName","isResidents",1,"custom-control-input",3,"value"],["for","residents",1,"custom-control-label","text-muted","p3"],["type","radio","id","nonResident","name","isResidents","formControlName","isResidents",1,"custom-control-input",3,"value"],["for","nonResident",1,"custom-control-label","text-muted","p3"],[1,"payment-section--summary","form-section"],[1,"list-group"],[1,"list-group-item"],[1,"light","m-0"],[1,"h3"],["class","payment-section--amount-warn mt-1 p2",4,"ngIf"],[1,"p3","text","text-gray","d-inline-block","m-0"],[4,"ngIf","ngIfElse"],["commission",""],[1,"list-group-item","d-flex","align-items-center"],[3,"formControl"],[1,"ml-3"],[1,"text-gray"],[1,"payment-section--submit","form-group","pt-4"],["class","p3 text-gray text-right",3,"innerHTML",4,"ngIf"],["type","ball-scale-ripple-multiple","size","large","color","#d6dadf","zIndex","3","bdColor","rgba(246, 247, 248, 0.3)",3,"name","fullScreen"],[1,"account-pill","pl-0","pr-0"],[1,"account-pill--logo"],[3,"name"],[1,"account-pill--content","small"],[1,"wrap-text"],[1,"wrap-text","text-gray"],[1,"account-pill","account-pill_gray","account-pill_fill"],["clearable","true"],["type","text","jFormInput","","jReplaceOnPaste","KZ","jDynamicPrefix","KZ","jFocusOnReturn","","jUppercase","",1,"form-control",3,"jShadow","dropSpecialCharacters","mask","formControl"],["accountInput","jFormInput"],[1,"text-truncate"],["jBottomLine","",1,"j-form-field-bottom"],[1,"text-truncate","small"],[1,"payment-section--amount-warn","mt-1","p2"],[3,"innerHTML"],[1,"p3","text-gray","text-right",3,"innerHTML"],["type","button",1,"btn","btn-outline-primary","btn-static",3,"click"],["type","submit",1,"btn","btn-primary","btn-static","ml-3"],["type","submit",1,"btn","btn-outline-primary","btn-static"]],template:function(t,e){1&t&&(R.Rc(0,Ns,1,2,"j-restricted-placeholder",0),R.Rc(1,Us,123,119,"ng-container",1)),2&t&&(R.uc("ngIf",e.isRestricted),R.Ab(1),R.uc("ngIf",!e.isRestricted))},directives:[o.u,xe.a,i.J,i.u,_e.b,Nt.b,i.l,z.a,Ye.a,Nt.a,i.t,i.i,Ue.d,Ue.j,Vt.a,tt.a,i.c,s.a,Fe.a,Ot.a,De.a,Zi.a,i.B,i.j,we.a,Ke.a,et.a,Ko.a,Fo.a,Le.a,Qe.a,Ge.a],pipes:[a.d,o.b,si.a],styles:[".payments__header[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;-webkit-box-pack:justify;justify-content:space-between;margin-bottom:1.5rem}"]}),t})();const Fs=[{path:h.c.root,component:Uo,children:[{path:"",canActivate:[A.a]},{path:h.b.root,component:ji,data:{animation:"slideOrFade",index:2},children:[{path:h.b.tax,matcher:Object(f.factoryUserPageMatcher)(h.b.tax,"paymentId"),component:ki,canDeactivate:[g.a],data:{animation:"slideOrFade",index:21}},{path:h.b.pension,matcher:Object(f.factoryUserPageMatcher)(h.b.pension,"paymentId"),component:rs,canDeactivate:[g.a],data:{animation:"slideOrFade",index:22}},{path:h.b.social,matcher:Object(f.factoryUserPageMatcher)(h.b.social,"paymentId"),component:gs,canDeactivate:[g.a],data:{animation:"slideOrFade",index:23}},{path:h.b.osms,matcher:Object(f.factoryUserPageMatcher)(h.b.osms,"paymentId"),component:Vs,canDeactivate:[g.a],data:{animation:"slideOrFade",index:24}},{path:"**",redirectTo:h.b.tax}]},{path:h.c.order,matcher:Object(f.factoryUserPageMatcher)(h.c.order,"paymentId"),component:Ji,canDeactivate:[g.a],data:{animation:"slideOrFade",index:1}},{path:h.c.salary,matcher:Object(f.factoryUserPageMatcher)(h.c.salary,"paymentId"),component:Ls,canDeactivate:[g.a],data:{animation:"slideOrFade",index:3}},{path:":paymentId",canActivate:[A.a]},{path:"**",redirectTo:h.c.order}]},{path:h.a.foreignCurrency,canDeactivate:[g.a],matcher:Object(f.factoryUserPageMatcher)(h.a.foreignCurrency,"paymentId"),component:Mo},{path:"**",redirectTo:h.c.root}];let $s=(()=>{class t{}return t.\u0275mod=R.Ob({type:t}),t.\u0275inj=R.Nb({factory:function(e){return new(e||t)},imports:[[p.g.forChild(Fs)],p.g]}),t})();var Bs=n("pZP7"),Ks=n("UZjs"),Hs=n("JvPu"),Qs=n("wwEr"),Gs=n("3v+J"),qs=n("Y+uv"),Xs=n("/zfT"),zs=n("xWtO"),Js=n("i2Gl"),Zs=n("Frqi"),tc=n("paXB"),ec=n("EiG8"),nc=n("c66K"),oc=n("VA2L"),ic=n("0AMz"),sc=n("W3Es"),cc=n("R4CF"),ac=n("9txL"),rc=n("5I09"),lc=n("Tile"),bc=n("aF9I"),uc=n("aZ8m"),mc=n("UhoJ"),dc=n("sCra"),pc=n("fGuG"),hc=n("7/bn"),fc=n("2FF4"),gc=n("bSvt"),Ac=n("jH+I"),Tc=n("kUBv"),yc=n("9Udv"),Rc=n("0jn5"),vc=n("gdaf"),Cc=n("LFY/"),Ec=n("I+WJ"),Sc=n("lABO"),Vc=n("hJI6"),Nc=n("JB36"),Ic=n("4zJ+"),kc=n("XpgD"),Oc=n("MfWJ"),jc=n("B8HE"),Wc=n("5DAB"),Mc=n("DHTX"),Pc=n("6goL"),xc=n("BAfr"),_c=n("ajRT"),Dc=n("NpBu"),wc=n("TaxS"),Yc=n("tkTF"),Uc=n("yy4r"),Lc=n("ZVDf"),Fc=n("l/gM"),$c=n("gN/K"),Bc=n("+hcb"),Kc=n("h7tf"),Hc=n("9odQ"),Qc=n("WqMH"),Gc=n("3MRA"),qc=n("y6vz"),Xc=n("Zgqj"),zc=n("oMXN"),Jc=n("rqas"),Zc=n("dnqU"),ta=n("tp+K"),ea=n("saU0"),na=n("ZF3e"),oa=n("qew9"),ia=n("d/d6"),sa=n("Dvla"),ca=n("K1R0"),aa=n("dlKe"),ra=n("DPnb"),la=n("C6g9"),ba=n("3M96"),ua=n("Q+Qo"),ma=n("i/as"),da=n("8Sq6"),pa=n("w657"),ha=n("DHcY"),fa=n("adOO"),ga=n("Ub7F"),Aa=n("OHc7"),Ta=n("Bs9s"),ya=n("ScFe"),Ra=n("wY9W"),va=n("7Fmj"),Ca=n("g1SY"),Ea=n("3skF");n.d(e,"PaymentsModule",(function(){return Sa}));let Sa=(()=>{class t{}return t.\u0275mod=R.Ob({type:t}),t.\u0275inj=R.Nb({factory:function(e){return new(e||t)},providers:[d.a],imports:[[o.c,i.n,i.D,s.c,c.g,c.D,c.H,c.y,r.b,a.c,l.b,u.a,m.a,$s,b.ContractsModule],c.r,c.D]}),t})();R.Lc(pt.a,[Mo,jo,Uo,ki,ji,Ji,rs,gs,Vs,Ls,bt,dt,pt.a,gt,yt,Rt.a,ge,ct,Lt,vt,Ct,te,le,fe,se,be.b,me,Ae.a,o.r,o.s,o.t,o.u,o.B,o.x,o.y,o.z,o.A,o.v,o.w,i.J,i.y,i.I,i.c,i.z,i.C,i.a,i.F,i.G,i.B,i.t,i.u,i.E,i.p,i.o,i.A,i.b,i.d,i.w,i.x,i.v,i.i,i.l,i.j,i.m,i.f,s.a,c.d,c.e,c.p,c.h,c.C,c.G,c.o,c.u,c.v,c.w,c.x,c.z,c.A,c.B,r.a,a.a,De.a,Bs.a,Ks.a,Hs.a,Qs.a,Gs.a,qs.a,Xs.a,zs.a,Nt.b,$e.a,Ko.a,Be.a,$o.a,Bo.a,Le.a,Nt.a,Qe.a,_e.b,_e.a,Fo.a,Ho.a,Xo.a,Zo.a,Qo.a,Go.a,qo.a,zo.a,Jo.a,Js.b,J.a,Zs.a,He.a,tc.a,Fe.a,ec.a,z.a,nc.a,Vt.a,Z.a,It.a,Ge.a,Ot.a,tt.a,oc.a,ic.a,sc.a,cc.a,ac.a,Zi.a,rc.a,E.a,S.a,V.a,lc.a,bc.a,uc.a,mc.a,dc.a,pc.a,hc.a,we.a,et.a,Ft.a,fc.a,gc.a,Ac.a,jt.a,Tc.a,yc.a,Rc.a,$t.a,Kt.a,Bt.a,qe.a,vc.a,Cc.a,Ec.a,Sc.a,Vc.a,Nc.a,Ic.a,kc.a,Oc.a,jc.a,Wc.b,Mc.a,Pc.a,xe.a,xc.a,_c.a,Dc.a,wc.a,Yc.a,Uc.a,ii.a,Lc.a,Fc.a,ee.a,$c.a,Bc.a,Kc.a,Hc.b,Qc.a,Gc.a,qc.a,Xc.a,zc.a,Jc.a,Zc.a,ta.a,ea.a,na.a,Ke.a,oa.a,ia.a,kt.a,c.E,sa.a,sa.b,ca.a,aa.a,ra.a,ra.c,ra.b,la.a,ba.a,Ye.a,ua.a,Ue.i,Ue.j,Ue.d,Ue.g,Ue.b,Ue.a,Ue.h,Ue.l,Ue.f,Ue.k,Ue.e,p.h,p.d,p.f,p.e,p.i,ma.a,da.a,pa.a],[o.b,o.I,o.q,o.l,o.F,o.g,o.D,o.G,o.d,o.f,o.j,o.k,o.m,s.b,a.d,ha.a,fa.a,nt.a,ga.a,Aa.a,si.a,oe.a,Ta.a,ya.a,ne.a,Xe.a,Ra.a,va.a,Ca.a,Ea.a])}}]);