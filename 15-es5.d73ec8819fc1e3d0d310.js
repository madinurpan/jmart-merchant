function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{Yj9t:function(e,t,n){"use strict";n.r(t);var i,r=n("ofXK"),a=n("tyNb"),o=n("3Pt+"),s=n("tmjD"),c=n("PCNd"),u=n("mrSG"),h=n("quSY"),l=n("lJxs"),b=n("p6Hd"),d=n("fXoL"),p=n("qXBG"),m=n("7foZ"),v=n("VO+5"),f=n("7/bn"),g=n("ZF+8"),T=n("iQ9M"),R=n("mR7B"),E=n("VnnJ"),k=n("sYmb"),y=n("3MRA"),S=n("ZVDf"),C=n("yy4r"),A=n("M6pS"),I=n("zdqJ"),O=["phoneInput"],w=["passwordInput"],L=["registerButton"],N=((i=function(){function e(t,n,i,r,a,s,c){var u=this;_classCallCheck(this,e),this.maskedService=t,this.maskPipe=n,this.tourService=i,this.route=r,this.companyService=a,this.translateService=s,this.dictionariesService=c,this.isSubmitted=!1,this.isPhoneSubmitted=!1,this.PHONE=localStorage.getItem("phone")?localStorage.getItem("phone"):"",this.PASSWORD="",this.passwordRegExp=/[^ ]/,this.passwordPasteRegExp=/[ ]/,this.countryCode={code:"+7",country:this.translateService.instant("COUNTRIES.".concat(T.b.KAZAKHSTAN)),id:T.b.KAZAKHSTAN,countryCode:T.c.KAZAKHSTAN},this.submitted=new d.n,this.subscription=new h.a,this.isFromAtf=!1,this.isTourShown=JSON.parse(localStorage.getItem("isLoginStepShown"))||!1;var l=this.route.queryParams.subscribe((function(e){u.queryParams=e,u.isFromAtf=u.companyService.isFromAtf(e),u.startLoginTour()}));this.loginForm=new o.k({prefix:new o.h(this.countryCode.code,o.H.required),phone:new o.h(this.PHONE,o.H.required),password:new o.h(this.PASSWORD,o.H.required)});var b=this.loginForm.valueChanges.subscribe((function(){u.isSubmitted=!1,u.isPhoneSubmitted=!1}));this.subscription.add(l),this.subscription.add(b)}return _createClass(e,[{key:"ngOnInit",value:function(){this.fetchCountryCodes()}},{key:"fetchCountryCodes",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.dictionariesService.fetchCountryCodesDictionary().then((function(e){t.countryCodes=e.map((function(e){return{id:e.id,code:e.value.description,country:e.value.name,countryCode:e.value.code}}))}));case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:case"end":return e.stop()}}),e,this,[[0,5]])})))}},{key:"triggerErrorAnimation",value:function(){this.passwordInput.triggerHelperAnimation()}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"ngAfterViewInit",value:function(){this.loginForm.controls.phone.valid?this.passwordInput.focus():this.phoneInput.focus(),this.startLoginTour()}},{key:"ngOnChanges",value:function(e){var t;(null===(t=e.passwordError)||void 0===t?void 0:t.currentValue)&&(this.passwordError=e.passwordError.currentValue)}},{key:"onTabPress",value:function(e){e.preventDefault(),this.isPhoneSubmitted=!0,this.f.phone.valid&&this.passwordInput.focus()}},{key:"onSubmit",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isSubmitted=!0,!this.loginForm.invalid){e.next=2;break}return e.abrupt("return",void(this.loginForm.controls.phone.errors?this.loginError="ERRORS.NOT_ENOUGH_SYMBOLS":this.loginForm.controls.password.errors&&(this.passwordError="ERRORS.ENTER_PASSWORD")));case 2:t=this.maskedService.getUnmaskedPhone(this.f.phone.value),this.submitted.emit({phone:t,password:this.f.password.value,countryCode:this.countryCode});case 4:case"end":return e.stop()}}),e,this)})))}},{key:"startLoginTour",value:function(){var e=this;this.isTourShown||(this.isTourShown=!0,localStorage.setItem("isLoginStepShown",JSON.stringify(!0)),setTimeout((function(){e.tourService.startTour(g.e.AUTH,{skipAuthorization:!0})}),0))}},{key:"onCountrySelected",value:function(e){this.countryCode=e}},{key:"f",get:function(){return this.loginForm.controls}}]),e}()).\u0275fac=function(e){return new(e||i)(d.Qb(R.a),d.Qb(s.b),d.Qb(g.g),d.Qb(a.a),d.Qb(E.a),d.Qb(k.e),d.Qb(g.a))},i.\u0275cmp=d.Kb({type:i,selectors:[["j-login-phone"]],viewQuery:function(e,t){var n;1&e&&(d.Yc(O,!0),d.Yc(w,!0),d.Yc(L,!0)),2&e&&(d.Ec(n=d.jc())&&(t.phoneInput=n.first),d.Ec(n=d.jc())&&(t.passwordInput=n.first),d.Ec(n=d.jc())&&(t.registerButton=n.first))},inputs:{isLoading:"isLoading",phone:"phone",passwordError:"passwordError",loginError:"loginError",prefix:"prefix"},outputs:{submitted:"submitted"},features:[d.yb()],decls:21,vars:22,consts:[["translate","",1,"light","mb-3","mt-0"],["autocomplete","off",3,"formGroup","ngSubmit"],[1,"phone-input"],["formControlName","prefix",3,"countryCode","countryCodes","countrySelected","keydown.Tab"],["phonePrefixInput",""],[3,"formControl","hasError","errorText","countryCode","countryCodes","countrySelected","keydown.Tab"],["phoneInput",""],[3,"regexStr","pasteRegexStr","hasCapsLockCheck","hasCyrillicCheck","isAuth","formControl","hasError","errorText"],["passwordInput",""],[1,"auth-submit"],[1,"auth-submit__button"],["translate","","type","submit","routerLink","/jmart/products/main",1,"btn","btn-static","btn-primary","btn-lg",3,"jLoading","disabled"],["translate","","routerLink","/auth/register","queryParamsHandling","merge","jTour","AUTH.REGISTER","jTourPosition","right",1,"btn","btn-static","btn-link",3,"disabled"]],template:function(e,t){1&e&&(d.Wb(0,"article"),d.Wb(1,"h3",0),d.Tc(2,"AUTH.LOGIN_TITLE"),d.Vb(),d.Wb(3,"p"),d.Tc(4),d.nc(5,"translate"),d.Vb(),d.Vb(),d.Wb(6,"form",1),d.ic("ngSubmit",(function(e){return t.onSubmit()})),d.Wb(7,"div",2),d.Wb(8,"j-phone-prefix-input",3,4),d.ic("countrySelected",(function(e){return t.onCountrySelected(e)}))("keydown.Tab",(function(e){return t.onTabPress(e)})),d.Vb(),d.Wb(10,"j-phone-input",5,6),d.ic("countrySelected",(function(e){return t.onCountrySelected(e)}))("keydown.Tab",(function(e){return t.onTabPress(e)})),d.Vb(),d.Vb(),d.Rb(12,"j-password-input",7,8),d.Vb(),d.Wb(14,"div",9),d.Wb(15,"div",10),d.Wb(16,"button",11),d.Tc(17,"AUTH.LOGIN"),d.Vb(),d.Vb(),d.Wb(18,"div",10),d.Wb(19,"button",12),d.Tc(20,"AUTH.REGISTER"),d.Vb(),d.Vb(),d.Vb()),2&e&&(d.Ab(4),d.Uc(d.oc(5,20,t.isFromAtf?"AUTH.LOGIN_SUBTITLE_ATF":"AUTH.LOGIN_SUBTITLE")),d.Ab(2),d.uc("formGroup",t.loginForm),d.Ab(2),d.uc("countryCode",t.countryCode)("countryCodes",t.countryCodes),d.Ab(2),d.uc("formControl",t.f.phone)("hasError",t.loginError||t.f.phone.errors&&(t.isSubmitted||t.isPhoneSubmitted))("errorText",t.loginError)("countryCode",t.countryCode)("countryCodes",t.countryCodes),d.Ab(2),d.uc("regexStr",t.passwordRegExp)("pasteRegexStr",t.passwordPasteRegExp)("hasCapsLockCheck",!0)("hasCyrillicCheck",!0)("isAuth",!t.isLoading)("formControl",t.f.password)("hasError",t.passwordError||t.isSubmitted&&t.f.password.errors)("errorText",t.passwordError),d.Ab(4),d.uc("jLoading",t.isLoading)("disabled",t.isLoading),d.Ab(3),d.uc("disabled",t.isLoading))},directives:[k.a,o.J,o.u,o.l,y.a,o.t,o.j,S.a,o.i,C.a,a.d,A.a,I.a],pipes:[k.d],styles:[".phone-input[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row}j-phone-input[_ngcontent-%COMP%]{width:-moz-available;width:-webkit-fill-available;width:stretch}"]}),i),V=n("sCra"),_=n("fGuG"),D=n("yZrb"),P=n("TwVa"),j=n("1ua0"),W=n("Kcpt"),x=n("2FF4"),H=n("0jn5"),U=n("4zJ+");function M(e,t){if(1&e){var n=d.Xb();d.Wb(0,"a",4),d.ic("click",(function(e){return d.Ic(n),d.mc().navigateToPhone(e)})),d.Rb(1,"j-icon",5),d.Wb(2,"strong",6),d.Tc(3,"SHARED.BACK"),d.Vb(),d.Vb()}2&e&&(d.Ab(1),d.uc("isStroke",!0))}function F(e,t){if(1&e){var n=d.Xb();d.Wb(0,"j-sms",7),d.ic("loaded",(function(e){return d.Ic(n),d.mc().onSmsLoaded()}))("otpAuthRequested",(function(e){return d.Ic(n),d.mc().changeCodeRequestMethod(e)}))("submitted",(function(e){return d.Ic(n),d.mc().onSubmit(e)})),d.Vb()}if(2&e){var i=d.mc();d.uc("phone",i.phone)("countryCode",i.countryCode)("headers",i.headerParams)("isAuthAction",!0)}}function K(e,t){if(1&e){var n=d.Xb();d.Wb(0,"j-otp",8),d.ic("loaded",(function(e){return d.Ic(n),d.mc().onSmsLoaded()}))("smsAuthRequested",(function(e){return d.Ic(n),d.mc().changeCodeRequestMethod(e)}))("submitted",(function(e){return d.Ic(n),d.mc().onSubmit(e)})),d.Vb()}if(2&e){var i=d.mc();d.uc("phone",i.phone)("isAuthAction",!0)}}function G(e,t){1&e&&(d.Wb(0,"div",9),d.Rb(1,"j-animated-loading"),d.Vb())}var Q,B=((Q=function(){function e(){_classCallCheck(this,e),this.isReady=!1,this.preferredSignatureType=localStorage.getItem("preferredSignatureType"),this.tokenType=P.q,this.submitted=new d.n,this.closed=new d.n,this.headerParams={smsHeader:D.c.AUTHORIZATION},this.preferredSignatureType=localStorage.getItem("preferredSignatureType")||j.a.SMS}return _createClass(e,[{key:"onSmsLoaded",value:function(){this.isReady=!0}},{key:"onSubmit",value:function(e){this.submitted.emit(e)}},{key:"navigateToPhone",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null===(e=t)||void 0===e||e.preventDefault(),this.closed.emit()}},{key:"changeCodeRequestMethod",value:function(e){localStorage.setItem("preferredSignatureType",e===P.q.OTP?j.a.OTP:j.a.SMS),this.preferredSignatureType=e}}]),e}()).\u0275fac=function(e){return new(e||Q)},Q.\u0275cmp=d.Kb({type:Q,selectors:[["j-login-sms"]],inputs:{isLoading:"isLoading",phone:"phone",countryCode:"countryCode"},outputs:{submitted:"submitted",closed:"closed"},decls:4,vars:4,consts:[["href","#","class","j-link",3,"click",4,"ngIf"],[3,"phone","countryCode","headers","isAuthAction","loaded","otpAuthRequested","submitted",4,"ngIf"],[3,"phone","isAuthAction","loaded","smsAuthRequested","submitted",4,"ngIf"],["class","spinner-wrap",4,"ngIf"],["href","#",1,"j-link",3,"click"],["name","arrowLeft","color","primary",1,"mr-2",3,"isStroke"],["translate",""],[3,"phone","countryCode","headers","isAuthAction","loaded","otpAuthRequested","submitted"],[3,"phone","isAuthAction","loaded","smsAuthRequested","submitted"],[1,"spinner-wrap"]],template:function(e,t){1&e&&(d.Rc(0,M,4,1,"a",0),d.Rc(1,F,1,4,"j-sms",1),d.Rc(2,K,1,2,"j-otp",2),d.Rc(3,G,2,0,"div",3)),2&e&&(d.uc("ngIf",t.isReady),d.Ab(1),d.uc("ngIf","SMS"===t.preferredSignatureType),d.Ab(1),d.uc("ngIf","OTP"===t.preferredSignatureType),d.Ab(1),d.uc("ngIf",!t.isReady&&t.preferredSignatureType!==t.tokenType.OTP))},directives:[r.u,W.a,k.a,x.a,H.a,U.a],styles:[".spinner-wrap[_ngcontent-%COMP%]{min-height:280px;position:relative}"]}),Q),q=["loginPhone"];function X(e,t){if(1&e){var n=d.Xb();d.Wb(0,"j-login-sms",11),d.ic("closed",(function(e){return d.Ic(n),d.mc().onSmsClose()}))("submitted",(function(e){return d.Ic(n),d.mc().onSmsSubmit(e)})),d.Vb()}if(2&e){var i=d.mc();d.uc("phone",i.phone)("countryCode",i.countryCode)("isLoading",i.isLoading)}}function J(e,t){1&e&&(d.Wb(0,"div",12),d.Rb(1,"j-animated-loading"),d.Vb())}var Z,Y,z,$,ee,te,ne,ie=function(e){return e.PHONE="phone",e.SMS="sms",e.LOADING="loading",e}({}),re=((Z=function(){function e(t,n,i,r,a){var o=this;_classCallCheck(this,e),this.auth=t,this.tokenService=n,this.route=i,this.router=r,this.notifierService=a,this.isLoading=!1,this.steps=ie,this.currentStep=this.steps.PHONE,this.phoneError="",this.subscription=new h.a,this.subscription.add(this.route.paramMap.pipe(Object(l.a)((function(){return window.history.state}))).subscribe((function(e){e.phone&&(o.phone=e.phone),e.error&&(o.phoneError=e.error)})))}return _createClass(e,[{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"onSmsClose",value:function(){this.navigateToPhone(),this.phoneError=""}},{key:"onPhoneSubmit",value:function(e){this.loginForm=e,this.phone="+"+this.loginForm.phone,this.countryCode=this.loginForm.countryCode;try{var t=this.tokenService.getDeviceToken(this.loginForm.password);localStorage.setItem("countryCode",JSON.stringify(this.countryCode)),t?this.login():this.navigateToSms()}catch(n){this.navigateToSms()}}},{key:"onSmsSubmit",value:function(e){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.auth.setSmsToken(e),this.currentStep=this.steps.LOADING,t.prev=1,t.next=4,this.auth.requestDevice(this.phone,e.type);case 4:n=t.sent,this.tokenService.setDeviceToken(n.signature,this.loginForm.password),this.login(),t.next=18;break;case 8:t.prev=8,t.t0=t.catch(1),t.t1=(this.navigateToPhone(),t.t0.code),t.next=t.t1===b.b.DEVICE_TOKEN_INVALID?13:t.t1===b.b.RESOURCE_NOT_FOUND?13:t.t1===b.b.AUTHORIZATION_ERROR?13:t.t1===b.b.INVALID_GRANT?13:t.t1===b.b.USER_BLOCKED?15:t.t1===b.b.RESOURCE_BLOCKED?15:17;break;case 13:return this.phoneError="ERRORS.WRONG_CREDENTIALS",t.abrupt("break",18);case 15:return this.phoneError="ERRORS.ACCOUNT_BLOCKED",t.abrupt("break",18);case 17:this.phoneError=t.t0.description;case 18:case"end":return t.stop()}}),t,this,[[1,8]])})))}},{key:"login",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isLoading=!0,this.phoneError="",e.prev=1,e.next=4,this.auth.login("+"+this.loginForm.phone,this.loginForm.password);case 4:this.router.navigateByUrl("/"),this.notifierService.hideAll(),e.next=25;break;case 8:if(e.prev=8,e.t0=e.catch(1),this.navigateToPhone(),!e.t0.status){e.next=23;break}e.t1=e.t0.code,e.next=e.t1===b.b.RESOURCE_NOT_FOUND?14:e.t1===b.b.AUTHORIZATION_ERROR?14:e.t1===b.b.INVALID_GRANT?14:e.t1===b.b.RESOURCE_BLOCKED?16:e.t1===b.b.DEVICE_NOT_AUTHORIZED?18:e.t1===b.b.DEVICE_TOKEN_INVALID?18:e.t1===b.b.TOKEN_EXPIRED?18:20;break;case 14:return this.phoneError="ERRORS.WRONG_CREDENTIALS",e.abrupt("break",21);case 16:return this.tokenService.clearDeviceToken(),this.phoneError="ERRORS.ACCOUNT_BLOCKED",e.abrupt("break",21);case 18:return this.navigateToSms(),e.abrupt("break",21);case 20:this.phoneError=e.t0.description;case 21:e.next=24;break;case 23:this.phoneError="ERRORS.API_UNAVAILABLE";case 24:this.loginPhone.triggerErrorAnimation(),this.isLoading=!1;case 25:case"end":return e.stop()}}),e,this,[[1,8]])})))}},{key:"navigateToSms",value:function(){this.currentStep=ie.SMS}},{key:"navigateToPhone",value:function(){this.currentStep=ie.PHONE}}]),e}()).\u0275fac=function(e){return new(e||Z)(d.Qb(p.a),d.Qb(m.a),d.Qb(a.a),d.Qb(a.c),d.Qb(v.c))},Z.\u0275cmp=d.Kb({type:Z,selectors:[["j-login"]],viewQuery:function(e,t){var n;1&e&&d.Yc(q,!0),2&e&&d.Ec(n=d.jc())&&(t.loginPhone=n.first)},decls:13,vars:7,consts:[[1,"auth-wrap"],[1,"d-sm-none",3,"isUserShown"],[1,"login-wrap"],[1,"login"],[1,"mb-5","d-none","d-sm-flex","justify-content-between"],["width","170px","src","/assets/img/logo.svg","alt","Jusan bank"],[1,"login-steps"],[3,"hidden","phone","isLoading","passwordError","submitted"],["loginPhone",""],[3,"phone","countryCode","isLoading","closed","submitted",4,"ngIf"],["class","spinner-wrap",4,"ngIf"],[3,"phone","countryCode","isLoading","closed","submitted"],[1,"spinner-wrap"]],template:function(e,t){1&e&&(d.Wb(0,"section",0),d.Rb(1,"j-aside",1),d.Wb(2,"div",2),d.Wb(3,"div",3),d.Wb(4,"div",4),d.Rb(5,"img",5),d.Vb(),d.Wb(6,"section",6),d.Wb(7,"j-login-phone",7,8),d.ic("submitted",(function(e){return t.onPhoneSubmit(e)})),d.Vb(),d.Rc(9,X,1,3,"j-login-sms",9),d.Rc(10,J,2,0,"div",10),d.Vb(),d.Vb(),d.Vb(),d.Rb(11,"j-lang-list"),d.Rb(12,"j-copyright"),d.Vb()),2&e&&(d.Ab(1),d.uc("isUserShown",!1),d.Ab(6),d.uc("hidden",t.currentStep!=t.steps.PHONE)("phone",t.phone)("isLoading",t.isLoading)("passwordError",t.phoneError),d.Ab(2),d.uc("ngIf",t.currentStep==t.steps.SMS),d.Ab(1),d.uc("ngIf",t.currentStep==t.steps.LOADING))},directives:[f.a,N,r.u,V.a,_.a,B,U.a],styles:[".login[_ngcontent-%COMP%]{background:#f6f7f8;width:100%;padding:1rem}@media(min-width:670px){.login[_ngcontent-%COMP%]{border-radius:2.5rem;padding:3.5rem}}.login-wrap[_ngcontent-%COMP%]{max-width:546px;margin:auto;width:100%;padding-top:1.5rem;padding-bottom:1.5rem}@media(min-width:1920px){.login-wrap[_ngcontent-%COMP%]{max-width:600px}}.spinner-wrap[_ngcontent-%COMP%]{min-height:280px;position:relative}"]}),Z),ae=n("paXB"),oe=n("Zgqj"),se=n("EiG8"),ce=((Y=function e(){_classCallCheck(this,e)}).\u0275fac=function(e){return new(e||Y)},Y.\u0275cmp=d.Kb({type:Y,selectors:[["j-register"]],decls:8,vars:2,consts:[[3,"isUserShown"],[3,"isCentered"],[1,"row"],[1,"col-sm-10","col-md-7","offset-sm-1","col-lg-5","offset-lg-1","col-xl-4","offset-xl-1"],[1,"auth-form"]],template:function(e,t){1&e&&(d.Wb(0,"j-layout-home"),d.Wb(1,"j-aside",0),d.Rb(2,"j-nav-auth"),d.Vb(),d.Wb(3,"j-main",1),d.Wb(4,"div",2),d.Wb(5,"div",3),d.Wb(6,"div",4),d.Rb(7,"router-outlet"),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Vb()),2&e&&(d.Ab(1),d.uc("isUserShown",!1),d.Ab(2),d.uc("isCentered",!0))},directives:[ae.a,f.a,oe.a,se.a,a.h],styles:[""]}),Y),ue=n("1kSV"),he=((ne=function(){function e(t){_classCallCheck(this,e),this.modal=t}return _createClass(e,[{key:"dismissModal",value:function(){this.modal.dismiss()}},{key:"closeModal",value:function(){this.modal.close()}}]),e}()).\u0275fac=function(e){return new(e||ne)(d.Qb(ue.a))},ne.\u0275cmp=d.Kb({type:ne,selectors:[["j-can-register"]],decls:14,vars:3,consts:[[1,"modal-header","j-modal-header"],["type","button",1,"close",3,"click"],["src","/assets/icons/close.svg",3,"alt"],[1,"modal-body","j-modal-body"],["translate","",1,"auth-heading","light","mb-3","mt-0"],["translate","",1,"m-0"],[1,"modal-footer","j-modal-footer"],["translate","","type","button",1,"btn","btn-static","btn-primary",3,"click"],["translate","","type","button",1,"btn","btn-static","btn-link",3,"click"]],template:function(e,t){1&e&&(d.Wb(0,"div",0),d.Wb(1,"button",1),d.ic("click",(function(e){return t.dismissModal()})),d.Rb(2,"img",2),d.nc(3,"translate"),d.Vb(),d.Vb(),d.Wb(4,"div",3),d.Wb(5,"h3",4),d.Tc(6,"AUTH.CAN_REGISTER.TITLE"),d.Vb(),d.Wb(7,"p",5),d.Tc(8,"AUTH.CAN_REGISTER.DESCRIPTION"),d.Vb(),d.Vb(),d.Wb(9,"div",6),d.Wb(10,"button",7),d.ic("click",(function(e){return t.closeModal()})),d.Tc(11,"AUTH.REGISTER"),d.Vb(),d.Wb(12,"button",8),d.ic("click",(function(e){return t.dismissModal()})),d.Tc(13,"SHARED.CANCEL"),d.Vb(),d.Vb()),2&e&&(d.Ab(2),d.vc("alt",d.oc(3,1,"SHARED.CLOSE")))},directives:[k.a],pipes:[k.d],styles:[""]}),ne),le=((te=function(){function e(t){_classCallCheck(this,e),this.modal=t}return _createClass(e,[{key:"dismissModal",value:function(){this.modal.dismiss()}},{key:"closeModal",value:function(e){this.modal.close(e)}}]),e}()).\u0275fac=function(e){return new(e||te)(d.Qb(ue.a))},te.\u0275cmp=d.Kb({type:te,selectors:[["j-can-restore"]],decls:12,vars:3,consts:[[1,"modal-header","j-modal-header"],["type","button",1,"close",3,"click"],["src","/assets/icons/close.svg",3,"alt"],[1,"modal-body","j-modal-body"],["translate","",1,"auth-heading","light","mb-3","mt-0"],["translate","",1,"m-0"],[1,"modal-footer","j-modal-footer"],["translate","","type","button",1,"btn","btn-static","btn-primary",3,"click"]],template:function(e,t){1&e&&(d.Wb(0,"div",0),d.Wb(1,"button",1),d.ic("click",(function(e){return t.dismissModal()})),d.Rb(2,"img",2),d.nc(3,"translate"),d.Vb(),d.Vb(),d.Wb(4,"div",3),d.Wb(5,"h3",4),d.Tc(6,"AUTH.CAN_RESTORE.TITLE"),d.Vb(),d.Wb(7,"p",5),d.Tc(8,"AUTH.CAN_RESTORE.DESCRIPTION"),d.Vb(),d.Vb(),d.Wb(9,"div",6),d.Wb(10,"button",7),d.ic("click",(function(e){return t.closeModal("login")})),d.Tc(11,"AUTH.LOGIN"),d.Vb(),d.Vb()),2&e&&(d.Ab(2),d.vc("alt",d.oc(3,1,"SHARED.CLOSE")))},directives:[k.a],pipes:[k.d],styles:[""]}),te),be=((ee=function(){function e(t){_classCallCheck(this,e),this.modal=t}return _createClass(e,[{key:"dismissModal",value:function(){this.modal.dismiss()}},{key:"closeModal",value:function(e){this.modal.close(e)}}]),e}()).\u0275fac=function(e){return new(e||ee)(d.Qb(ue.a))},ee.\u0275cmp=d.Kb({type:ee,selectors:[["j-contact-modal"]],decls:14,vars:3,consts:[[1,"modal-header","j-modal-header"],["type","button",1,"close",3,"click"],["src","/assets/icons/close.svg",3,"alt"],[1,"modal-body","j-modal-body"],["translate","",1,"auth-heading","light","mb-3","mt-0"],["translate","",1,"m-0"],[1,"modal-footer","j-modal-footer"],["translate","","href","https://jysanbank.kz/ru/page/contacts","target","_blank",1,"btn","btn-static","btn-primary"],["translate","","type","button",1,"btn","btn-link","d-none","d-sm-block",3,"click"]],template:function(e,t){1&e&&(d.Wb(0,"div",0),d.Wb(1,"button",1),d.ic("click",(function(e){return t.dismissModal()})),d.Rb(2,"img",2),d.nc(3,"translate"),d.Vb(),d.Vb(),d.Wb(4,"div",3),d.Wb(5,"h3",4),d.Tc(6,"AUTH.CONTACT.TITLE"),d.Vb(),d.Wb(7,"p",5),d.Tc(8,"AUTH.CONTACT.DESCRIPTION "),d.Vb(),d.Vb(),d.Wb(9,"div",6),d.Wb(10,"a",7),d.Tc(11,"AUTH.CONTACT.LINK"),d.Vb(),d.Wb(12,"button",8),d.ic("click",(function(e){return t.dismissModal()})),d.Tc(13,"SHARED.CANCEL"),d.Vb(),d.Vb()),2&e&&(d.Ab(2),d.vc("alt",d.oc(3,1,"SHARED.CLOSE")))},directives:[k.a],pipes:[k.d],styles:[""]}),ee),de=(($=function(){function e(t){_classCallCheck(this,e),this.modal=t}return _createClass(e,[{key:"closeModal",value:function(){this.modal.close()}}]),e}()).\u0275fac=function(e){return new(e||$)(d.Qb(ue.a))},$.\u0275cmp=d.Kb({type:$,selectors:[["j-expired"]],decls:12,vars:3,consts:[[1,"modal-header","j-modal-header"],["type","button",1,"close",3,"click"],["src","/assets/icons/close.svg",3,"alt"],[1,"modal-body","j-modal-body"],["translate","",1,"auth-heading","light","mb-3","mt-0"],["translate","",1,"m-0"],[1,"modal-footer","j-modal-footer"],["translate","","type","button",1,"btn","btn-static","btn-primary",3,"click"]],template:function(e,t){1&e&&(d.Wb(0,"div",0),d.Wb(1,"button",1),d.ic("click",(function(e){return t.closeModal()})),d.Rb(2,"img",2),d.nc(3,"translate"),d.Vb(),d.Vb(),d.Wb(4,"div",3),d.Wb(5,"h3",4),d.Tc(6,"AUTH.EXPIRED.TITLE"),d.Vb(),d.Wb(7,"p",5),d.Tc(8,"AUTH.EXPIRED.DESCRIPTION"),d.Vb(),d.Vb(),d.Wb(9,"div",6),d.Wb(10,"button",7),d.ic("click",(function(e){return t.closeModal()})),d.Tc(11,"SHARED.CLOSE"),d.Vb(),d.Vb()),2&e&&(d.Ab(2),d.vc("alt",d.oc(3,1,"SHARED.CLOSE")))},directives:[k.a],pipes:[k.d],styles:[""]}),$),pe=((z=function(){function e(t){_classCallCheck(this,e),this.modal=t}return _createClass(e,[{key:"closeModal",value:function(){this.modal.close()}}]),e}()).\u0275fac=function(e){return new(e||z)(d.Qb(ue.a))},z.\u0275cmp=d.Kb({type:z,selectors:[["j-invalid-phone"]],decls:12,vars:3,consts:[[1,"modal-header","j-modal-header"],["type","button",1,"close",3,"click"],["src","/assets/icons/close.svg",3,"alt"],[1,"modal-body","j-modal-body"],["translate","",1,"auth-heading","light","mb-3","mt-0"],["translate","",1,"m-0"],[1,"modal-footer","j-modal-footer"],["translate","","type","button",1,"btn","btn-static","btn-primary",3,"click"]],template:function(e,t){1&e&&(d.Wb(0,"div",0),d.Wb(1,"button",1),d.ic("click",(function(e){return t.closeModal()})),d.Rb(2,"img",2),d.nc(3,"translate"),d.Vb(),d.Vb(),d.Wb(4,"div",3),d.Wb(5,"h3",4),d.Tc(6,"AUTH.INVALID_PHONE.TITLE"),d.Vb(),d.Wb(7,"p",5),d.Tc(8,"AUTH.INVALID_PHONE.DESCRIPTION"),d.Vb(),d.Vb(),d.Wb(9,"div",6),d.Wb(10,"button",7),d.ic("click",(function(e){return t.closeModal()})),d.Tc(11,"SHARED.OK"),d.Vb(),d.Vb()),2&e&&(d.Ab(2),d.vc("alt",d.oc(3,1,"SHARED.CLOSE")))},directives:[k.a],pipes:[k.d],styles:[""]}),z),me=n("bsP8");function ve(e){var t=12==e.value.length;if(t)return null;var n={};return t||(n.length=!0),{iin:n}}var fe,ge,Te,Re=n("tkTF"),Ee=["iinInput"],ke=((fe=function(){function e(t){var n=this;_classCallCheck(this,e),this.authService=t,this.IIN="",this.submitted=new d.n,this.subs=new h.a,this.openIinForm=new o.k({iin:new o.h(this.IIN,[o.H.required,ve])});var i=this.openIinForm.valueChanges.subscribe((function(e){n.isSubmitted=!1,n.errorText=""}));this.subs.add(i)}return _createClass(e,[{key:"ngOnDestroy",value:function(){this.subs.unsubscribe()}},{key:"ngAfterViewInit",value:function(){this.iinInput.focus()}},{key:"onSubmit",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.isSubmitted=!0,this.openIinForm.valid?(this.isLoading=!0,this.submitted.emit({iin:this.iin})):this.validateIin(this.f.iin.errors);case 1:case"end":return e.stop()}}),e,this)})))}},{key:"validateIin",value:function(e){e&&e.iin&&(e.iin.length?this.errorText="ERRORS.IIN_LENGTH":e.iin.date&&(this.errorText="ERRORS.IIN_DATE"))}},{key:"f",get:function(){return this.openIinForm.controls}},{key:"iin",get:function(){return this.f.iin.value}}]),e}()).\u0275fac=function(e){return new(e||fe)(d.Qb(p.a))},fe.\u0275cmp=d.Kb({type:fe,selectors:[["j-auth-iin"]],viewQuery:function(e,t){var n;1&e&&d.Yc(Ee,!0),2&e&&d.Ec(n=d.jc())&&(t.iinInput=n.first)},outputs:{submitted:"submitted"},decls:9,vars:6,consts:[[3,"formGroup"],[1,"form-group"],[3,"formControl","hasError","errorText"],["iinInput",""],[1,"auth-submit"],["translate","","type","submit",1,"btn","btn-static","btn-primary","btn-lg",3,"jLoading","disabled","click"],["translate","","href","#","routerLink","/auth/login",1,"btn","btn-static","btn-link"]],template:function(e,t){1&e&&(d.Wb(0,"form",0),d.Wb(1,"div",1),d.Rb(2,"j-iin-input",2,3),d.Vb(),d.Wb(4,"div",4),d.Wb(5,"button",5),d.ic("click",(function(e){return t.onSubmit()})),d.Tc(6,"SHARED.CONTINUE"),d.Vb(),d.Wb(7,"a",6),d.Tc(8,"AUTH.LOGIN"),d.Vb(),d.Vb(),d.Vb()),2&e&&(d.uc("formGroup",t.openIinForm),d.Ab(2),d.uc("formControl",t.f.iin)("hasError",t.f.iin.errors&&t.isSubmitted)("errorText",t.errorText),d.Ab(3),d.uc("jLoading",t.isLoading)("disabled",t.isLoading))},directives:[o.J,o.u,o.l,Re.a,o.t,o.i,k.a,A.a,a.f],styles:[""]}),fe),ye={backdropClass:"backdrop_light",windowClass:"modal_light modal-auth",size:"md",centered:!0},Se=((ge=function(){function e(t,n,i,r,a){var o=this;_classCallCheck(this,e),this.router=t,this.route=n,this.navService=i,this.modalService=r,this.companyService=a,this.subs=new h.a,this.isFromAtf=!1,this.navService.triggerRegisterError("iin",!1),this.navService.triggerRegisterError("no-account",!1),this.navService.triggerRegisterError("no-email",!1),this.navService.triggerRegisterError("user-blocked",!1),this.navService.triggerRegisterError("phone-not-match",!1);var s=this.route.data.subscribe((function(e){o.title=e.title,o.authType=e.action})),c=this.route.queryParams.subscribe((function(e){o.isFromAtf=o.companyService.isFromAtf(e)}));this.subs.add(s),this.subs.add(c)}return _createClass(e,[{key:"ngOnDestroy",value:function(){this.subs.unsubscribe()}},{key:"onSubmit",value:function(e){this.navigateToPhone(e.iin)}},{key:"handleCheckIin",value:function(e,t){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:n.t0=e,n.next=n.t0===T.e.BLOCKED?3:n.t0===T.e.DOES_NOT_EXIST?5:n.t0===T.e.INCORRECT_DATA?7:n.t0===T.e.INVALID_DATA?7:n.t0===T.e.ALREADY_REGISTERED?9:n.t0===T.e.CAN_REGISTER?11:12;break;case 3:return this.navigateToUserBlocked(),n.abrupt("break",12);case 5:return this.navigateToNoAccount(),n.abrupt("break",12);case 7:return this.navigateToNoEmail(),n.abrupt("break",12);case 9:return this.handleAlreadyRegistered(t),n.abrupt("break",12);case 11:this.handleCanRegister(t);case 12:case"end":return n.stop()}}),n,this)})))}},{key:"handleAlreadyRegistered",value:function(e){switch(this.authType){case T.a.RESTORE:this.navigateToPhone(e);break;case T.a.REGISTER:this.showCanRestoreModal(e)}}},{key:"showCanRegisterModal",value:function(e){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.modalService.open(he,ye),t.prev=1,t.next=4,n.result;case 4:this.navigateToRegisterPhone(e),t.next=9;break;case 7:t.prev=7,t.t0=t.catch(1);case 9:case"end":return t.stop()}}),t,this,[[1,7]])})))}},{key:"showCanRestoreModal",value:function(e){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.modalService.open(le,ye),t.prev=1,t.next=4,n.result;case 4:"restore"==(i=t.sent)?this.navigateToRestorePhone(e):"login"==i&&this.navigateToLogin(),t.next=10;break;case 8:t.prev=8,t.t0=t.catch(1);case 10:case"end":return t.stop()}}),t,this,[[1,8]])})))}},{key:"handleCanRegister",value:function(e){switch(this.authType){case T.a.REGISTER:this.navigateToPhone(e);break;case T.a.RESTORE:this.showCanRegisterModal(e)}}},{key:"navigateToPhone",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.router.navigate(["".concat(t,"phone")],{relativeTo:this.route.parent,state:{iin:e}})}},{key:"navigateToRegisterPhone",value:function(e){this.navigateToPhone(e,"../register/")}},{key:"navigateToRestorePhone",value:function(e){this.navigateToPhone(e,"../restore/")}},{key:"navigateToLogin",value:function(){this.router.navigate(["../login"],{relativeTo:this.route.parent})}},{key:"navigateToNoAccount",value:function(){this.router.navigate(["no-account"],{relativeTo:this.route.parent})}},{key:"navigateToNoEmail",value:function(){this.router.navigate(["no-email"],{relativeTo:this.route.parent})}},{key:"navigateToUserBlocked",value:function(){this.router.navigate(["user-blocked"],{relativeTo:this.route.parent})}}]),e}()).\u0275fac=function(e){return new(e||ge)(d.Qb(a.c),d.Qb(a.a),d.Qb(me.a),d.Qb(ue.q),d.Qb(E.a))},ge.\u0275cmp=d.Kb({type:ge,selectors:[["j-register-iin"]],decls:7,vars:4,consts:[["translate","",1,"auth-heading","light","mb-3","mt-0"],[3,"submitted"]],template:function(e,t){1&e&&(d.Wb(0,"article"),d.Wb(1,"h3",0),d.Tc(2),d.Vb(),d.Wb(3,"p"),d.Tc(4),d.nc(5,"translate"),d.Vb(),d.Vb(),d.Wb(6,"j-auth-iin",1),d.ic("submitted",(function(e){return t.onSubmit(e)})),d.Vb()),2&e&&(d.Ab(2),d.Uc(t.title),d.Ab(2),d.Uc(d.oc(5,2,t.isFromAtf?"AUTH.REGISTER_SUBTITLE_ATF":"AUTH.REGISTER_SUBTITLE")))},directives:[k.a,ke],pipes:[k.d],styles:[""]}),ge),Ce=["phoneInput"],Ae=((Te=function(){function e(t,n,i,r,a,s,c,u,b){var d=this;_classCallCheck(this,e),this.router=t,this.route=n,this.maskedService=i,this.maskPipe=r,this.navService=a,this.authService=s,this.modalService=c,this.translateService=u,this.dictionariesService=b,this.PHONE="",this.hasNoAccount=!1,this.countryCode={code:"+7",country:this.translateService.instant("COUNTRIES.".concat(T.b.KAZAKHSTAN)),id:T.b.KAZAKHSTAN,countryCode:T.c.KAZAKHSTAN},this.subs=new h.a,this.registerPhoneForm=new o.k({phone:new o.h(this.PHONE,o.H.required)}),this.navService.triggerRegisterError("phone",!1),this.navService.triggerRegisterError("no-account",!1),this.navService.triggerRegisterError("no-email",!1),this.navService.triggerRegisterError("user-blocked",!1),this.navService.triggerRegisterError("phone-not-match",!1);var p=this.registerPhoneForm.valueChanges.subscribe((function(){d.isSubmitted=!1})),m=this.route.data.subscribe((function(e){d.title=e.title,d.authType=e.action})),v=this.route.paramMap.pipe(Object(l.a)((function(){return window.history.state}))).subscribe((function(e){e.iin?d.iin=e.iin:d.navigateToIin(),e.countryCode&&(d.countryCode=e.countryCode,e.phone&&d.f.phone.setValue(e.phone))}));this.subs.add(p),this.subs.add(m),this.subs.add(v)}return _createClass(e,[{key:"ngOnInit",value:function(){this.fetchCountryCodes()}},{key:"ngOnDestroy",value:function(){this.subs.unsubscribe()}},{key:"onEnter",value:function(){this.phoneInput.blur(),this.onSubmit()}},{key:"focus",value:function(){this.phoneInput.focus()}},{key:"navigateFromModal",value:function(e){this.router.navigate(["/auth/".concat(e,"/sms")],{state:{phone:this.phone,iin:this.iin}})}},{key:"fetchCountryCodes",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.dictionariesService.fetchCountryCodesDictionary().then((function(e){t.countryCodes=e.map((function(e){return{id:e.id,code:e.value.description,country:e.value.name,countryCode:e.value.code}}))}));case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:case"end":return e.stop()}}),e,this,[[0,5]])})))}},{key:"onSubmit",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isSubmitted=!0,!this.registerPhoneForm.valid){e.next=23;break}return this.isLoading=!0,e.prev=2,this.phone="+"+this.maskedService.getUnmaskedPhone(this.f.phone.value),e.next=6,this.authService.checkPhone(this.phone);case 6:this.navigateToSms(),e.next=18;break;case 9:e.prev=9,e.t0=e.catch(2),e.t1=e.t0.code,e.next=e.t1===b.b.INVALID_PHONE_FORMAT?14:17;break;case 14:return e.next=16,this.showInvalidPhoneFormatModal();case 16:return e.abrupt("break",18);case 17:this.errorText=e.t0.description;case 18:return e.prev=18,this.isLoading=!1,e.finish(18);case 21:e.next=24;break;case 23:this.errorText="ERRORS.NOT_ENOUGH_SYMBOLS";case 24:case"end":return e.stop()}}),e,this,[[2,9,18,21]])})))}},{key:"showInvalidPhoneFormatModal",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.modalService.open(pe,{centered:!0}),e.prev=1,e.next=4,t.result;case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:return e.prev=8,this.phoneInput.focus(),e.finish(8);case 11:case"end":return e.stop()}}),e,this,[[1,6,8,11]])})))}},{key:"navigateToSms",value:function(){this.router.navigate(["sms"],{relativeTo:this.route.parent,state:{phone:this.phone,iin:this.iin,countryCode:this.countryCode}})}},{key:"navigateToIin",value:function(){this.router.navigate(["iin"],{relativeTo:this.route.parent})}},{key:"onCountrySelected",value:function(e){this.countryCode=e}},{key:"f",get:function(){return this.registerPhoneForm.controls}}]),e}()).\u0275fac=function(e){return new(e||Te)(d.Qb(a.c),d.Qb(a.a),d.Qb(R.a),d.Qb(s.b),d.Qb(me.a),d.Qb(p.a),d.Qb(ue.q),d.Qb(k.e),d.Qb(g.a))},Te.\u0275cmp=d.Kb({type:Te,selectors:[["j-register-phone"]],viewQuery:function(e,t){var n;1&e&&d.Yc(Ce,!0),2&e&&d.Ec(n=d.jc())&&(t.phoneInput=n.first)},hostBindings:function(e,t){1&e&&d.ic("keyup.enter",(function(e){return t.onEnter()}))},decls:18,vars:13,consts:[["routerLink","../iin",1,"auth-backlink","j-link"],["name","arrowLeft","color","primary",1,"mr-2",3,"isStroke"],["translate",""],["translate","",1,"auth-heading","light","mb-3","mt-0"],[3,"formGroup"],[1,"phone-block"],[3,"countryCodes","countryCode","countrySelected"],["phonePrefixInput",""],[3,"autofocus","formControl","hasError","errorText","countryCodes","countryCode","countrySelected"],["phoneInput",""],[1,"auth-submit"],["translate","","type","button",1,"btn","btn-static","btn-primary","btn-lg",3,"jLoading","disabled","click"]],template:function(e,t){1&e&&(d.Wb(0,"a",0),d.Rb(1,"j-icon",1),d.Wb(2,"span",2),d.Tc(3,"SHARED.IIN"),d.Vb(),d.Vb(),d.Wb(4,"article"),d.Wb(5,"h3",3),d.Tc(6),d.Vb(),d.Wb(7,"p",2),d.Tc(8,"AUTH.PHONE.DESCRIPTION"),d.Vb(),d.Vb(),d.Wb(9,"form",4),d.Wb(10,"div",5),d.Wb(11,"j-phone-prefix-input",6,7),d.ic("countrySelected",(function(e){return t.onCountrySelected(e)})),d.Vb(),d.Wb(13,"j-phone-input",8,9),d.ic("countrySelected",(function(e){return t.onCountrySelected(e)})),d.Vb(),d.Vb(),d.Wb(15,"div",10),d.Wb(16,"button",11),d.ic("click",(function(e){return t.onSubmit()})),d.Tc(17,"SHARED.CONTINUE"),d.Vb(),d.Vb(),d.Vb()),2&e&&(d.Ab(1),d.uc("isStroke",!0),d.Ab(5),d.Uc(t.title),d.Ab(3),d.uc("formGroup",t.registerPhoneForm),d.Ab(2),d.uc("countryCodes",t.countryCodes)("countryCode",t.countryCode),d.Ab(2),d.uc("autofocus",!0)("formControl",t.f.phone)("hasError",t.f.phone.errors&&t.isSubmitted)("errorText",t.errorText)("countryCodes",t.countryCodes)("countryCode",t.countryCode),d.Ab(3),d.uc("jLoading",t.isLoading)("disabled",t.isLoading))},directives:[a.f,W.a,k.a,o.J,o.u,o.l,y.a,S.a,o.t,o.i,A.a],styles:[".phone-block[_ngcontent-%COMP%]{display:-webkit-box;display:flex}"]}),Te);function Ie(e,t){if(1&e){var n=d.Xb();d.Wb(0,"a",3),d.ic("click",(function(e){return d.Ic(n),d.mc().navigateToPhone(e)})),d.Rb(1,"j-icon",4),d.Wb(2,"span",5),d.Tc(3,"SHARED.PHONE"),d.Vb(),d.Vb()}2&e&&(d.Ab(1),d.uc("isStroke",!0))}function Oe(e,t){if(1&e){var n=d.Xb();d.Wb(0,"j-sms",6),d.ic("submitted",(function(e){return d.Ic(n),d.mc().onSmsSubmit(e)}))("failed",(function(e){return d.Ic(n),d.mc().onSmsFail()}))("loaded",(function(e){return d.Ic(n),d.mc().onFormLoaded()})),d.Vb()}if(2&e){var i=d.mc();d.uc("phone",i.phone)("countryCode",i.countryCode)("params",i.params)("headers",i.headerParams)}}function we(e,t){1&e&&d.Rb(0,"j-animated-loading")}var Le,Ne={backdropClass:"backdrop_light",windowClass:"modal_light modal-auth",size:"md",centered:!0},Ve=((Le=function(){function e(t,n,i,r){var a=this;_classCallCheck(this,e),this.authService=t,this.route=n,this.router=i,this.modalService=r,this.isFormLoaded=!1,this.subs=new h.a,this.subs.add(this.route.paramMap.pipe(Object(l.a)((function(){return window.history.state}))).subscribe((function(e){a.phone=e.phone,a.countryCode=e.countryCode,a.iin=e.iin,a.params={actionIds:[a.iin]}})));var o=this.route.data.subscribe((function(e){a.authType=e.action,a.headerParams={smsHeader:D.c[a.authType.toUpperCase()]}}));this.subs.add(o)}return _createClass(e,[{key:"ngOnDestroy",value:function(){this.subs.unsubscribe()}},{key:"onSmsFail",value:function(){this.navigateToPhone()}},{key:"onFormLoaded",value:function(){this.isFormLoaded=!0}},{key:"onSmsSubmit",value:function(e){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.authService.setSmsToken(e),this.checkIinAndPhone();case 1:case"end":return t.stop()}}),t,this)})))}},{key:"navigateToPhone",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null===(e=t)||void 0===e||e.preventDefault(),this.router.navigate(["phone"],{relativeTo:this.route.parent,state:{iin:this.iin,phone:this.phone,countryCode:this.countryCode}})}},{key:"checkIinAndPhone",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.authService.checkIinAndPhone(this.iin,this.phone);case 3:t=e.sent,this.handleIinAndPhoneCheck(t.status),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),this.navigateToError(e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})))}},{key:"handleIinAndPhoneCheck",value:function(e){switch(e){case T.d.BLOCKED:this.navigateToUserBlocked();break;case T.d.DOES_NOT_EXIST:this.navigateToNoAccount();break;case T.d.INVALID_DATA:case T.d.INCORRECT_DATA:this.navigateToNoEmail();break;case T.d.DATA_MISMATCH:this.navigateToPhoneNotMatch();break;case T.d.ALREADY_REGISTERED:this.handleAlreadyRegistered();break;case T.d.CAN_REGISTER:this.handleCanRegister()}}},{key:"navigateToError",value:function(e){this.router.navigate(["error"],{relativeTo:this.route.parent,state:{error:e,iin:this.iin}})}},{key:"navigateToUserBlocked",value:function(){this.router.navigate(["user-blocked"],{relativeTo:this.route.parent})}},{key:"navigateToEmail",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.router.navigate(["".concat(e,"email")],{relativeTo:this.route.parent,state:{phone:this.phone,iin:this.iin}})}},{key:"navigateToNoAccount",value:function(){this.router.navigate(["no-account"],{relativeTo:this.route.parent})}},{key:"navigateToNoEmail",value:function(){this.router.navigate(["no-email"],{relativeTo:this.route.parent})}},{key:"navigateToPhoneNotMatch",value:function(){this.router.navigate(["phone-not-match"],{relativeTo:this.route.parent,state:{iin:this.iin,phone:this.phone,countryCode:this.countryCode}})}},{key:"handleAlreadyRegistered",value:function(){switch(this.authType){case T.a.RESTORE:this.navigateToEmail();break;case T.a.REGISTER:this.showCanRestoreModal()}}},{key:"showCanRegisterModal",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.modalService.open(he,Ne),e.prev=1,e.next=4,t.result;case 4:this.navigateToRegisterEmail(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),this.navigateToPhone();case 10:case"end":return e.stop()}}),e,this,[[1,7]])})))}},{key:"showCanRestoreModal",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.modalService.open(le,Ne),e.prev=1,e.next=4,t.result;case 4:"restore"===(n=e.sent)?this.navigateToRestoreEmail():"login"===n&&this.navigateToLogin(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),this.navigateToPhone();case 11:case"end":return e.stop()}}),e,this,[[1,8]])})))}},{key:"handleCanRegister",value:function(){switch(this.authType){case T.a.REGISTER:this.navigateToEmail();break;case T.a.RESTORE:this.showCanRegisterModal()}}},{key:"navigateToRegisterEmail",value:function(){this.navigateToEmail("../register/")}},{key:"navigateToRestoreEmail",value:function(){this.navigateToEmail("../restore/")}},{key:"navigateToLogin",value:function(){this.router.navigate(["../login"],{relativeTo:this.route.parent})}}]),e}()).\u0275fac=function(e){return new(e||Le)(d.Qb(p.a),d.Qb(a.a),d.Qb(a.c),d.Qb(ue.q))},Le.\u0275cmp=d.Kb({type:Le,selectors:[["j-register-sms"]],decls:3,vars:3,consts:[["href","#","class","auth-backlink j-link",3,"click",4,"ngIf"],[3,"phone","countryCode","params","headers","submitted","failed","loaded",4,"ngIf"],[4,"ngIf"],["href","#",1,"auth-backlink","j-link",3,"click"],["name","arrowLeft","color","primary",1,"mr-2",3,"isStroke"],["translate",""],[3,"phone","countryCode","params","headers","submitted","failed","loaded"]],template:function(e,t){1&e&&(d.Rc(0,Ie,4,1,"a",0),d.Rc(1,Oe,1,4,"j-sms",1),d.Rc(2,we,1,0,"j-animated-loading",2)),2&e&&(d.uc("ngIf",t.isFormLoaded),d.Ab(1),d.uc("ngIf",t.params),d.Ab(1),d.uc("ngIf",!t.isFormLoaded))},directives:[r.u,W.a,k.a,x.a,U.a],styles:[""]}),Le),_e=n("gN/K"),De=n("bSvt"),Pe=["codeInput"];function je(e,t){if(1&e){var n=d.Xb();d.Wb(0,"a",14),d.ic("click",(function(e){return d.Ic(n),d.mc().navigateToPhone(e)})),d.Rb(1,"j-icon",15),d.Wb(2,"span",16),d.Tc(3,"SHARED.PHONE"),d.Vb(),d.Vb()}2&e&&(d.Ab(1),d.uc("isStroke",!0))}function We(e,t){if(1&e){var n=d.Xb();d.Wb(0,"j-sms-error",17),d.ic("codeRequested",(function(e){return d.Ic(n),d.mc().requestEmail()})),d.Vb()}if(2&e){var i=d.mc();d.uc("errorType",i.errorTypes.FORBIDDEN)("isLoading",i.isLoading)("destinationValue",i.email)("timerValue",i.timerValue)("isTimerRunning",i.isTimerRunning)}}function xe(e,t){if(1&e){var n=d.Xb();d.Wb(0,"j-sms-error",17),d.ic("codeRequested",(function(e){return d.Ic(n),d.mc().requestEmail()})),d.Vb()}if(2&e){var i=d.mc();d.uc("errorType",i.errorTypes.FORBIDDEN)("isLoading",i.isLoading)("destinationValue",i.email)("timerValue",i.blockedTimerValue)("isTimerRunning",i.isBlockedTimerRunning)}}function He(e,t){if(1&e){var n=d.Xb();d.Wb(0,"j-sms-error",18),d.ic("codeRequested",(function(e){return d.Ic(n),d.mc().requestEmail()})),d.Vb()}if(2&e){var i=d.mc();d.uc("errorType",i.errorTypes.UNKNOWN)("isLoading",i.isLoading)("destinationValue",i.email)("isTimerRunning",i.isBlockedTimerRunning)("timerValue",i.blockedTimerValue)}}function Ue(e,t){1&e&&d.Rb(0,"j-animated-loading")}var Me,Fe,Ke,Ge,Qe,Be,qe,Xe,Je,Ze=((Me=function(){function e(t,n,i,r){var a=this;_classCallCheck(this,e),this.route=t,this.auth=n,this.router=i,this.modalService=r,this.smsCodeLength=P.l,this.timerMaxValue=P.o,this.expireTimerMaxValue=300,this.errorTypes=P.m,this.isReady=!1,this.currentTab=P.n.FORM,this.authTabs=P.n,this.subs=new h.a,this.emailCodeForm=new o.k({emailCode:new o.h("",o.H.required)});var s=this.route.paramMap.pipe(Object(l.a)((function(){return window.history.state}))).subscribe((function(e){a.phone=e.phone,a.iin=e.iin,a.requestEmail()})),c=this.emailCodeForm.valueChanges.subscribe((function(e){a.isSubmitted=!1,e.emailCode&&e.emailCode.length===a.smsCodeLength&&a.onSubmit()}));this.subs.add(s),this.subs.add(c)}return _createClass(e,[{key:"ngOnDestroy",value:function(){this.subs.unsubscribe()}},{key:"openContactModal",value:function(){this.modalService.open(be,{centered:!0})}},{key:"setTab",value:function(e){this.currentTab=e}},{key:"requestEmail",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.f.emailCode.setValue(""),this.errorText="",this.hasError=!1,e.prev=1,e.next=4,this.auth.requestEmail(this.phone,this.iin);case 4:t=e.sent,this.setTab(this.authTabs.FORM),this.email=t.email.replace(/\*/gm,"\u2022"),this.codeInput.focus(),e.next=18;break;case 8:e.prev=8,e.t0=e.catch(1),e.t1=e.t0.code,e.next=e.t1===b.b.ARGUMENT_MISSING?13:e.t1===b.b.RESOURCE_BLOCKED?15:17;break;case 13:return this.router.navigate(["phone"],{relativeTo:this.route.parent}),e.abrupt("break",18);case 15:return e.t0.data&&e.t0.data.millisecondsLeft&&this.startBlockedTimer(e.t0.data.millisecondsLeft),this.setTab(this.authTabs.FORBIDDEN_BLOCKED),e.abrupt("break",18);case 17:this.setTab(this.authTabs.ERRORED);case 18:return e.prev=18,this.isReady=!0,e.finish(18);case 21:case"end":return e.stop()}}),e,this,[[1,8,18,21]])})))}},{key:"navigateToPhone",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null===(e=t)||void 0===e||e.preventDefault(),this.router.navigate(["phone"],{relativeTo:this.route.parent,state:{iin:this.iin,phone:this.phone}})}},{key:"onSubmit",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isSubmitted=!0,!this.emailCodeForm.valid){e.next=48;break}return this.isLoading=!0,t=this.f.emailCode.value,e.prev=3,e.next=6,this.auth.submitEmail(t,this.phone,this.iin);case 6:this.router.navigate(["password"],{relativeTo:this.route.parent,state:{phone:this.phone,iin:this.iin}}),e.next=45;break;case 9:e.prev=9,e.t0=e.catch(3),e.t1=(this.hasError=!0,e.t0.code),e.next=e.t1===b.b.ARGUMENT_MISSING?14:e.t1===b.b.RESOURCE_BLOCKED?16:e.t1===b.b.INVALID_CODE?16:e.t1===b.b.FORBIDDEN?29:e.t1===b.b.PHONE_TOKEN_EXPIRED?31:e.t1===b.b.TOKEN_EXPIRED?31:43;break;case 14:return this.router.navigate(["phone"],{relativeTo:this.route.parent}),e.abrupt("break",44);case 16:if(!e.t0.data||!e.t0.data.triesLeft){e.next=27;break}e.t2=(n=e.t0.data.triesLeft,this.errorParams={triesLeft:n},this.errorText="ERRORS.INVALID_CODE.",n%20),e.next=1===e.t2?20:2===e.t2?22:3===e.t2?22:4===e.t2?22:24;break;case 20:return this.errorText+="ONE",e.abrupt("break",25);case 22:return this.errorText+="FEW",e.abrupt("break",25);case 24:this.errorText+="OTHER";case 25:e.next=28;break;case 27:this.startTimer(),this.setTab(this.authTabs.FORBIDDEN);case 28:return e.abrupt("break",44);case 29:return this.startTimer(),this.setTab(this.authTabs.FORBIDDEN),e.abrupt("break",44);case 31:return i=this.modalService.open(de,{centered:!0}),e.prev=32,e.next=35,i.result;case 35:e.next=39;break;case 37:e.prev=37,e.t3=e.catch(32);case 39:return e.prev=39,this.router.navigate(["iin"],{relativeTo:this.route.parent,state:{iin:this.iin}}),e.finish(39);case 42:return e.abrupt("break",44);case 43:this.errorText=e.t0.description;case 44:this.codeInput.triggerHelperAnimation();case 45:return e.prev=45,this.isLoading=!1,e.finish(45);case 48:case"end":return e.stop()}}),e,this,[[3,9,45,48],[32,37,39,42]])})))}},{key:"startTimer",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timerMaxValue;this.isTimerRunning=!0,this.timerValue=t,this.timer=setInterval((function(){e.timerValue--,0===e.timerValue&&e.stopTimer()}),1e3)}},{key:"stopTimer",value:function(){clearInterval(this.timer),this.isTimerRunning=!1}},{key:"startBlockedTimer",value:function(e){var t=this;this.blockedTimerValue=Math.ceil(e/1e3),this.isBlockedTimerRunning=!0,this.blockedTimer=setInterval((function(){t.blockedTimerValue--,0===t.blockedTimerValue&&t.stopBlockedTimer()}),1e3)}},{key:"stopBlockedTimer",value:function(){clearInterval(this.blockedTimer),this.isBlockedTimerRunning=!1,this.blockedTimerValue=null}},{key:"f",get:function(){return this.emailCodeForm.controls}}]),e}()).\u0275fac=function(e){return new(e||Me)(d.Qb(a.a),d.Qb(p.a),d.Qb(a.c),d.Qb(ue.q))},Me.\u0275cmp=d.Kb({type:Me,selectors:[["j-register-email"]],viewQuery:function(e,t){var n;1&e&&d.Yc(Pe,!0),2&e&&d.Ec(n=d.jc())&&(t.codeInput=n.first)},decls:21,vars:16,consts:[["href","#","class","auth-backlink j-link",3,"click",4,"ngIf"],[3,"hidden"],["translate","",1,"auth-heading","light","mb-3","mt-0"],["translate","",1,"mb-4"],[1,"text-nowrap"],[1,"my-4",3,"formGroup","ngSubmit"],[1,"my-4",3,"autofocus","hasError","errorText","errorTranslateParams","formControl"],["codeInput",""],[1,"auth-submit"],["translate","","type","submit",1,"btn","btn-static","btn-primary","btn-lg",3,"jLoading","disabled"],["translate","","type","button",1,"btn","btn-static","btn-link",3,"click"],["destinationLabel","AUTH.EMAIL.DESTINATION",3,"errorType","isLoading","destinationValue","timerValue","isTimerRunning","codeRequested",4,"ngIf"],["destinationLabel","AUTH.EMAIL.DESTINATION",3,"errorType","isLoading","destinationValue","isTimerRunning","timerValue","codeRequested",4,"ngIf"],[4,"ngIf"],["href","#",1,"auth-backlink","j-link",3,"click"],["name","arrowLeft","color","primary",1,"mr-2",3,"isStroke"],["translate",""],["destinationLabel","AUTH.EMAIL.DESTINATION",3,"errorType","isLoading","destinationValue","timerValue","isTimerRunning","codeRequested"],["destinationLabel","AUTH.EMAIL.DESTINATION",3,"errorType","isLoading","destinationValue","isTimerRunning","timerValue","codeRequested"]],template:function(e,t){1&e&&(d.Rc(0,je,4,1,"a",0),d.Wb(1,"div",1),d.Wb(2,"h3",2),d.Tc(3,"AUTH.EMAIL.TITLE"),d.Vb(),d.Wb(4,"div",1),d.Wb(5,"p",3),d.Tc(6," AUTH.EMAIL.DESCRIPTION "),d.Wb(7,"strong",4),d.Tc(8),d.Vb(),d.Vb(),d.Wb(9,"form",5),d.ic("ngSubmit",(function(e){return t.onSubmit()})),d.Rb(10,"j-sms-input",6,7),d.Wb(12,"div",8),d.Wb(13,"button",9),d.Tc(14,"SHARED.CONTINUE"),d.Vb(),d.Wb(15,"button",10),d.ic("click",(function(e){return t.openContactModal()})),d.Tc(16,"AUTH.EMAIL.NO_CODE_RECEIVED"),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Rc(17,We,1,5,"j-sms-error",11),d.Rc(18,xe,1,5,"j-sms-error",11),d.Rc(19,He,1,5,"j-sms-error",12),d.Vb(),d.Rc(20,Ue,1,0,"j-animated-loading",13)),2&e&&(d.uc("ngIf",t.isReady),d.Ab(1),d.uc("hidden",!t.isReady),d.Ab(3),d.uc("hidden",t.currentTab!=t.authTabs.FORM),d.Ab(4),d.Uc(t.email),d.Ab(1),d.uc("formGroup",t.emailCodeForm),d.Ab(1),d.uc("autofocus",!0)("hasError",t.hasError)("errorText",t.errorText)("errorTranslateParams",t.errorParams)("formControl",t.f.emailCode),d.Ab(3),d.uc("jLoading",t.isLoading)("disabled",t.isLoading),d.Ab(4),d.uc("ngIf",t.currentTab==t.authTabs.FORBIDDEN),d.Ab(1),d.uc("ngIf",t.currentTab==t.authTabs.FORBIDDEN_BLOCKED),d.Ab(1),d.uc("ngIf",t.currentTab==t.authTabs.ERRORED),d.Ab(1),d.uc("ngIf",!t.isReady))},directives:[r.u,k.a,o.J,o.u,o.l,_e.a,o.t,o.i,A.a,W.a,De.a,U.a],styles:[""]}),Me),Ye=n("kUBv"),ze=((Xe=function(){function e(t,n,i,r){var a=this;_classCallCheck(this,e),this.auth=t,this.router=n,this.route=i,this.modalService=r,this.isLoading=!1,this.subs=new h.a;var o=this.route.paramMap.pipe(Object(l.a)((function(){return window.history.state}))).subscribe((function(e){a.phone=e.phone,a.iin=e.iin,a.iin?a.phone||a.navigateToPhone():a.navigateToIin()})),s=this.route.data.subscribe((function(e){a.authType=e.action}));this.subs.add(o),this.subs.add(s)}return _createClass(e,[{key:"ngOnDestroy",value:function(){this.subs.unsubscribe()}},{key:"onSubmit",value:function(e){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.isLoading=!0,t.prev=1,this.authType!=T.a.RESTORE){t.next=7;break}return t.next=5,this.auth.restore(this.phone,e.newPassword,this.iin);case 5:t.next=9;break;case 7:return t.next=9,this.auth.register(this.phone,e.newPassword,this.iin);case 9:this.navigateToResult(e.newPassword),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(1),this.mapError(t.t0);case 15:return t.prev=15,this.isLoading=!1,t.finish(15);case 18:case"end":return t.stop()}}),t,this,[[1,12,15,18]])})))}},{key:"mapError",value:function(e){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=e.code,t.next=t.t0===b.b.RESOURCE_NOT_FOUND?3:t.t0===b.b.FORBIDDEN?3:t.t0===b.b.RESOURCE_EXISTS?3:t.t0===b.b.PHONE_TOKEN_EXPIRED?5:t.t0===b.b.TOKEN_EXPIRED?5:t.t0===b.b.INVALID_PHONE_FORMAT?7:t.t0===b.b.ARGUMENT_MISSING?7:9;break;case 3:return this.navigateToPhoneNotMatch(),t.abrupt("break",10);case 5:return this.showExpiredModal(),t.abrupt("break",10);case 7:return this.navigateToPhone(),t.abrupt("break",10);case 9:this.errorText=e.description;case 10:case"end":return t.stop()}}),t,this)})))}},{key:"showExpiredModal",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.modalService.open(de,{centered:!0}),e.prev=1,e.next=4,t.result;case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:return e.prev=8,this.navigateToIin(),e.finish(8);case 11:case"end":return e.stop()}}),e,this,[[1,6,8,11]])})))}},{key:"navigateToIin",value:function(){this.router.navigate(["iin"],{relativeTo:this.route.parent,state:{iin:this.iin||""}})}},{key:"navigateToPhone",value:function(){this.router.navigate(["phone"],{relativeTo:this.route.parent,state:{iin:this.iin}})}},{key:"navigateToResult",value:function(e){this.router.navigate(["result"],{relativeTo:this.route.parent,state:{phone:this.phone,password:e}})}},{key:"navigateToPhoneNotMatch",value:function(){this.router.navigate(["phone-not-match"],{relativeTo:this.route.parent})}}]),e}()).\u0275fac=function(e){return new(e||Xe)(d.Qb(p.a),d.Qb(a.c),d.Qb(a.a),d.Qb(ue.q))},Xe.\u0275cmp=d.Kb({type:Xe,selectors:[["j-register-password"]],decls:7,vars:2,consts:[["translate","",1,"auth-heading","light","mb-3","mt-0"],["translate","",1,"mb-4"],[1,"my-4"],[3,"isLoading","errorText","submitted"]],template:function(e,t){1&e&&(d.Wb(0,"article"),d.Wb(1,"h3",0),d.Tc(2,"AUTH.PASSWORD.TITLE"),d.Vb(),d.Wb(3,"p",1),d.Tc(4,"AUTH.PASSWORD.DESCRIPTION"),d.Vb(),d.Wb(5,"div",2),d.Wb(6,"j-new-password",3),d.ic("submitted",(function(e){return t.onSubmit(e)})),d.Vb(),d.Vb(),d.Vb()),2&e&&(d.Ab(6),d.uc("isLoading",t.isLoading)("errorText",t.errorText))},directives:[k.a,Ye.a],styles:[""]}),Xe),$e=((qe=function(){function e(t,n,i,r){var a=this;_classCallCheck(this,e),this.route=t,this.router=n,this.auth=i,this.tokenService=r,this.isLoading=!1,this.authTypes=T.a,this.subs=new h.a;var o=this.route.paramMap.pipe(Object(l.a)((function(){return window.history.state}))).subscribe((function(e){a.phone=e.phone,a.password=e.password})),s=this.route.data.subscribe((function(e){a.authType=e.action}));this.subs.add(o),this.subs.add(s)}return _createClass(e,[{key:"ngOnDestroy",value:function(){this.subs.unsubscribe()}},{key:"login",value:function(e){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),this.isLoading=!0,t.prev=1,t.next=4,this.auth.requestDevice(this.phone,P.q.SMS);case 4:return n=t.sent,this.tokenService.setDeviceToken(n.signature,this.password),t.next=8,this.auth.login(this.phone,this.password);case 8:this.router.navigateByUrl("/"),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),this.router.navigate(["/auth/login"],{state:{error:t.t0.description||t.t0}});case 14:return t.prev=14,this.isLoading=!1,t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])})))}}]),e}()).\u0275fac=function(e){return new(e||qe)(d.Qb(a.a),d.Qb(a.c),d.Qb(p.a),d.Qb(m.a))},qe.\u0275cmp=d.Kb({type:qe,selectors:[["j-register-result"]],decls:14,vars:3,consts:[[1,"auth-heading","light","mb-3","mt-0"],["translate",""],[1,"mb-4"],[1,"auth-submit"],["translate","",1,"btn","btn-static","btn-primary",3,"disabled","jLoading","click"]],template:function(e,t){1&e&&(d.Wb(0,"article"),d.Wb(1,"h3",0),d.Wb(2,"span",1),d.Tc(3,"SHARED.DONE"),d.Vb(),d.Tc(4,"! "),d.Vb(),d.Wb(5,"p",2),d.Wb(6,"span",1),d.Tc(7),d.Vb(),d.Rb(8,"br"),d.Wb(9,"span",1),d.Tc(10,"AUTH.RESULT.DESCRIPTION"),d.Vb(),d.Vb(),d.Vb(),d.Wb(11,"div",3),d.Wb(12,"button",4),d.ic("click",(function(e){return t.login(e)})),d.Tc(13,"AUTH.LOGIN"),d.Vb(),d.Vb()),2&e&&(d.Ab(7),d.Uc(t.authType==t.authTypes.REGISTER?"AUTH.RESULT.REGISTERED":"AUTH.RESULT.RESTORED"),d.Ab(5),d.uc("disabled",t.isLoading)("jLoading",t.isLoading))},directives:[k.a,A.a],styles:[""]}),qe),et=((Be=function e(t){_classCallCheck(this,e),this.navService=t,this.translateParams={tel:"7711"},this.navService.triggerRegisterError("iin",!0),this.navService.triggerRegisterError("no-account",!0)}).\u0275fac=function(e){return new(e||Be)(d.Qb(me.a))},Be.\u0275cmp=d.Kb({type:Be,selectors:[["j-no-account"]],decls:13,vars:5,consts:[["routerLink","../iin",1,"j-link"],["name","arrowLeft","color","primary",1,"mr-2",3,"isStroke"],["translate",""],["translate","",1,"light","mb-3","mt-0"],[1,"mb-4",3,"innerHTML"],["routerLink","../iin","translate","",1,"btn","btn-static","btn-primary"],["translate","","href","https://jysanbank.kz/ru/page/contacts","target","_blank",1,"btn","btn-static","btn-link"]],template:function(e,t){1&e&&(d.Wb(0,"a",0),d.Rb(1,"j-icon",1),d.Wb(2,"span",2),d.Tc(3,"SHARED.BACK"),d.Vb(),d.Vb(),d.Wb(4,"article"),d.Wb(5,"h3",3),d.Tc(6,"AUTH.NO_ACCOUNT.TITLE"),d.Vb(),d.Rb(7,"p",4),d.nc(8,"translate"),d.Wb(9,"a",5),d.Tc(10,"AUTH.NO_ACCOUNT.LINK"),d.Vb(),d.Wb(11,"a",6),d.Tc(12,"AUTH.NO_ACCOUNT.CONTACTS"),d.Vb(),d.Vb()),2&e&&(d.Ab(1),d.uc("isStroke",!0),d.Ab(6),d.uc("innerHTML",d.pc(8,2,"AUTH.NO_ACCOUNT.DESCRIPTION",t.translateParams),d.Jc))},directives:[a.f,W.a,k.a],pipes:[k.d],styles:[""]}),Be),tt=((Qe=function e(t){_classCallCheck(this,e),this.navService=t,this.navService.triggerRegisterError("iin",!0),this.navService.triggerRegisterError("no-email",!0)}).\u0275fac=function(e){return new(e||Qe)(d.Qb(me.a))},Qe.\u0275cmp=d.Kb({type:Qe,selectors:[["j-no-email"]],decls:11,vars:4,consts:[["routerLink","../phone",1,"j-link"],["name","arrowLeft","color","primary",1,"mr-2",3,"isStroke"],["translate",""],["translate","",1,"light","mb-3","mt-0"],[1,"mb-4",3,"innerHTML"],["translate","","href","https://jysanbank.kz/ru/page/contacts","target","_blank",1,"btn","btn-static","btn-primary"]],template:function(e,t){1&e&&(d.Wb(0,"a",0),d.Rb(1,"j-icon",1),d.Wb(2,"span",2),d.Tc(3,"SHARED.PHONE"),d.Vb(),d.Vb(),d.Wb(4,"article"),d.Wb(5,"h3",3),d.Tc(6,"AUTH.NO_EMAIL.TITLE"),d.Vb(),d.Rb(7,"p",4),d.nc(8,"translate"),d.Wb(9,"a",5),d.Tc(10,"AUTH.NO_EMAIL.LINK"),d.Vb(),d.Vb()),2&e&&(d.Ab(1),d.uc("isStroke",!0),d.Ab(6),d.uc("innerHTML",d.oc(8,2,"AUTH.NO_EMAIL.DESCRIPTION"),d.Jc))},directives:[a.f,W.a,k.a],pipes:[k.d],styles:[""]}),Qe),nt=((Ge=function e(t){_classCallCheck(this,e),this.navService=t,this.translateParams={tel:"7711"},this.navService.triggerRegisterError("iin",!0),this.navService.triggerRegisterError("user-blocked",!0)}).\u0275fac=function(e){return new(e||Ge)(d.Qb(me.a))},Ge.\u0275cmp=d.Kb({type:Ge,selectors:[["j-user-blocked"]],decls:9,vars:5,consts:[["routerLink","../iin",1,"j-link"],["name","arrowLeft","color","primary",1,"mr-2",3,"isStroke"],["translate",""],["translate","",1,"light","mb-3","mt-0"],[1,"mb-4",3,"innerHTML"]],template:function(e,t){1&e&&(d.Wb(0,"a",0),d.Rb(1,"j-icon",1),d.Wb(2,"span",2),d.Tc(3,"SHARED.IIN"),d.Vb(),d.Vb(),d.Wb(4,"article"),d.Wb(5,"h3",3),d.Tc(6,"AUTH.USER_BLOCKED.TITLE"),d.Vb(),d.Rb(7,"p",4),d.nc(8,"translate"),d.Vb()),2&e&&(d.Ab(1),d.uc("isStroke",!0),d.Ab(6),d.uc("innerHTML",d.pc(8,2,"AUTH.USER_BLOCKED.DESCRIPTION",t.translateParams),d.Jc))},directives:[a.f,W.a,k.a],pipes:[k.d],styles:[""]}),Ge),it=((Ke=function(){function e(t,n,i){var r=this;_classCallCheck(this,e),this.router=t,this.route=n,this.navService=i,this.subscription=new h.a,this.navService.triggerRegisterError("phone",!0),this.navService.triggerRegisterError("phone-not-match",!0),this.subscription.add(this.route.paramMap.pipe(Object(l.a)((function(){return window.history.state}))).subscribe((function(e){r.phone=e.phone,r.iin=e.iin,r.countryCode=e.countryCode})))}return _createClass(e,[{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"navigateToPhone",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null===(e=t)||void 0===e||e.preventDefault(),this.router.navigate(["phone"],{relativeTo:this.route.parent,state:{iin:this.iin,phone:this.phone,countryCode:this.countryCode}})}}]),e}()).\u0275fac=function(e){return new(e||Ke)(d.Qb(a.c),d.Qb(a.a),d.Qb(me.a))},Ke.\u0275cmp=d.Kb({type:Ke,selectors:[["j-phone-not-match"]],decls:11,vars:4,consts:[["href","#",1,"j-link",3,"click"],["name","arrowLeft","color","primary",1,"mr-2",3,"isStroke"],["translate",""],["translate","",1,"light","mb-3","mt-0"],[1,"mb-4",3,"innerHTML"],["href","#","translate","",1,"btn","btn-static","btn-primary",3,"click"]],template:function(e,t){1&e&&(d.Wb(0,"a",0),d.ic("click",(function(e){return t.navigateToPhone(e)})),d.Rb(1,"j-icon",1),d.Wb(2,"span",2),d.Tc(3,"SHARED.PHONE"),d.Vb(),d.Vb(),d.Wb(4,"article"),d.Wb(5,"h3",3),d.Tc(6,"AUTH.PHONE_NOT_MATCH.TITLE"),d.Vb(),d.Rb(7,"p",4),d.nc(8,"translate"),d.Wb(9,"a",5),d.ic("click",(function(e){return t.navigateToPhone(e)})),d.Tc(10,"AUTH.PHONE_NOT_MATCH.LINK"),d.Vb(),d.Vb()),2&e&&(d.Ab(1),d.uc("isStroke",!0),d.Ab(6),d.uc("innerHTML",d.oc(8,2,"AUTH.PHONE_NOT_MATCH.DESCRIPTION"),d.Jc))},directives:[W.a,k.a],pipes:[k.d],styles:[""]}),Ke),rt=((Fe=function(){function e(t){var n=this;_classCallCheck(this,e),this.route=t,this.subscription=new h.a;var i=this.route.data.subscribe((function(e){n.authType=e.action})),r=this.route.paramMap.pipe(Object(l.a)((function(){return window.history.state}))).subscribe((function(e){n.error=e.error,n.iin=e.iin}));this.subscription.add(r),this.subscription.add(i)}return _createClass(e,[{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"description",get:function(){return this.authType===T.a.REGISTER?"AUTH.ERROR.DESCRIPTION_REGISTER":"AUTH.ERROR.DESCRIPTION_RESTORE"}},{key:"state",get:function(){return{iin:this.iin}}}]),e}()).\u0275fac=function(e){return new(e||Fe)(d.Qb(a.a))},Fe.\u0275cmp=d.Kb({type:Fe,selectors:[["j-register-error"]],decls:12,vars:9,consts:[["routerLink","../iin",1,"j-link",3,"state"],["name","arrowLeft","color","primary",1,"mr-2",3,"isStroke"],["translate",""],["translate","",1,"light","mb-3","mt-0"],[1,"mb-4",3,"innerHTML"],["routerLink","../iin",1,"btn","btn-primary",3,"state"]],template:function(e,t){1&e&&(d.Wb(0,"a",0),d.Rb(1,"j-icon",1),d.Wb(2,"span",2),d.Tc(3,"SHARED.IIN"),d.Vb(),d.Vb(),d.Wb(4,"article"),d.Wb(5,"h3",3),d.Tc(6,"AUTH.ERROR.TITLE"),d.Vb(),d.Rb(7,"p",4),d.nc(8,"translate"),d.Wb(9,"a",5),d.Tc(10),d.nc(11,"translate"),d.Vb(),d.Vb()),2&e&&(d.uc("state",t.state),d.Ab(1),d.uc("isStroke",!0),d.Ab(6),d.uc("innerHTML",d.oc(8,5,t.description),d.Jc),d.Ab(2),d.uc("state",t.state),d.Ab(1),d.Vc(" ",d.oc(11,7,"SHARED.BACK")," "))},directives:[a.f,W.a,k.a],pipes:[k.d],styles:[""]}),Fe),at=[{path:"",redirectTo:"login",pathMatch:"full"},{path:"login",component:re},{path:"register",component:ce,children:[{path:"",redirectTo:"iin"},{path:"iin",component:Se,data:{title:"AUTH.REGISTER_TITLE",action:T.a.REGISTER}},{path:"no-account",component:et},{path:"no-email",component:tt},{path:"user-blocked",component:nt},{path:"phone",component:Ae,data:{title:"SHARED.PHONE",action:T.a.REGISTER}},{path:"sms",component:Ve,data:{action:T.a.REGISTER}},{path:"phone-not-match",component:it},{path:"email",component:Ze},{path:"password",component:ze,data:{action:T.a.REGISTER}},{path:"error",component:rt,data:{action:T.a.REGISTER}},{path:"result",component:$e,data:{action:T.a.REGISTER}}]},{path:"restore",component:ce,children:[{path:"",redirectTo:"iin"},{path:"iin",component:Se,data:{title:"AUTH.RESTORE",action:T.a.RESTORE}},{path:"no-account",component:et},{path:"no-email",component:tt},{path:"user-blocked",component:nt},{path:"phone",component:Ae,data:{title:"SHARED.PHONE",action:T.a.RESTORE}},{path:"sms",component:Ve,data:{action:T.a.RESTORE}},{path:"phone-not-match",component:it},{path:"email",component:Ze},{path:"password",component:ze,data:{action:T.a.RESTORE}},{path:"error",component:rt,data:{action:T.a.RESTORE}},{path:"result",component:$e,data:{action:T.a.RESTORE}}]}],ot=((Je=function e(){_classCallCheck(this,e)}).\u0275mod=d.Ob({type:Je}),Je.\u0275inj=d.Nb({factory:function(e){return new(e||Je)},imports:[[a.g.forChild(at)],a.g]}),Je);n.d(t,"AuthModule",(function(){return ct}));var st,ct=((st=function e(){_classCallCheck(this,e)}).\u0275mod=d.Ob({type:st}),st.\u0275inj=d.Nb({factory:function(e){return new(e||st)},providers:[{provide:s.b,useClass:s.b}],imports:[[r.c,ot,o.n,a.g,o.D,c.a,s.c]]}),st)}}]);